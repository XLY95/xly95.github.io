const _0x43c175=_0x4f1d;(function(_0x5d4e3d,_0x262aa0){const _0x14ab84=_0x4f1d,_0x1e54b8=_0x5d4e3d();while(!![]){try{const _0x339a4e=-parseInt(_0x14ab84(0x154))/0x1+parseInt(_0x14ab84(0x1a5))/0x2*(-parseInt(_0x14ab84(0x150))/0x3)+-parseInt(_0x14ab84(0x17f))/0x4+-parseInt(_0x14ab84(0x167))/0x5+-parseInt(_0x14ab84(0xe7))/0x6+parseInt(_0x14ab84(0x15e))/0x7*(-parseInt(_0x14ab84(0xd4))/0x8)+parseInt(_0x14ab84(0x165))/0x9;if(_0x339a4e===_0x262aa0)break;else _0x1e54b8['push'](_0x1e54b8['shift']());}catch(_0x226624){_0x1e54b8['push'](_0x1e54b8['shift']());}}}(_0x2029,0x7e0ed));let sourceImage=null,originalImage=null,canvas,ctx,floatCanvas,floatCtx,originalCanvasData=null,startTime,currentParams={'saturation':0x64,'brightness':0x64,'contrast':0x64,'diffusion':0x32,'ditherAlg':'floydSteinberg'},currentMode=_0x43c175(0x1b8),canvasRotation=0x0,isDrawing=![],lastX=0x0,lastY=0x0,currentTool=_0x43c175(0xc7),brushSize=0x3,brushColor='#000000',imageScale=0x64,imageOffset={'x':0x0,'y':0x0},isDraggingImage=![],dragStartPos={'x':0x0,'y':0x0},shiftKeyPressed=![],imageRotation=0x0,isDrawingModeActive=![],isDragging=![],dragOffset={'x':0x0,'y':0x0},isResizing=![],bleDevice,gattServer,epdService,epdCharacteristic,msgIndex,appVersion,textDecoder;const canvasSizes=[{'name':_0x43c175(0xa3),'width':0x7a,'height':0xfa},{'name':_0x43c175(0x1a4),'width':0x190,'height':0x12c},{'name':_0x43c175(0x1b3),'width':0x320,'height':0x1e0}],threeColorPalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1},{'name':'红色','r':0xff,'g':0x0,'b':0x0,'value':0x2}],blackWhitePalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1}];function adjustContrast(_0xcb4126,_0xc465a3){const _0x799a06=_0x43c175,_0x2fda9c=_0xcb4126[_0x799a06(0xbf)];for(let _0x52ed38=0x0;_0x52ed38<_0x2fda9c[_0x799a06(0xb7)];_0x52ed38+=0x4){_0x2fda9c[_0x52ed38]=Math[_0x799a06(0x105)](0xff,Math[_0x799a06(0xb0)](0x0,(_0x2fda9c[_0x52ed38]-0x80)*_0xc465a3+0x80)),_0x2fda9c[_0x52ed38+0x1]=Math['min'](0xff,Math[_0x799a06(0xb0)](0x0,(_0x2fda9c[_0x52ed38+0x1]-0x80)*_0xc465a3+0x80)),_0x2fda9c[_0x52ed38+0x2]=Math[_0x799a06(0x105)](0xff,Math[_0x799a06(0xb0)](0x0,(_0x2fda9c[_0x52ed38+0x2]-0x80)*_0xc465a3+0x80));}return _0xcb4126;}function adjustBrightness(_0x4ca6de,_0x51ec81){const _0x5deaa1=_0x43c175,_0x873fa2=_0x51ec81/0x64,_0x3542d5=_0x4ca6de[_0x5deaa1(0xbf)];for(let _0x4469a2=0x0;_0x4469a2<_0x3542d5[_0x5deaa1(0xb7)];_0x4469a2+=0x4){_0x3542d5[_0x4469a2]=Math[_0x5deaa1(0x105)](0xff,Math[_0x5deaa1(0xb0)](0x0,_0x3542d5[_0x4469a2]*_0x873fa2)),_0x3542d5[_0x4469a2+0x1]=Math[_0x5deaa1(0x105)](0xff,Math[_0x5deaa1(0xb0)](0x0,_0x3542d5[_0x4469a2+0x1]*_0x873fa2)),_0x3542d5[_0x4469a2+0x2]=Math['min'](0xff,Math[_0x5deaa1(0xb0)](0x0,_0x3542d5[_0x4469a2+0x2]*_0x873fa2));}return _0x4ca6de;}function adjustSaturation(_0x4a481b,_0x2ba47c){const _0x410228=_0x43c175,_0x1de4c8=_0x4a481b[_0x410228(0xbf)];for(let _0x396c3f=0x0;_0x396c3f<_0x1de4c8[_0x410228(0xb7)];_0x396c3f+=0x4){const _0x54cadc=0.299*_0x1de4c8[_0x396c3f]+0.587*_0x1de4c8[_0x396c3f+0x1]+0.114*_0x1de4c8[_0x396c3f+0x2];_0x1de4c8[_0x396c3f]=Math[_0x410228(0x105)](0xff,Math[_0x410228(0xb0)](0x0,_0x54cadc+(_0x1de4c8[_0x396c3f]-_0x54cadc)*_0x2ba47c)),_0x1de4c8[_0x396c3f+0x1]=Math['min'](0xff,Math[_0x410228(0xb0)](0x0,_0x54cadc+(_0x1de4c8[_0x396c3f+0x1]-_0x54cadc)*_0x2ba47c)),_0x1de4c8[_0x396c3f+0x2]=Math[_0x410228(0x105)](0xff,Math['max'](0x0,_0x54cadc+(_0x1de4c8[_0x396c3f+0x2]-_0x54cadc)*_0x2ba47c));}return _0x4a481b;}function rgbToLab(_0x567749,_0x1ead25,_0x2ee70e){const _0x4e308c=_0x43c175;_0x567749=_0x567749/0xff,_0x1ead25=_0x1ead25/0xff,_0x2ee70e=_0x2ee70e/0xff,_0x567749=_0x567749>0.04045?Math['pow']((_0x567749+0.055)/1.055,2.4):_0x567749/12.92,_0x1ead25=_0x1ead25>0.04045?Math[_0x4e308c(0xe1)]((_0x1ead25+0.055)/1.055,2.4):_0x1ead25/12.92,_0x2ee70e=_0x2ee70e>0.04045?Math[_0x4e308c(0xe1)]((_0x2ee70e+0.055)/1.055,2.4):_0x2ee70e/12.92,_0x567749*=0x64,_0x1ead25*=0x64,_0x2ee70e*=0x64;let _0x46127f=_0x567749*0.4124+_0x1ead25*0.3576+_0x2ee70e*0.1805,_0x1cfada=_0x567749*0.2126+_0x1ead25*0.7152+_0x2ee70e*0.0722,_0xe76215=_0x567749*0.0193+_0x1ead25*0.1192+_0x2ee70e*0.9505;_0x46127f/=95.047,_0x1cfada/=0x64,_0xe76215/=108.883,_0x46127f=_0x46127f>0.008856?Math['pow'](_0x46127f,0x1/0x3):7.787*_0x46127f+0x10/0x74,_0x1cfada=_0x1cfada>0.008856?Math['pow'](_0x1cfada,0x1/0x3):7.787*_0x1cfada+0x10/0x74,_0xe76215=_0xe76215>0.008856?Math[_0x4e308c(0xe1)](_0xe76215,0x1/0x3):7.787*_0xe76215+0x10/0x74;const _0x1482d8=0x74*_0x1cfada-0x10,_0x5ac831=0x1f4*(_0x46127f-_0x1cfada),_0x124a36=0xc8*(_0x1cfada-_0xe76215);return{'l':_0x1482d8,'a':_0x5ac831,'b':_0x124a36};}function labDistance(_0x3d6b2c,_0x5b0015){const _0x155d27=_0x43c175,_0x4ebbb2=_0x3d6b2c['l']-_0x5b0015['l'],_0xbb43a=_0x3d6b2c['a']-_0x5b0015['a'],_0x363a12=_0x3d6b2c['b']-_0x5b0015['b'];return Math[_0x155d27(0x1bc)](0.2*_0x4ebbb2*_0x4ebbb2+0x3*_0xbb43a*_0xbb43a+0x3*_0x363a12*_0x363a12);}function findClosestColor(_0x63964b,_0x31311d,_0x98d716,_0x43ba73){let _0x56f225;if(_0x43ba73==='threeColor'){_0x56f225=threeColorPalette;if(_0x63964b>0x78&&_0x63964b>_0x31311d*1.5&&_0x63964b>_0x98d716*1.5)return threeColorPalette[0x2];const _0x21b7bf=0.299*_0x63964b+0.587*_0x31311d+0.114*_0x98d716;return _0x21b7bf<0x80?threeColorPalette[0x0]:threeColorPalette[0x1];}else{_0x56f225=blackWhitePalette;const _0x2a1cf3=0.299*_0x63964b+0.587*_0x31311d+0.114*_0x98d716;return _0x2a1cf3<0x80?blackWhitePalette[0x0]:blackWhitePalette[0x1];}}const DitherAlgorithms={'floydSteinberg':function(_0x2fdb5b,_0xd55390,_0x16bb69){const _0x2a8209=_0x43c175,_0x56c36d=_0x2fdb5b[_0x2a8209(0x112)],_0x1014f1=_0x2fdb5b[_0x2a8209(0x1ae)],_0x38cb6=_0x2fdb5b[_0x2a8209(0xbf)],_0x5c5662=new Uint8ClampedArray(_0x38cb6);for(let _0x48948c=0x0;_0x48948c<_0x1014f1;_0x48948c++){for(let _0x4c5768=0x0;_0x4c5768<_0x56c36d;_0x4c5768++){const _0x810c64=(_0x48948c*_0x56c36d+_0x4c5768)*0x4,_0x2f40a6=_0x5c5662[_0x810c64],_0x196c03=_0x5c5662[_0x810c64+0x1],_0x58442d=_0x5c5662[_0x810c64+0x2],_0x560af1=findClosestColor(_0x2f40a6,_0x196c03,_0x58442d,_0x16bb69),_0x1b12f6=(_0x2f40a6-_0x560af1['r'])*_0xd55390,_0x4890c4=(_0x196c03-_0x560af1['g'])*_0xd55390,_0x39aabd=(_0x58442d-_0x560af1['b'])*_0xd55390;if(_0x4c5768+0x1<_0x56c36d){const _0x41105e=_0x810c64+0x4;_0x5c5662[_0x41105e]=Math[_0x2a8209(0x105)](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x41105e]+_0x1b12f6*0x7/0x10)),_0x5c5662[_0x41105e+0x1]=Math['min'](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x41105e+0x1]+_0x4890c4*0x7/0x10)),_0x5c5662[_0x41105e+0x2]=Math[_0x2a8209(0x105)](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x41105e+0x2]+_0x39aabd*0x7/0x10));}if(_0x48948c+0x1<_0x1014f1){if(_0x4c5768>0x0){const _0x461831=_0x810c64+_0x56c36d*0x4-0x4;_0x5c5662[_0x461831]=Math[_0x2a8209(0x105)](0xff,Math['max'](0x0,_0x5c5662[_0x461831]+_0x1b12f6*0x3/0x10)),_0x5c5662[_0x461831+0x1]=Math[_0x2a8209(0x105)](0xff,Math['max'](0x0,_0x5c5662[_0x461831+0x1]+_0x4890c4*0x3/0x10)),_0x5c5662[_0x461831+0x2]=Math[_0x2a8209(0x105)](0xff,Math['max'](0x0,_0x5c5662[_0x461831+0x2]+_0x39aabd*0x3/0x10));}const _0x3247ad=_0x810c64+_0x56c36d*0x4;_0x5c5662[_0x3247ad]=Math[_0x2a8209(0x105)](0xff,Math['max'](0x0,_0x5c5662[_0x3247ad]+_0x1b12f6*0x5/0x10)),_0x5c5662[_0x3247ad+0x1]=Math['min'](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x3247ad+0x1]+_0x4890c4*0x5/0x10)),_0x5c5662[_0x3247ad+0x2]=Math['min'](0xff,Math['max'](0x0,_0x5c5662[_0x3247ad+0x2]+_0x39aabd*0x5/0x10));if(_0x4c5768+0x1<_0x56c36d){const _0x36c4e0=_0x810c64+_0x56c36d*0x4+0x4;_0x5c5662[_0x36c4e0]=Math[_0x2a8209(0x105)](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x36c4e0]+_0x1b12f6*0x1/0x10)),_0x5c5662[_0x36c4e0+0x1]=Math[_0x2a8209(0x105)](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x36c4e0+0x1]+_0x4890c4*0x1/0x10)),_0x5c5662[_0x36c4e0+0x2]=Math['min'](0xff,Math[_0x2a8209(0xb0)](0x0,_0x5c5662[_0x36c4e0+0x2]+_0x39aabd*0x1/0x10));}}}}for(let _0x38d1b9=0x0;_0x38d1b9<_0x1014f1;_0x38d1b9++){for(let _0x540c1f=0x0;_0x540c1f<_0x56c36d;_0x540c1f++){const _0x28d18a=(_0x38d1b9*_0x56c36d+_0x540c1f)*0x4,_0x1bc45f=_0x5c5662[_0x28d18a],_0x278fba=_0x5c5662[_0x28d18a+0x1],_0x5b553c=_0x5c5662[_0x28d18a+0x2],_0x351003=findClosestColor(_0x1bc45f,_0x278fba,_0x5b553c,_0x16bb69);_0x38cb6[_0x28d18a]=_0x351003['r'],_0x38cb6[_0x28d18a+0x1]=_0x351003['g'],_0x38cb6[_0x28d18a+0x2]=_0x351003['b'];}}return _0x2fdb5b;},'atkinson':function(_0x300295,_0xd46dce,_0x3ee828){const _0x18552d=_0x43c175,_0x12fd41=_0x300295[_0x18552d(0x112)],_0x1eed9e=_0x300295[_0x18552d(0x1ae)],_0x242921=_0x300295[_0x18552d(0xbf)],_0x308743=new Uint8ClampedArray(_0x242921),_0x5e2ef8=_0xd46dce*0x1/0x8;for(let _0xf21528=0x0;_0xf21528<_0x1eed9e;_0xf21528++){for(let _0x4ba2ff=0x0;_0x4ba2ff<_0x12fd41;_0x4ba2ff++){const _0x1af116=(_0xf21528*_0x12fd41+_0x4ba2ff)*0x4,_0xdc5036=_0x308743[_0x1af116],_0x193e93=_0x308743[_0x1af116+0x1],_0x4e0da8=_0x308743[_0x1af116+0x2],_0x21c9fd=findClosestColor(_0xdc5036,_0x193e93,_0x4e0da8,_0x3ee828),_0x415279=(_0xdc5036-_0x21c9fd['r'])*_0x5e2ef8,_0x346d59=(_0x193e93-_0x21c9fd['g'])*_0x5e2ef8,_0x2d92bb=(_0x4e0da8-_0x21c9fd['b'])*_0x5e2ef8;if(_0x4ba2ff+0x1<_0x12fd41){const _0x5369aa=_0x1af116+0x4;_0x308743[_0x5369aa]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x5369aa]+_0x415279)),_0x308743[_0x5369aa+0x1]=Math[_0x18552d(0x105)](0xff,Math['max'](0x0,_0x308743[_0x5369aa+0x1]+_0x346d59)),_0x308743[_0x5369aa+0x2]=Math['min'](0xff,Math['max'](0x0,_0x308743[_0x5369aa+0x2]+_0x2d92bb));}if(_0x4ba2ff+0x2<_0x12fd41){const _0x6f0ff0=_0x1af116+0x8;_0x308743[_0x6f0ff0]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x6f0ff0]+_0x415279)),_0x308743[_0x6f0ff0+0x1]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x6f0ff0+0x1]+_0x346d59)),_0x308743[_0x6f0ff0+0x2]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x6f0ff0+0x2]+_0x2d92bb));}if(_0xf21528+0x1<_0x1eed9e){if(_0x4ba2ff>0x0){const _0x73e173=_0x1af116+_0x12fd41*0x4-0x4;_0x308743[_0x73e173]=Math[_0x18552d(0x105)](0xff,Math['max'](0x0,_0x308743[_0x73e173]+_0x415279)),_0x308743[_0x73e173+0x1]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x73e173+0x1]+_0x346d59)),_0x308743[_0x73e173+0x2]=Math[_0x18552d(0x105)](0xff,Math['max'](0x0,_0x308743[_0x73e173+0x2]+_0x2d92bb));}const _0x3ed19b=_0x1af116+_0x12fd41*0x4;_0x308743[_0x3ed19b]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x3ed19b]+_0x415279)),_0x308743[_0x3ed19b+0x1]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x3ed19b+0x1]+_0x346d59)),_0x308743[_0x3ed19b+0x2]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x3ed19b+0x2]+_0x2d92bb));if(_0x4ba2ff+0x1<_0x12fd41){const _0x3d697e=_0x1af116+_0x12fd41*0x4+0x4;_0x308743[_0x3d697e]=Math['min'](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x3d697e]+_0x415279)),_0x308743[_0x3d697e+0x1]=Math[_0x18552d(0x105)](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x3d697e+0x1]+_0x346d59)),_0x308743[_0x3d697e+0x2]=Math['min'](0xff,Math[_0x18552d(0xb0)](0x0,_0x308743[_0x3d697e+0x2]+_0x2d92bb));}}}}for(let _0x32f4c9=0x0;_0x32f4c9<_0x1eed9e;_0x32f4c9++){for(let _0x5e9454=0x0;_0x5e9454<_0x12fd41;_0x5e9454++){const _0x5eac53=(_0x32f4c9*_0x12fd41+_0x5e9454)*0x4,_0x398b6a=_0x308743[_0x5eac53],_0x4d7601=_0x308743[_0x5eac53+0x1],_0x1189b5=_0x308743[_0x5eac53+0x2],_0x35ee7a=findClosestColor(_0x398b6a,_0x4d7601,_0x1189b5,_0x3ee828);_0x242921[_0x5eac53]=_0x35ee7a['r'],_0x242921[_0x5eac53+0x1]=_0x35ee7a['g'],_0x242921[_0x5eac53+0x2]=_0x35ee7a['b'];}}return _0x300295;},'bayer':function(_0x3360f5,_0x32d7b1,_0x48bcdd){const _0x283bb6=_0x43c175,_0x3f7b7d=_0x3360f5[_0x283bb6(0x112)],_0x17984d=_0x3360f5['height'],_0x264fac=_0x3360f5[_0x283bb6(0xbf)],_0x2508db=[[0x0,0x8,0x2,0xa],[0xc,0x4,0xe,0x6],[0x3,0xb,0x1,0x9],[0xf,0x7,0xd,0x5]],_0x1c6b92=0x4,_0x52f2e6=0x10;for(let _0x35e0cb=0x0;_0x35e0cb<_0x17984d;_0x35e0cb++){for(let _0x5150d7=0x0;_0x5150d7<_0x3f7b7d;_0x5150d7++){const _0x50a24f=(_0x35e0cb*_0x3f7b7d+_0x5150d7)*0x4,_0x452f15=_0x264fac[_0x50a24f],_0xc3cf5=_0x264fac[_0x50a24f+0x1],_0x1ee278=_0x264fac[_0x50a24f+0x2],_0x1c8517=0.299*_0x452f15+0.587*_0xc3cf5+0.114*_0x1ee278,_0x98ccb5=_0x5150d7%_0x1c6b92,_0x48ecd9=_0x35e0cb%_0x1c6b92,_0x389947=_0x2508db[_0x48ecd9][_0x98ccb5];let _0x2c750b=_0x1c8517;if(_0x48bcdd===_0x283bb6(0xc4)&&_0x452f15>0x78&&_0x452f15>_0xc3cf5*1.5&&_0x452f15>_0x1ee278*1.5)_0x264fac[_0x50a24f]=0xff,_0x264fac[_0x50a24f+0x1]=0x0,_0x264fac[_0x50a24f+0x2]=0x0;else{const _0xc31c92=_0x389947/_0x52f2e6*0xff*_0x32d7b1;_0x1c8517<0x80+(_0xc31c92-0x80)?(_0x264fac[_0x50a24f]=0x0,_0x264fac[_0x50a24f+0x1]=0x0,_0x264fac[_0x50a24f+0x2]=0x0):(_0x264fac[_0x50a24f]=0xff,_0x264fac[_0x50a24f+0x1]=0xff,_0x264fac[_0x50a24f+0x2]=0xff);}}}return _0x3360f5;},'stucki':function(_0x65a8a4,_0x28f82c,_0x5a0e65){const _0x4277a6=_0x43c175,_0x54275a=_0x65a8a4[_0x4277a6(0x112)],_0x1a27f5=_0x65a8a4['height'],_0x2acfd8=_0x65a8a4[_0x4277a6(0xbf)],_0x25e1d8=new Uint8ClampedArray(_0x2acfd8),_0x1738e0=_0x28f82c*0x1/0x2a;for(let _0x557346=0x0;_0x557346<_0x1a27f5;_0x557346++){for(let _0x42636e=0x0;_0x42636e<_0x54275a;_0x42636e++){const _0x13c949=(_0x557346*_0x54275a+_0x42636e)*0x4,_0x8ec03c=_0x25e1d8[_0x13c949],_0x31f9f3=_0x25e1d8[_0x13c949+0x1],_0x54580f=_0x25e1d8[_0x13c949+0x2],_0x2b9101=findClosestColor(_0x8ec03c,_0x31f9f3,_0x54580f,_0x5a0e65),_0x3d7f46=(_0x8ec03c-_0x2b9101['r'])*_0x1738e0,_0x1951e0=(_0x31f9f3-_0x2b9101['g'])*_0x1738e0,_0x44f1af=(_0x54580f-_0x2b9101['b'])*_0x1738e0;if(_0x42636e+0x1<_0x54275a){const _0x4f2c69=_0x13c949+0x4;_0x25e1d8[_0x4f2c69]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x4f2c69]+_0x3d7f46*0x8)),_0x25e1d8[_0x4f2c69+0x1]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x4f2c69+0x1]+_0x1951e0*0x8)),_0x25e1d8[_0x4f2c69+0x2]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x4f2c69+0x2]+_0x44f1af*0x8));}if(_0x42636e+0x2<_0x54275a){const _0x1470e8=_0x13c949+0x8;_0x25e1d8[_0x1470e8]=Math['min'](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1470e8]+_0x3d7f46*0x4)),_0x25e1d8[_0x1470e8+0x1]=Math[_0x4277a6(0x105)](0xff,Math['max'](0x0,_0x25e1d8[_0x1470e8+0x1]+_0x1951e0*0x4)),_0x25e1d8[_0x1470e8+0x2]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1470e8+0x2]+_0x44f1af*0x4));}if(_0x557346+0x1<_0x1a27f5){if(_0x42636e>0x1){const _0x1cbe34=_0x13c949+_0x54275a*0x4-0x8;_0x25e1d8[_0x1cbe34]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1cbe34]+_0x3d7f46*0x2)),_0x25e1d8[_0x1cbe34+0x1]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1cbe34+0x1]+_0x1951e0*0x2)),_0x25e1d8[_0x1cbe34+0x2]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1cbe34+0x2]+_0x44f1af*0x2));}if(_0x42636e>0x0){const _0x43ec6e=_0x13c949+_0x54275a*0x4-0x4;_0x25e1d8[_0x43ec6e]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x43ec6e]+_0x3d7f46*0x4)),_0x25e1d8[_0x43ec6e+0x1]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x43ec6e+0x1]+_0x1951e0*0x4)),_0x25e1d8[_0x43ec6e+0x2]=Math['min'](0xff,Math['max'](0x0,_0x25e1d8[_0x43ec6e+0x2]+_0x44f1af*0x4));}const _0x4a8c4b=_0x13c949+_0x54275a*0x4;_0x25e1d8[_0x4a8c4b]=Math[_0x4277a6(0x105)](0xff,Math['max'](0x0,_0x25e1d8[_0x4a8c4b]+_0x3d7f46*0x8)),_0x25e1d8[_0x4a8c4b+0x1]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x4a8c4b+0x1]+_0x1951e0*0x8)),_0x25e1d8[_0x4a8c4b+0x2]=Math['min'](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x4a8c4b+0x2]+_0x44f1af*0x8));if(_0x42636e+0x1<_0x54275a){const _0x1062b4=_0x13c949+_0x54275a*0x4+0x4;_0x25e1d8[_0x1062b4]=Math[_0x4277a6(0x105)](0xff,Math['max'](0x0,_0x25e1d8[_0x1062b4]+_0x3d7f46*0x4)),_0x25e1d8[_0x1062b4+0x1]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1062b4+0x1]+_0x1951e0*0x4)),_0x25e1d8[_0x1062b4+0x2]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x1062b4+0x2]+_0x44f1af*0x4));}if(_0x42636e+0x2<_0x54275a){const _0x498e3d=_0x13c949+_0x54275a*0x4+0x8;_0x25e1d8[_0x498e3d]=Math[_0x4277a6(0x105)](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x498e3d]+_0x3d7f46*0x2)),_0x25e1d8[_0x498e3d+0x1]=Math['min'](0xff,Math['max'](0x0,_0x25e1d8[_0x498e3d+0x1]+_0x1951e0*0x2)),_0x25e1d8[_0x498e3d+0x2]=Math['min'](0xff,Math[_0x4277a6(0xb0)](0x0,_0x25e1d8[_0x498e3d+0x2]+_0x44f1af*0x2));}}}}for(let _0x306461=0x0;_0x306461<_0x1a27f5;_0x306461++){for(let _0x4e21b0=0x0;_0x4e21b0<_0x54275a;_0x4e21b0++){const _0x58ea10=(_0x306461*_0x54275a+_0x4e21b0)*0x4,_0x3e7bdd=_0x25e1d8[_0x58ea10],_0x58e80a=_0x25e1d8[_0x58ea10+0x1],_0x465455=_0x25e1d8[_0x58ea10+0x2],_0x4244ba=findClosestColor(_0x3e7bdd,_0x58e80a,_0x465455,_0x5a0e65);_0x2acfd8[_0x58ea10]=_0x4244ba['r'],_0x2acfd8[_0x58ea10+0x1]=_0x4244ba['g'],_0x2acfd8[_0x58ea10+0x2]=_0x4244ba['b'];}}return _0x65a8a4;},'jarvis':function(_0x58c041,_0x697472,_0x178325){const _0xa8d94c=_0x43c175,_0x586649=_0x58c041[_0xa8d94c(0x112)],_0x445fcd=_0x58c041[_0xa8d94c(0x1ae)],_0x3a3d9b=_0x58c041[_0xa8d94c(0xbf)],_0x4daa92=new Uint8ClampedArray(_0x3a3d9b),_0x434193=_0x697472*0x1/0x30;for(let _0x2cee27=0x0;_0x2cee27<_0x445fcd;_0x2cee27++){for(let _0x59728b=0x0;_0x59728b<_0x586649;_0x59728b++){const _0x3efdd1=(_0x2cee27*_0x586649+_0x59728b)*0x4,_0x52e837=_0x4daa92[_0x3efdd1],_0x40fb01=_0x4daa92[_0x3efdd1+0x1],_0x3bc00e=_0x4daa92[_0x3efdd1+0x2],_0x2130b0=findClosestColor(_0x52e837,_0x40fb01,_0x3bc00e,_0x178325),_0x76f0da=(_0x52e837-_0x2130b0['r'])*_0x434193,_0x3bb4fe=(_0x40fb01-_0x2130b0['g'])*_0x434193,_0x441f0b=(_0x3bc00e-_0x2130b0['b'])*_0x434193;if(_0x59728b+0x1<_0x586649){const _0x5eaaad=_0x3efdd1+0x4;_0x4daa92[_0x5eaaad]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5eaaad]+_0x76f0da*0x7)),_0x4daa92[_0x5eaaad+0x1]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5eaaad+0x1]+_0x3bb4fe*0x7)),_0x4daa92[_0x5eaaad+0x2]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5eaaad+0x2]+_0x441f0b*0x7));}if(_0x59728b+0x2<_0x586649){const _0x44ed80=_0x3efdd1+0x8;_0x4daa92[_0x44ed80]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x44ed80]+_0x76f0da*0x5)),_0x4daa92[_0x44ed80+0x1]=Math[_0xa8d94c(0x105)](0xff,Math['max'](0x0,_0x4daa92[_0x44ed80+0x1]+_0x3bb4fe*0x5)),_0x4daa92[_0x44ed80+0x2]=Math[_0xa8d94c(0x105)](0xff,Math['max'](0x0,_0x4daa92[_0x44ed80+0x2]+_0x441f0b*0x5));}if(_0x2cee27+0x1<_0x445fcd){if(_0x59728b>0x1){const _0x593b80=_0x3efdd1+_0x586649*0x4-0x8;_0x4daa92[_0x593b80]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x593b80]+_0x76f0da*0x3)),_0x4daa92[_0x593b80+0x1]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x593b80+0x1]+_0x3bb4fe*0x3)),_0x4daa92[_0x593b80+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x593b80+0x2]+_0x441f0b*0x3));}if(_0x59728b>0x0){const _0x5bc77a=_0x3efdd1+_0x586649*0x4-0x4;_0x4daa92[_0x5bc77a]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5bc77a]+_0x76f0da*0x5)),_0x4daa92[_0x5bc77a+0x1]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5bc77a+0x1]+_0x3bb4fe*0x5)),_0x4daa92[_0x5bc77a+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5bc77a+0x2]+_0x441f0b*0x5));}const _0x5edd41=_0x3efdd1+_0x586649*0x4;_0x4daa92[_0x5edd41]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5edd41]+_0x76f0da*0x7)),_0x4daa92[_0x5edd41+0x1]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5edd41+0x1]+_0x3bb4fe*0x7)),_0x4daa92[_0x5edd41+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x5edd41+0x2]+_0x441f0b*0x7));if(_0x59728b+0x1<_0x586649){const _0x2a68fe=_0x3efdd1+_0x586649*0x4+0x4;_0x4daa92[_0x2a68fe]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x2a68fe]+_0x76f0da*0x5)),_0x4daa92[_0x2a68fe+0x1]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x2a68fe+0x1]+_0x3bb4fe*0x5)),_0x4daa92[_0x2a68fe+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x2a68fe+0x2]+_0x441f0b*0x5));}if(_0x59728b+0x2<_0x586649){const _0x2817b0=_0x3efdd1+_0x586649*0x4+0x8;_0x4daa92[_0x2817b0]=Math[_0xa8d94c(0x105)](0xff,Math['max'](0x0,_0x4daa92[_0x2817b0]+_0x76f0da*0x3)),_0x4daa92[_0x2817b0+0x1]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x2817b0+0x1]+_0x3bb4fe*0x3)),_0x4daa92[_0x2817b0+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x2817b0+0x2]+_0x441f0b*0x3));}}if(_0x2cee27+0x2<_0x445fcd){if(_0x59728b>0x1){const _0x254647=_0x3efdd1+_0x586649*0x4*0x2-0x8;_0x4daa92[_0x254647]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x254647]+_0x76f0da*0x1)),_0x4daa92[_0x254647+0x1]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x254647+0x1]+_0x3bb4fe*0x1)),_0x4daa92[_0x254647+0x2]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x254647+0x2]+_0x441f0b*0x1));}if(_0x59728b>0x0){const _0x400340=_0x3efdd1+_0x586649*0x4*0x2-0x4;_0x4daa92[_0x400340]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x400340]+_0x76f0da*0x3)),_0x4daa92[_0x400340+0x1]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x400340+0x1]+_0x3bb4fe*0x3)),_0x4daa92[_0x400340+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x400340+0x2]+_0x441f0b*0x3));}const _0x48dd19=_0x3efdd1+_0x586649*0x4*0x2;_0x4daa92[_0x48dd19]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x48dd19]+_0x76f0da*0x5)),_0x4daa92[_0x48dd19+0x1]=Math[_0xa8d94c(0x105)](0xff,Math['max'](0x0,_0x4daa92[_0x48dd19+0x1]+_0x3bb4fe*0x5)),_0x4daa92[_0x48dd19+0x2]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x48dd19+0x2]+_0x441f0b*0x5));if(_0x59728b+0x1<_0x586649){const _0x381de6=_0x3efdd1+_0x586649*0x4*0x2+0x4;_0x4daa92[_0x381de6]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x381de6]+_0x76f0da*0x3)),_0x4daa92[_0x381de6+0x1]=Math['min'](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x381de6+0x1]+_0x3bb4fe*0x3)),_0x4daa92[_0x381de6+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x381de6+0x2]+_0x441f0b*0x3));}if(_0x59728b+0x2<_0x586649){const _0x31e4e0=_0x3efdd1+_0x586649*0x4*0x2+0x8;_0x4daa92[_0x31e4e0]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x31e4e0]+_0x76f0da*0x1)),_0x4daa92[_0x31e4e0+0x1]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x31e4e0+0x1]+_0x3bb4fe*0x1)),_0x4daa92[_0x31e4e0+0x2]=Math[_0xa8d94c(0x105)](0xff,Math[_0xa8d94c(0xb0)](0x0,_0x4daa92[_0x31e4e0+0x2]+_0x441f0b*0x1));}}}}for(let _0x46505f=0x0;_0x46505f<_0x445fcd;_0x46505f++){for(let _0xa4afb0=0x0;_0xa4afb0<_0x586649;_0xa4afb0++){const _0x3a3ecd=(_0x46505f*_0x586649+_0xa4afb0)*0x4,_0x94a330=_0x4daa92[_0x3a3ecd],_0x17e43a=_0x4daa92[_0x3a3ecd+0x1],_0x4c6526=_0x4daa92[_0x3a3ecd+0x2],_0x4bafbd=findClosestColor(_0x94a330,_0x17e43a,_0x4c6526,_0x178325);_0x3a3d9b[_0x3a3ecd]=_0x4bafbd['r'],_0x3a3d9b[_0x3a3ecd+0x1]=_0x4bafbd['g'],_0x3a3d9b[_0x3a3ecd+0x2]=_0x4bafbd['b'];}}return _0x58c041;}};function floydSteinbergDither(_0x23fef8,_0x7ab98f,_0x4aac97){const _0x12cb76=_0x43c175,_0x320dde=_0x23fef8[_0x12cb76(0x112)],_0x55ff2e=_0x23fef8[_0x12cb76(0x1ae)],_0x48a0a9=_0x23fef8['data'],_0x2b5a37=new Uint8ClampedArray(_0x48a0a9);for(let _0x5805ee=0x0;_0x5805ee<_0x55ff2e;_0x5805ee++){for(let _0x58216f=0x0;_0x58216f<_0x320dde;_0x58216f++){const _0x566832=(_0x5805ee*_0x320dde+_0x58216f)*0x4,_0x4ba092=_0x2b5a37[_0x566832],_0xe0bc3f=_0x2b5a37[_0x566832+0x1],_0x567e2f=_0x2b5a37[_0x566832+0x2],_0x1ac3f0=findClosestColor(_0x4ba092,_0xe0bc3f,_0x567e2f,_0x4aac97),_0x390cac=(_0x4ba092-_0x1ac3f0['r'])*_0x7ab98f,_0x3023e1=(_0xe0bc3f-_0x1ac3f0['g'])*_0x7ab98f,_0x37709d=(_0x567e2f-_0x1ac3f0['b'])*_0x7ab98f;if(_0x58216f+0x1<_0x320dde){const _0x3756c7=_0x566832+0x4;_0x2b5a37[_0x3756c7]=Math['min'](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x3756c7]+_0x390cac*0x7/0x10)),_0x2b5a37[_0x3756c7+0x1]=Math[_0x12cb76(0x105)](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x3756c7+0x1]+_0x3023e1*0x7/0x10)),_0x2b5a37[_0x3756c7+0x2]=Math[_0x12cb76(0x105)](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x3756c7+0x2]+_0x37709d*0x7/0x10));}if(_0x5805ee+0x1<_0x55ff2e){if(_0x58216f>0x0){const _0x20112b=_0x566832+_0x320dde*0x4-0x4;_0x2b5a37[_0x20112b]=Math[_0x12cb76(0x105)](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x20112b]+_0x390cac*0x3/0x10)),_0x2b5a37[_0x20112b+0x1]=Math[_0x12cb76(0x105)](0xff,Math['max'](0x0,_0x2b5a37[_0x20112b+0x1]+_0x3023e1*0x3/0x10)),_0x2b5a37[_0x20112b+0x2]=Math['min'](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x20112b+0x2]+_0x37709d*0x3/0x10));}const _0x48c1f6=_0x566832+_0x320dde*0x4;_0x2b5a37[_0x48c1f6]=Math[_0x12cb76(0x105)](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x48c1f6]+_0x390cac*0x5/0x10)),_0x2b5a37[_0x48c1f6+0x1]=Math[_0x12cb76(0x105)](0xff,Math['max'](0x0,_0x2b5a37[_0x48c1f6+0x1]+_0x3023e1*0x5/0x10)),_0x2b5a37[_0x48c1f6+0x2]=Math['min'](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x48c1f6+0x2]+_0x37709d*0x5/0x10));if(_0x58216f+0x1<_0x320dde){const _0x18cb69=_0x566832+_0x320dde*0x4+0x4;_0x2b5a37[_0x18cb69]=Math[_0x12cb76(0x105)](0xff,Math['max'](0x0,_0x2b5a37[_0x18cb69]+_0x390cac*0x1/0x10)),_0x2b5a37[_0x18cb69+0x1]=Math[_0x12cb76(0x105)](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x18cb69+0x1]+_0x3023e1*0x1/0x10)),_0x2b5a37[_0x18cb69+0x2]=Math[_0x12cb76(0x105)](0xff,Math[_0x12cb76(0xb0)](0x0,_0x2b5a37[_0x18cb69+0x2]+_0x37709d*0x1/0x10));}}}}for(let _0x4acf99=0x0;_0x4acf99<_0x55ff2e;_0x4acf99++){for(let _0x20ae76=0x0;_0x20ae76<_0x320dde;_0x20ae76++){const _0x9a9bf=(_0x4acf99*_0x320dde+_0x20ae76)*0x4,_0x158e6c=_0x2b5a37[_0x9a9bf],_0x5df06a=_0x2b5a37[_0x9a9bf+0x1],_0x1d5cf7=_0x2b5a37[_0x9a9bf+0x2],_0x4f1299=findClosestColor(_0x158e6c,_0x5df06a,_0x1d5cf7,_0x4aac97);_0x48a0a9[_0x9a9bf]=_0x4f1299['r'],_0x48a0a9[_0x9a9bf+0x1]=_0x4f1299['g'],_0x48a0a9[_0x9a9bf+0x2]=_0x4f1299['b'];}}return _0x23fef8;}function processImage1(_0x38bc78,_0x48e4f1,_0x244a9d,_0x5ccc0b,_0x224779,_0x51704d,_0x39008e){const _0x5059ed=_0x43c175,_0x19bfc2=new ImageData(new Uint8ClampedArray(_0x38bc78[_0x5059ed(0xbf)]),_0x38bc78['width'],_0x38bc78['height']);return adjustBrightness(_0x19bfc2,_0x48e4f1),adjustContrast(_0x19bfc2,_0x244a9d),adjustSaturation(_0x19bfc2,_0x5ccc0b),DitherAlgorithms[_0x39008e]?DitherAlgorithms[_0x39008e](_0x19bfc2,_0x224779,_0x51704d):floydSteinbergDither(_0x19bfc2,_0x224779,_0x51704d),_0x19bfc2;}function imageDataToEpdBytes(_0x38c2f4,_0x28d06c){const _0x37c199=_0x43c175,_0x39a159=_0x38c2f4[_0x37c199(0x112)],_0x3e454d=_0x38c2f4[_0x37c199(0x1ae)],_0x41cdf6=_0x38c2f4[_0x37c199(0xbf)];let _0x1884a1;if(_0x28d06c===_0x37c199(0xc4)){_0x1884a1=new Uint8Array(Math[_0x37c199(0x188)](_0x39a159*_0x3e454d/0x8)*0x2);let _0x2fb554=0x0,_0x443bb7=Math['ceil'](_0x39a159*_0x3e454d/0x8),_0x1b40a1=0x0,_0x1d4607=0x0,_0x1d8b90=0x0;for(let _0x29216a=0x0;_0x29216a<_0x41cdf6[_0x37c199(0xb7)];_0x29216a+=0x4){const _0x484be7=_0x41cdf6[_0x29216a],_0x136fa8=_0x41cdf6[_0x29216a+0x1],_0x45c5f5=_0x41cdf6[_0x29216a+0x2],_0x518567=_0x484be7>0xc8&&_0x136fa8<0x32&&_0x45c5f5<0x32,_0x2e421a=!_0x518567&&0.299*_0x484be7+0.587*_0x136fa8+0.114*_0x45c5f5<0x80;_0x2e421a&&(_0x1d4607|=0x1<<0x7-_0x1b40a1),_0x518567&&(_0x1d8b90|=0x1<<0x7-_0x1b40a1),_0x1b40a1++,_0x1b40a1===0x8&&(_0x1884a1[_0x2fb554++]=_0x1d4607,_0x1884a1[_0x443bb7++]=_0x1d8b90,_0x1b40a1=0x0,_0x1d4607=0x0,_0x1d8b90=0x0);}_0x1b40a1>0x0&&(_0x1884a1[_0x2fb554]=_0x1d4607,_0x1884a1[_0x443bb7]=_0x1d8b90);}else{_0x1884a1=new Uint8Array(Math[_0x37c199(0x188)](_0x39a159*_0x3e454d/0x8));let _0x2ff448=0x0,_0x59c193=0x0,_0xf50f5b=0x0;for(let _0x1d6ac6=0x0;_0x1d6ac6<_0x41cdf6[_0x37c199(0xb7)];_0x1d6ac6+=0x4){const _0x15f888=_0x41cdf6[_0x1d6ac6],_0x4d88d2=_0x41cdf6[_0x1d6ac6+0x1],_0x3aa6a8=_0x41cdf6[_0x1d6ac6+0x2],_0x23dbac=0.299*_0x15f888+0.587*_0x4d88d2+0.114*_0x3aa6a8<0x80;_0x23dbac&&(_0xf50f5b|=0x1<<0x7-_0x59c193),_0x59c193++,_0x59c193===0x8&&(_0x1884a1[_0x2ff448++]=_0xf50f5b,_0x59c193=0x0,_0xf50f5b=0x0);}_0x59c193>0x0&&(_0x1884a1[_0x2ff448]=_0xf50f5b);}return _0x1884a1;}const imageUpload=document['getElementById']('imageFile'),previewCanvas=document[_0x43c175(0xa2)]('previewCanvas'),floatPreviewCanvas=document[_0x43c175(0xa2)](_0x43c175(0x153)),noImagePlaceholder=document['getElementById'](_0x43c175(0x170)),processedImageInfo=document[_0x43c175(0xa2)](_0x43c175(0x123)),btnProcess=document[_0x43c175(0xa2)](_0x43c175(0x17a)),btnSend=document[_0x43c175(0xa2)]('btnSend'),btnDownload=document[_0x43c175(0xa2)]('btnDownload'),btnReset=document[_0x43c175(0xa2)]('btnReset'),btnClearLog=document[_0x43c175(0xa2)](_0x43c175(0xb2)),btnBlackWhite=document['getElementById']('btnBlackWhite'),btnBlackWhiteRed=document['getElementById'](_0x43c175(0x181)),ditherMode=document['getElementById']('ditherMode'),ditherAlg=document[_0x43c175(0xa2)](_0x43c175(0x13f)),logContainer=document['getElementById'](_0x43c175(0x76)),statusContainer=document['getElementById'](_0x43c175(0x183)),floatingCanvasContainer=document[_0x43c175(0xa2)](_0x43c175(0x13c)),toggleCanvasFloat=document[_0x43c175(0xa2)]('toggleCanvasFloat'),closeCanvas=document[_0x43c175(0xa2)](_0x43c175(0x11d)),canvasResizeHandle=document[_0x43c175(0xa2)](_0x43c175(0x137)),imageScaleSlider=document[_0x43c175(0xa2)](_0x43c175(0x168)),imageScaleValue=document[_0x43c175(0xa2)](_0x43c175(0x177)),addTextBtn=document[_0x43c175(0xa2)](_0x43c175(0x78)),timeDialog=document['getElementById'](_0x43c175(0xfd)),datetimeInput=document[_0x43c175(0xa2)](_0x43c175(0x1b0)),closeTimeDialog=document['getElementById'](_0x43c175(0x11e)),confirmTimeBtn=document[_0x43c175(0xa2)](_0x43c175(0x180)),imageWidthInput=document[_0x43c175(0xa2)](_0x43c175(0x182)),imageHeightInput=document[_0x43c175(0xa2)](_0x43c175(0x107)),toolPen=document[_0x43c175(0xa2)](_0x43c175(0xe3)),toolEraser=document['getElementById']('toolEraser'),toolText=document[_0x43c175(0xa2)](_0x43c175(0xc1)),toolClear=document[_0x43c175(0xa2)](_0x43c175(0x186)),brushSizeSlider=document[_0x43c175(0xa2)](_0x43c175(0x164)),fontSizeInput=document[_0x43c175(0xa2)](_0x43c175(0x133)),fontFamilySelect=document[_0x43c175(0xa2)](_0x43c175(0x1b2)),textInput=document[_0x43c175(0xa2)](_0x43c175(0xd3)),drawingStatus=document[_0x43c175(0xa2)](_0x43c175(0x8e)),currentToolEl=document['getElementById']('currentTool'),currentSizeEl=document['getElementById']('currentSize'),drawingModeIndicator=document['getElementById'](_0x43c175(0xa6)),toggleDrawingModeBtn=document[_0x43c175(0xa2)](_0x43c175(0x19f)),floatToggleDrawingModeBtn=document[_0x43c175(0xa2)](_0x43c175(0xa5)),sliders={'saturation':document[_0x43c175(0xa2)](_0x43c175(0x13d)),'brightness':document[_0x43c175(0xa2)](_0x43c175(0xf5)),'contrast':document[_0x43c175(0xa2)](_0x43c175(0x16e)),'diffusion':document[_0x43c175(0xa2)]('diffusion')},ditherSlider=document[_0x43c175(0xa2)](_0x43c175(0x17b)),sliderValues={'saturation':document[_0x43c175(0xa2)]('saturationValue'),'brightness':document[_0x43c175(0xa2)]('brightnessValue'),'contrast':document[_0x43c175(0xa2)](_0x43c175(0x138)),'diffusion':document['getElementById'](_0x43c175(0xd6))};function init(){const _0x266519=_0x43c175;canvas=previewCanvas,ctx=canvas['getContext']('2d'),floatCanvas=floatPreviewCanvas,floatCtx=floatCanvas['getContext']('2d'),updateCanvasSize();const _0x3b910b=new Date(),_0x2d6ef6=new Date(_0x3b910b[_0x266519(0xd5)]()-_0x3b910b['getTimezoneOffset']()*0xea60)['toISOString']()[_0x266519(0x159)](0x0,0x10);datetimeInput[_0x266519(0x1a9)]=_0x2d6ef6,canvas[_0x266519(0xe9)]('mousedown',startDrawing),canvas[_0x266519(0xe9)]('mousemove',draw),canvas[_0x266519(0xe9)](_0x266519(0x127),stopDrawing),canvas[_0x266519(0xe9)](_0x266519(0x158),stopDrawing),floatCanvas[_0x266519(0xe9)]('mousedown',startDrawingFloat),floatCanvas['addEventListener'](_0x266519(0xb6),drawFloat),floatCanvas[_0x266519(0xe9)](_0x266519(0x127),stopDrawing),floatCanvas[_0x266519(0xe9)](_0x266519(0x158),stopDrawing),canvas[_0x266519(0xe9)](_0x266519(0x187),handleTouchStart,{'passive':![]}),canvas[_0x266519(0xe9)]('touchmove',handleTouchMove,{'passive':![]}),canvas[_0x266519(0xe9)](_0x266519(0xae),handleTouchEnd),canvas[_0x266519(0xe9)](_0x266519(0x9a),handleTouchEnd),floatCanvas['addEventListener'](_0x266519(0x187),handleFloatTouchStart,{'passive':![]}),floatCanvas[_0x266519(0xe9)](_0x266519(0x81),handleFloatTouchMove,{'passive':![]}),floatCanvas[_0x266519(0xe9)]('touchend',handleTouchEnd),floatCanvas[_0x266519(0xe9)]('touchcancel',handleTouchEnd),document[_0x266519(0xe9)](_0x266519(0x15f),_0x184628=>{const _0x24d44b=_0x266519;_0x184628[_0x24d44b(0x19a)]===_0x24d44b(0x16a)&&(shiftKeyPressed=!![],sourceImage&&!isDrawingModeActive&&(canvas[_0x24d44b(0xef)][_0x24d44b(0x13b)]=_0x24d44b(0x115),floatCanvas[_0x24d44b(0xef)][_0x24d44b(0x13b)]='move'));}),document[_0x266519(0xe9)](_0x266519(0x1ab),_0x1b2dbf=>{const _0x599c4c=_0x266519;_0x1b2dbf[_0x599c4c(0x19a)]===_0x599c4c(0x16a)&&(shiftKeyPressed=![],updateCursorStyle());}),toggleDrawingModeBtn[_0x266519(0xe9)](_0x266519(0xe0),toggleDrawingMode),floatToggleDrawingModeBtn[_0x266519(0xe9)]('click',toggleDrawingMode),btnProcess[_0x266519(0xe9)](_0x266519(0xe0),processImage),btnSend[_0x266519(0xe9)]('click',sendimg),btnDownload[_0x266519(0xe9)](_0x266519(0xe0),downloadImageFile),btnReset[_0x266519(0xe9)](_0x266519(0xe0),resetProcessing),btnClearLog[_0x266519(0xe9)](_0x266519(0xe0),clearLog),toggleCanvasFloat[_0x266519(0xe9)](_0x266519(0xe0),toggleCanvas),closeCanvas[_0x266519(0xe9)]('click',hideCanvas),btnSetTime[_0x266519(0xe9)](_0x266519(0xe0),showTimeDialog),closeTimeDialog[_0x266519(0xe9)](_0x266519(0xe0),hideTimeDialog),confirmTimeBtn[_0x266519(0xe9)](_0x266519(0xe0),setTime),brushSizeSlider[_0x266519(0xe9)](_0x266519(0x141),function(){const _0x6c17d7=_0x266519;brushSize=parseInt(this['value']),currentSizeEl[_0x6c17d7(0x19d)]=brushSize;});const _0xab8278=floatingCanvasContainer[_0x266519(0x169)](_0x266519(0x87));_0xab8278[_0x266519(0xe9)]('mousedown',startDrag),document['addEventListener'](_0x266519(0xb6),drag),document[_0x266519(0xe9)](_0x266519(0x127),stopDrag),canvasResizeHandle['addEventListener']('mousedown',startResize),document['addEventListener'](_0x266519(0xb6),resize),document['addEventListener'](_0x266519(0x127),stopResize),Object['keys'](sliders)['forEach'](_0x2ee259=>{const _0x1bfc76=_0x266519;sliders[_0x2ee259][_0x1bfc76(0xe9)](_0x1bfc76(0x141),_0x9a531d=>{const _0x4b4237=_0x1bfc76;currentParams[_0x2ee259]=parseInt(_0x9a531d[_0x4b4237(0x184)][_0x4b4237(0x1a9)]),sliderValues[_0x2ee259][_0x4b4237(0x19d)]=''+currentParams[_0x2ee259];});}),document['getElementById'](_0x266519(0x91))[_0x266519(0xe9)](_0x266519(0x89),function(){const _0x5b06a2=_0x266519,_0x49d227=getSelectedCanvasSize();imageWidthInput[_0x5b06a2(0x1a9)]=_0x49d227[_0x5b06a2(0x112)],imageHeightInput[_0x5b06a2(0x1a9)]=_0x49d227[_0x5b06a2(0x1ae)];}),addLog(_0x266519(0x9c)),updateButtonStatus();}function toggleDrawingMode(){const _0x28794c=_0x43c175;isDrawingModeActive=!isDrawingModeActive,isDrawingModeActive?(toggleDrawingModeBtn['innerHTML']='<i\x20class=\x22fa\x20fa-stop\x20mr-1\x22></i>退出绘画',toggleDrawingModeBtn['classList'][_0x28794c(0x11c)](_0x28794c(0x16c)),toggleDrawingModeBtn['classList'][_0x28794c(0x16f)](_0x28794c(0x9d)),floatToggleDrawingModeBtn[_0x28794c(0x1ba)]=_0x28794c(0x108),floatToggleDrawingModeBtn['classList']['add'](_0x28794c(0x82)),drawingModeIndicator[_0x28794c(0x15c)][_0x28794c(0x11c)]('hidden'),addLog(_0x28794c(0x195))):(toggleDrawingModeBtn[_0x28794c(0x1ba)]='<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画',toggleDrawingModeBtn[_0x28794c(0x15c)]['remove']('bg-amber-500'),toggleDrawingModeBtn[_0x28794c(0x15c)][_0x28794c(0x16f)](_0x28794c(0x16c)),floatToggleDrawingModeBtn[_0x28794c(0x1ba)]=_0x28794c(0x12c),floatToggleDrawingModeBtn[_0x28794c(0x15c)][_0x28794c(0x11c)]('text-amber-300'),drawingModeIndicator['classList']['add'](_0x28794c(0x1a8)),addLog(_0x28794c(0x193))),updateCursorStyle();}function updateCursorStyle(){const _0x1e1fb5=_0x43c175;if(isDrawingModeActive){if(currentTool==='pen')canvas['style']['cursor']=_0x1e1fb5(0xf6),floatCanvas['style'][_0x1e1fb5(0x13b)]=_0x1e1fb5(0xf6);else{if(currentTool===_0x1e1fb5(0x84))canvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x90),floatCanvas['style'][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x90);else currentTool===_0x1e1fb5(0x18e)&&(canvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]='text',floatCanvas['style'][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x18e));}}else{if(shiftKeyPressed&&sourceImage)canvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x115),floatCanvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x115);else{if(currentTool===_0x1e1fb5(0xc7))canvas[_0x1e1fb5(0xef)]['cursor']='crosshair',floatCanvas['style'][_0x1e1fb5(0x13b)]=_0x1e1fb5(0xf6);else{if(currentTool===_0x1e1fb5(0x84))canvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x90),floatCanvas['style'][_0x1e1fb5(0x13b)]='url(\x22data:image/svg+xml,%3Csvg\x20xmlns=\x27http://www.w3.org/2000/svg\x27\x20width=\x2724\x27\x20height=\x2724\x27\x20viewBox=\x270\x200\x2024\x2024\x27\x20fill=\x27none\x27\x20stroke=\x27black\x27\x20stroke-width=\x272\x27\x20stroke-linecap=\x27round\x27\x20stroke-linejoin=\x27round\x27%3E%3Cpath\x20d=\x27M18\x2013L5\x205\x27/%3E%3C/svg%3E\x22)\x200\x2024,\x20auto';else currentTool===_0x1e1fb5(0x18e)&&(canvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]=_0x1e1fb5(0x18e),floatCanvas[_0x1e1fb5(0xef)][_0x1e1fb5(0x13b)]='text');}}}}function setDrawingTool(_0x4a575a){const _0x53d965=_0x43c175;currentTool=_0x4a575a,[toolPen,toolEraser,toolText,toolClear][_0x53d965(0xeb)](_0x294594=>{const _0x3e9553=_0x53d965;_0x294594[_0x3e9553(0x15c)][_0x3e9553(0x11c)](_0x3e9553(0xe8));});switch(_0x4a575a){case'pen':toolPen[_0x53d965(0x15c)]['add'](_0x53d965(0xe8)),currentToolEl['textContent']='画笔';break;case _0x53d965(0x84):toolEraser['classList'][_0x53d965(0x16f)](_0x53d965(0xe8)),currentToolEl['textContent']='橡皮擦';break;case _0x53d965(0x18e):toolText[_0x53d965(0x15c)]['add'](_0x53d965(0xe8)),currentToolEl['textContent']='文字';break;}currentSizeEl['textContent']=brushSize,drawingStatus['classList']['remove'](_0x53d965(0x1a8)),updateCursorStyle();}function setBrushColor(_0x40656f){const _0x3818b0=_0x43c175;brushColor=_0x40656f,document[_0x3818b0(0xa2)](_0x3818b0(0xed))[_0x3818b0(0x1a9)]=_0x40656f,addLog(_0x3818b0(0x14a)+_0x40656f);}function getCanvasCoordinates(_0x944eef,_0x1f5c6c,_0x34a84f=![]){const _0x424df2=_0x43c175,_0x41ed87=_0x944eef[_0x424df2(0x173)](),_0x592080=_0x944eef[_0x424df2(0x112)]/_0x41ed87[_0x424df2(0x112)],_0x40a7c3=_0x944eef[_0x424df2(0x1ae)]/_0x41ed87[_0x424df2(0x1ae)];let _0x358bf4,_0x4452b2;return _0x34a84f?(_0x358bf4=(_0x1f5c6c[_0x424df2(0x166)][0x0][_0x424df2(0x189)]-_0x41ed87[_0x424df2(0x11a)])*_0x592080,_0x4452b2=(_0x1f5c6c[_0x424df2(0x166)][0x0][_0x424df2(0xcf)]-_0x41ed87[_0x424df2(0x178)])*_0x40a7c3):(_0x358bf4=(_0x1f5c6c[_0x424df2(0x189)]-_0x41ed87[_0x424df2(0x11a)])*_0x592080,_0x4452b2=(_0x1f5c6c[_0x424df2(0xcf)]-_0x41ed87[_0x424df2(0x178)])*_0x40a7c3),{'x':_0x358bf4,'y':_0x4452b2};}function isPointOnImage(_0x1bdaca,_0x297197){const _0x44c8dc=_0x43c175;if(!sourceImage)return![];const _0x51179f=imageScale/0x64;let _0x441f7e=sourceImage[_0x44c8dc(0x112)]*_0x51179f,_0x4bb452=sourceImage[_0x44c8dc(0x1ae)]*_0x51179f;return imageRotation%0xb4!==0x0&&([_0x441f7e,_0x4bb452]=[_0x4bb452,_0x441f7e]),_0x1bdaca>=imageOffset['x']&&_0x1bdaca<=imageOffset['x']+_0x441f7e&&_0x297197>=imageOffset['y']&&_0x297197<=imageOffset['y']+_0x4bb452;}function startDrawing(_0x36a780){const _0x38b3ae=getCanvasCoordinates(canvas,_0x36a780);startDrawingCommon(_0x38b3ae);}function startDrawingFloat(_0x360c40){const _0x2a1d70=getCanvasCoordinates(floatCanvas,_0x360c40);startDrawingCommon(_0x2a1d70);}function handleTouchStart(_0x530053){const _0x128a8d=_0x43c175;_0x530053['preventDefault']();if(_0x530053['touches'][_0x128a8d(0xb7)]!==0x1)return;const _0x46c234=getCanvasCoordinates(canvas,_0x530053,!![]);startDrawingCommon(_0x46c234);}function handleFloatTouchStart(_0x170271){const _0x3252cc=_0x43c175;_0x170271[_0x3252cc(0x98)]();if(_0x170271[_0x3252cc(0x166)][_0x3252cc(0xb7)]!==0x1)return;const _0x145134=getCanvasCoordinates(floatCanvas,_0x170271,!![]);startDrawingCommon(_0x145134);}function startDrawingCommon(_0xba4653){const _0x6bc1d2=_0x43c175;lastX=_0xba4653['x'],lastY=_0xba4653['y'],isDrawing=!![];if(!isDrawingModeActive&&sourceImage&&(isPointOnImage(_0xba4653['x'],_0xba4653['y'])&&currentTool!=='text'))isDraggingImage=!![],dragStartPos={'x':_0xba4653['x'],'y':_0xba4653['y']},isDrawing=![],canvas[_0x6bc1d2(0xef)]['cursor']=_0x6bc1d2(0x115),floatCanvas[_0x6bc1d2(0xef)][_0x6bc1d2(0x13b)]=_0x6bc1d2(0x115);else currentTool===_0x6bc1d2(0x18e)&&(addTextToCanvas(_0xba4653['x'],_0xba4653['y']),isDrawing=![]);}function draw(_0x3ed19f){const _0xe63cb8=getCanvasCoordinates(canvas,_0x3ed19f);drawCommon(_0xe63cb8);}function drawFloat(_0x15185d){const _0x980583=getCanvasCoordinates(floatCanvas,_0x15185d);drawCommon(_0x980583);}function handleTouchMove(_0x3779a8){const _0x578286=_0x43c175;_0x3779a8[_0x578286(0x98)]();if(_0x3779a8[_0x578286(0x166)][_0x578286(0xb7)]!==0x1)return;const _0x2b90c0=getCanvasCoordinates(canvas,_0x3779a8,!![]);drawCommon(_0x2b90c0);}function handleFloatTouchMove(_0x1cacf4){const _0x5d1fdd=_0x43c175;_0x1cacf4[_0x5d1fdd(0x98)]();if(_0x1cacf4[_0x5d1fdd(0x166)][_0x5d1fdd(0xb7)]!==0x1)return;const _0x3cc221=getCanvasCoordinates(floatCanvas,_0x1cacf4,!![]);drawCommon(_0x3cc221);}function drawCommon(_0x32a7f8){if(isDraggingImage&&!isDrawingModeActive){const _0x5f327d=_0x32a7f8['x']-dragStartPos['x'],_0x1ea601=_0x32a7f8['y']-dragStartPos['y'];imageOffset['x']+=_0x5f327d,imageOffset['y']+=_0x1ea601,dragStartPos=_0x32a7f8,redrawImageWithScaleAndOffset();return;}if(!isDrawing)return;drawOnCanvas(lastX,lastY,_0x32a7f8['x'],_0x32a7f8['y']),lastX=_0x32a7f8['x'],lastY=_0x32a7f8['y'],syncCanvases();}function stopDrawing(){isDrawing=![],isDraggingImage&&(isDraggingImage=![],updateCursorStyle());}function handleTouchEnd(){stopDrawing();}function drawOnCanvas(_0x408362,_0x398064,_0x102f9d,_0xbf6422){const _0x29900b=_0x43c175;ctx['save'](),ctx['lineCap']=_0x29900b(0x19e),ctx[_0x29900b(0xab)]=_0x29900b(0x19e),ctx[_0x29900b(0x139)]=brushSize;if(currentTool===_0x29900b(0xc7))ctx[_0x29900b(0x18a)]=brushColor;else currentTool===_0x29900b(0x84)&&(ctx[_0x29900b(0x18a)]=_0x29900b(0x149),ctx['lineWidth']=brushSize*0x2);ctx[_0x29900b(0xee)](),ctx[_0x29900b(0x8d)](_0x408362,_0x398064),ctx['lineTo'](_0x102f9d,_0xbf6422),ctx[_0x29900b(0x92)](),ctx[_0x29900b(0x118)]();}function addTextToCanvas(_0x1ea7e1,_0x5e64aa){const _0x54a30d=_0x43c175,_0xd91bae=textInput[_0x54a30d(0x1a9)]||_0x54a30d(0x106),_0x43decd=parseInt(fontSizeInput['value']),_0x5123ab=fontFamilySelect[_0x54a30d(0x1a9)];if(!_0xd91bae[_0x54a30d(0x15d)]())return;ctx['save'](),ctx[_0x54a30d(0x80)]=_0x43decd+_0x54a30d(0xfb)+_0x5123ab,ctx[_0x54a30d(0xbd)]=brushColor,ctx[_0x54a30d(0x194)]=_0x54a30d(0x178),ctx[_0x54a30d(0x190)](_0xd91bae,_0x1ea7e1,_0x5e64aa),ctx[_0x54a30d(0x118)](),syncCanvases(),addLog(_0x54a30d(0x134)+_0xd91bae+'\x22');}function addTextManually(){const _0x5599b5=_0x43c175;setDrawingTool(_0x5599b5(0x18e));if(textInput[_0x5599b5(0x1a9)][_0x5599b5(0x15d)]()){const _0x5d132c=getSelectedCanvasSize(),_0x7bd3e2=_0x5d132c['width']/0x2,_0x52970a=_0x5d132c[_0x5599b5(0x1ae)]/0x2;addTextToCanvas(_0x7bd3e2,_0x52970a);}else addLog(_0x5599b5(0x14f));}function clearCanvas(){const _0x19ff6e=_0x43c175;confirm(_0x19ff6e(0x146))&&(ctx[_0x19ff6e(0x171)](),ctx[_0x19ff6e(0xbd)]=_0x19ff6e(0x149),ctx['fillRect'](0x0,0x0,canvas['width'],canvas['height']),ctx[_0x19ff6e(0x118)](),syncCanvases(),addLog(_0x19ff6e(0xb4)));}function syncCanvases(){const _0x3c983b=_0x43c175;floatCtx['clearRect'](0x0,0x0,floatCanvas[_0x3c983b(0x112)],floatCanvas[_0x3c983b(0x1ae)]),floatCtx[_0x3c983b(0x7b)](canvas,0x0,0x0);}function changeImageScale(_0x2ef1bb){const _0x347a35=_0x43c175;if(!sourceImage)return;imageScale=Math[_0x347a35(0xb0)](0x0,Math[_0x347a35(0x105)](0x3e8,imageScale+_0x2ef1bb)),imageScaleSlider['value']=imageScale,updateImageScale();}function updateImageScale(){const _0x51b961=_0x43c175;if(!sourceImage)return;imageScale=parseInt(imageScaleSlider[_0x51b961(0x1a9)]),imageScaleValue['textContent']=imageScale+'%',redrawImageWithScaleAndOffset();}function redrawImageWithScaleAndOffset(){const _0x3d7fa4=_0x43c175;if(!sourceImage)return;ctx[_0x3d7fa4(0xbd)]='#FFFFFF',ctx[_0x3d7fa4(0x142)](0x0,0x0,canvas['width'],canvas[_0x3d7fa4(0x1ae)]);const _0x7b49a8=imageScale/0x64;let _0x59344e=sourceImage[_0x3d7fa4(0x112)]*_0x7b49a8,_0x451063=sourceImage['height']*_0x7b49a8;ctx[_0x3d7fa4(0x171)](),ctx['translate'](imageOffset['x']+_0x59344e/0x2,imageOffset['y']+_0x451063/0x2),ctx[_0x3d7fa4(0x1b1)](imageRotation*Math['PI']/0xb4),ctx['drawImage'](sourceImage,-_0x59344e/0x2,-_0x451063/0x2,_0x59344e,_0x451063),ctx['restore'](),syncCanvases();}function fitImageToCanvas(){const _0x476cbb=_0x43c175;if(!sourceImage)return;const _0x5ecab5=getSelectedCanvasSize();let _0x161c55=_0x5ecab5[_0x476cbb(0x112)],_0x520f84=_0x5ecab5[_0x476cbb(0x1ae)];const _0x273800=_0x161c55/sourceImage['width'],_0x4274f9=_0x520f84/sourceImage[_0x476cbb(0x1ae)],_0x42357e=Math[_0x476cbb(0x105)](_0x273800,_0x4274f9);imageScale=_0x42357e*0x64,imageScaleSlider[_0x476cbb(0x1a9)]=imageScale,imageScaleValue[_0x476cbb(0x19d)]=imageScale[_0x476cbb(0x163)](0x0)+'%',imageOffset['x']=_0x161c55-sourceImage[_0x476cbb(0x112)]*_0x42357e,imageOffset['y']=_0x520f84-sourceImage['height']*_0x42357e,redrawImageWithScaleAndOffset(),addLog(_0x476cbb(0xcd));}function fillCanvas(){const _0x4ccb73=_0x43c175;if(!sourceImage)return;const _0x2d9fc0=getSelectedCanvasSize();let _0x273bd5=_0x2d9fc0[_0x4ccb73(0x112)],_0x176249=_0x2d9fc0[_0x4ccb73(0x1ae)];const _0x169176=_0x273bd5/sourceImage[_0x4ccb73(0x112)],_0x59418b=_0x176249/sourceImage[_0x4ccb73(0x1ae)];imageScale=Math['max'](_0x169176,_0x59418b)*0x64,imageScaleSlider[_0x4ccb73(0x1a9)]=imageScale,imageScaleValue[_0x4ccb73(0x19d)]=imageScale['toFixed'](0x0)+'%',imageOffset['x']=0x0,imageOffset['y']=0x0,redrawImageWithScaleAndOffset(),addLog(_0x4ccb73(0x132));}function centerImageOnCanvas(){const _0x95ce0d=_0x43c175;if(!sourceImage)return;const _0x435444=getSelectedCanvasSize();let _0x27d7c3=_0x435444[_0x95ce0d(0x112)],_0x33e02d=_0x435444[_0x95ce0d(0x1ae)];const _0x4f3418=imageScale/0x64;let _0x27e7b8=sourceImage[_0x95ce0d(0x112)]*_0x4f3418,_0x2b7743=sourceImage[_0x95ce0d(0x1ae)]*_0x4f3418;imageOffset['x']=(_0x27d7c3-_0x27e7b8)/0x2,imageOffset['y']=(_0x33e02d-_0x2b7743)/0x2,redrawImageWithScaleAndOffset(),addLog('图片已居中显示');}function rotateImage(_0x265b05){const _0x3913fa=_0x43c175;if(!sourceImage){addLog(_0x3913fa(0x12e));return;}imageRotation=(imageRotation+_0x265b05)%0x168,redrawImageWithScaleAndOffset(),addLog(_0x3913fa(0x117)+imageRotation+'°');}function resizeImage(_0x54291c,_0x12220a){const _0x2091d1=_0x43c175;if(!sourceImage||!originalImage)return;const _0x32fc21=originalImage[_0x2091d1(0x112)]/originalImage[_0x2091d1(0x1ae)];let _0x17a30a=sourceImage[_0x2091d1(0x112)]+_0x54291c,_0x2e1517=sourceImage[_0x2091d1(0x1ae)]+_0x12220a;_0x17a30a=Math['max'](0x32,_0x17a30a),_0x2e1517=Math['max'](0x32,_0x2e1517),imageWidthInput[_0x2091d1(0x1a9)]=Math[_0x2091d1(0x19e)](_0x17a30a),imageHeightInput['value']=Math[_0x2091d1(0x19e)](_0x2e1517);const _0x34cf78=new Image();_0x34cf78[_0x2091d1(0x83)]=function(){const _0x14f420=_0x2091d1;sourceImage=_0x34cf78,redrawImageWithScaleAndOffset(),addLog(_0x14f420(0xdc)+_0x17a30a+_0x14f420(0xa9)+_0x2e1517);};const _0x49a900=document[_0x2091d1(0xb5)]('canvas');_0x49a900['width']=_0x17a30a,_0x49a900[_0x2091d1(0x1ae)]=_0x2e1517;const _0x21ee91=_0x49a900[_0x2091d1(0x148)]('2d');_0x21ee91[_0x2091d1(0x7b)](originalImage,0x0,0x0,_0x17a30a,_0x2e1517),_0x34cf78[_0x2091d1(0xc2)]=_0x49a900['toDataURL']();}function applyImageDimensions(){const _0xf5ce44=_0x43c175,_0x4fdbde=parseInt(imageWidthInput[_0xf5ce44(0x1a9)]),_0x5aa700=parseInt(imageHeightInput[_0xf5ce44(0x1a9)]);if(isNaN(_0x4fdbde)||isNaN(_0x5aa700)||_0x4fdbde<0x32||_0x5aa700<0x32){addLog(_0xf5ce44(0x10e));return;}if(originalImage){const _0x3168f2=new Image();_0x3168f2[_0xf5ce44(0x83)]=function(){const _0x2ec205=_0xf5ce44;sourceImage=_0x3168f2,fitImageToCanvas(),addLog(_0x2ec205(0xde)+_0x4fdbde+_0x2ec205(0xa9)+_0x5aa700);};const _0x3a736f=document['createElement']('canvas');_0x3a736f[_0xf5ce44(0x112)]=_0x4fdbde,_0x3a736f[_0xf5ce44(0x1ae)]=_0x5aa700;const _0xb437d5=_0x3a736f['getContext']('2d');_0xb437d5[_0xf5ce44(0x7b)](originalImage,0x0,0x0,_0x4fdbde,_0x5aa700),_0x3168f2[_0xf5ce44(0xc2)]=_0x3a736f[_0xf5ce44(0x13e)]();}else addLog(_0xf5ce44(0xde)+_0x4fdbde+_0xf5ce44(0xa9)+_0x5aa700);}function handleImageUpload(_0x2da6d1){const _0x9978a7=_0x43c175,_0x3266e2=_0x2da6d1[_0x9978a7(0x184)][_0x9978a7(0xfc)][0x0];if(!_0x3266e2)return;document[_0x9978a7(0xa2)]('fileInfo')[_0x9978a7(0x19d)]=_0x9978a7(0xfe)+_0x3266e2[_0x9978a7(0x1bb)]+'\x20('+formatFileSize(_0x3266e2[_0x9978a7(0xc9)])+')',document[_0x9978a7(0xa2)](_0x9978a7(0x144))[_0x9978a7(0x15c)][_0x9978a7(0x11c)]('hidden');const _0x4c673a=new FileReader();_0x4c673a[_0x9978a7(0x83)]=function(_0x453804){const _0x1a75e2=_0x9978a7,_0x39cd87=new Image();_0x39cd87[_0x1a75e2(0x83)]=function(){const _0x23c158=_0x1a75e2;originalImage=new Image(),originalImage['src']=_0x39cd87['src'],sourceImage=new Image(),sourceImage[_0x23c158(0xc2)]=_0x39cd87['src'],imageRotation=0x0,imageWidthInput[_0x23c158(0x1a9)]=_0x39cd87[_0x23c158(0x112)],imageHeightInput[_0x23c158(0x1a9)]=_0x39cd87[_0x23c158(0x1ae)],fitImageToCanvas(),centerImageOnCanvas(),saveOriginalCanvasState(),addLog(_0x23c158(0x1b7)+_0x3266e2[_0x23c158(0x1bb)]),addLog('图片原始尺寸:\x20'+_0x39cd87[_0x23c158(0x112)]+_0x23c158(0xa9)+_0x39cd87[_0x23c158(0x1ae)]),addLog(_0x23c158(0x15a)),updateCanvasVisibility();},_0x39cd87['src']=_0x453804['target'][_0x1a75e2(0x1a2)];},_0x4c673a['readAsDataURL'](_0x3266e2);}function saveOriginalCanvasState(){const _0xd3d6b0=_0x43c175,_0x3be9f7=getSelectedCanvasSize();originalCanvasData=ctx['getImageData'](0x0,0x0,_0x3be9f7[_0xd3d6b0(0x112)],_0x3be9f7[_0xd3d6b0(0x1ae)]);}function clearLog(){const _0x1ffaae=_0x43c175;logContainer['innerHTML']=_0x1ffaae(0xf9),addLog(_0x1ffaae(0xaf));}function preConnect(){const _0x20fb6c=_0x43c175;if(gattServer!=null&&gattServer[_0x20fb6c(0x93)])bleDevice!=null&&bleDevice['gatt'][_0x20fb6c(0x93)]&&(addLog(_0x20fb6c(0x10b)+(bleDevice[_0x20fb6c(0x1bb)]||_0x20fb6c(0x136))+_0x20fb6c(0x77)),bleDevice[_0x20fb6c(0x1ac)]['disconnect']());else{resetBluetoothVariables();try{navigator[_0x20fb6c(0xac)][_0x20fb6c(0x7f)]({'filters':[{'namePrefix':'NRF_'}],'optionalServices':[_0x20fb6c(0x17c)]})[_0x20fb6c(0x111)](_0x57e243=>{const _0x5f5585=_0x20fb6c;addLog(_0x5f5585(0x8f)+(_0x57e243[_0x5f5585(0x1bb)]||_0x5f5585(0x10f))),bleDevice=_0x57e243,bleDevice[_0x5f5585(0xe9)]('gattserverdisconnected',disconnect),setTimeout(()=>connect(),0x12c);})[_0x20fb6c(0xc8)](_0x125f11=>{const _0x300bff=_0x20fb6c;addLog(_0x300bff(0x18d)+_0x125f11['message']),_0x125f11['name']===_0x300bff(0x131)&&addLog(_0x300bff(0x1b6));});}catch(_0xb68f42){addLog(_0x20fb6c(0xf1)+_0xb68f42['message']),addLog('请检查蓝牙是否已开启并授予权限');}}}async function connect(){const _0x27156c=_0x43c175;if(!bleDevice){addLog('连接失败:\x20未选择蓝牙设备');return;}if(epdCharacteristic){addLog(_0x27156c(0xba));return;}try{addLog(_0x27156c(0x16b)+(bleDevice[_0x27156c(0x1bb)]||_0x27156c(0x10f))),gattServer=await bleDevice[_0x27156c(0x1ac)][_0x27156c(0x8c)](),epdService=await gattServer[_0x27156c(0x152)](_0x27156c(0x17c)),epdCharacteristic=await epdService['getCharacteristic'](_0x27156c(0xd0)),addLog(_0x27156c(0xc5)),await epdCharacteristic[_0x27156c(0xaa)](),epdCharacteristic[_0x27156c(0xe9)](_0x27156c(0x88),_0x3789d7=>{const _0x3a8e77=_0x27156c;handleNotify(_0x3789d7[_0x3a8e77(0x184)][_0x3a8e77(0x1a9)]);}),await write(0xa9),document[_0x27156c(0xa2)](_0x27156c(0xb3))[_0x27156c(0x1ba)]=_0x27156c(0x1b4),updateButtonStatus();}catch(_0x23f597){addLog(_0x27156c(0xec)+_0x23f597[_0x27156c(0x198)]),disconnect();}}function disconnect(){const _0x4f5de6=_0x43c175;bleDevice&&bleDevice['gatt'][_0x4f5de6(0x93)]&&bleDevice[_0x4f5de6(0x1ac)][_0x4f5de6(0x16d)](),resetBluetoothVariables(),addLog('已断开连接'),document[_0x4f5de6(0xa2)]('connectbutton')['innerHTML']=_0x4f5de6(0x124),updateButtonStatus();}function resetBluetoothVariables(){gattServer=null,epdService=null,epdCharacteristic=null,msgIndex=0x0;}async function write(_0x2ddb59,_0x2150c4,_0x418850=!![]){const _0x5b57e0=_0x43c175;if(!epdCharacteristic)return addLog(_0x5b57e0(0x95)),![];let _0x312b1f=[_0x2ddb59];if(_0x2150c4){if(typeof _0x2150c4=='string')_0x2150c4=hex2bytes(_0x2150c4);if(_0x2150c4 instanceof Uint8Array)_0x2150c4=Array[_0x5b57e0(0x12f)](_0x2150c4);_0x312b1f[_0x5b57e0(0xf3)](..._0x2150c4);}try{if(_0x418850)await epdCharacteristic[_0x5b57e0(0xb9)](Uint8Array[_0x5b57e0(0x12f)](_0x312b1f));else await epdCharacteristic[_0x5b57e0(0xd1)](Uint8Array[_0x5b57e0(0x12f)](_0x312b1f));}catch(_0x227f49){return addLog(_0x5b57e0(0xd7)+_0x227f49[_0x5b57e0(0x198)]),![];}return!![];}async function writeImage(_0x14e99b,_0x3084c8='bw'){const _0x107033=_0x43c175,_0x572723=document['getElementById'](_0x107033(0x103))[_0x107033(0x1a9)]-0x2,_0x170b6f=document['getElementById'](_0x107033(0x151))[_0x107033(0x1a9)],_0x1c6448=Math[_0x107033(0x188)](_0x14e99b[_0x107033(0xb7)]/_0x572723);let _0x133ddd=0x0,_0x3fabd=_0x170b6f;const _0x1e4991=getSelectedCanvasSize();for(let _0x13999=0x0;_0x13999<_0x14e99b[_0x107033(0xb7)];_0x13999+=_0x572723){let _0x53d46e=(new Date()[_0x107033(0xd5)]()-startTime)/0x3e8;addLog((_0x3084c8=='bw'?'黑白':'红色')+_0x107033(0xea)+(_0x133ddd+0x1)+'/'+_0x1c6448+',\x20用时:\x20'+_0x53d46e[_0x107033(0x163)](0x1)+'s');const _0x562f56=[(_0x3084c8=='bw'?0xf:0x0)|(_0x13999==0x0?0x0:0xf0),..._0x14e99b[_0x107033(0x159)](_0x13999,_0x13999+_0x572723)];_0x3fabd>0x0?(await write(0xa1,_0x562f56,![]),_0x3fabd--):(await write(0xa1,_0x562f56,!![]),_0x3fabd=_0x170b6f),_0x133ddd++;}}function downloadImageFile(){const _0x4b4d3d=_0x43c175;if(!checkCanvasHasContent(canvas)){addLog('请先上传或绘制图像并处理后再下载');return;}const _0x1f4683=getSelectedCanvasSize(),{width:_0x4b4d13,height:_0x1a0360}=getEffectiveCanvasSize(_0x1f4683),_0x3365cb=getRotatedImageData(canvas,_0x1f4683,imageRotation),_0x1f8abd=ditherMode[_0x4b4d3d(0x1a9)],_0x20defc=processImageData(_0x3365cb,_0x1f8abd,_0x4b4d13,_0x1a0360),_0xaa5ef2=_0x20defc[_0x4b4d3d(0xb7)],_0x15487e=(_0xaa5ef2/0x400)[_0x4b4d3d(0x163)](0x2),_0x5877a2=_0x4b4d13*_0x1a0360,_0x25106=_0x20defc['map'](_0xb826b2=>_0xb826b2[_0x4b4d3d(0xe2)](0x10)[_0x4b4d3d(0x143)](0x2,'0'))[_0x4b4d3d(0xc6)]('\x20'),_0xf5b794=new Blob([_0x25106],{'type':_0x4b4d3d(0xa1)}),_0x268dff=URL['createObjectURL'](_0xf5b794),_0x5a914c=document[_0x4b4d3d(0xb5)]('a');_0x5a914c[_0x4b4d3d(0x9b)]=_0x268dff,_0x5a914c[_0x4b4d3d(0x160)]=_0x4b4d3d(0x113)+new Date()[_0x4b4d3d(0xd5)]()+_0x4b4d3d(0x161),document[_0x4b4d3d(0x86)][_0x4b4d3d(0xd9)](_0x5a914c),_0x5a914c[_0x4b4d3d(0xe0)](),setTimeout(()=>{const _0x1453b8=_0x4b4d3d;document['body']['removeChild'](_0x5a914c),URL[_0x1453b8(0x1a6)](_0x268dff);},0x0),addLog('图像文本文件已下载\x20-\x20数据量:\x20'+_0xaa5ef2+_0x4b4d3d(0x147)+_0x15487e+_0x4b4d3d(0xa4)+_0x5877a2);}function showTimeDialog(){const _0x4575c4=_0x43c175;if(!epdCharacteristic){addLog(_0x4575c4(0x79));return;}const _0x48e5c5=new Date(),_0x2c3a02=new Date(_0x48e5c5[_0x4575c4(0xd5)]()-_0x48e5c5[_0x4575c4(0x102)]()*0xea60)[_0x4575c4(0x101)]()[_0x4575c4(0x159)](0x0,0x10);datetimeInput[_0x4575c4(0x1a9)]=_0x2c3a02,timeDialog[_0x4575c4(0x15c)][_0x4575c4(0x11c)](_0x4575c4(0x1a8));}function hideTimeDialog(){const _0xf28193=_0x43c175;timeDialog[_0xf28193(0x15c)][_0xf28193(0x16f)]('hidden');}async function setTime(){const _0x1118f2=_0x43c175;if(!epdCharacteristic){addLog(_0x1118f2(0x79)),hideTimeDialog();return;}const _0x415a4d=datetimeInput[_0x1118f2(0x1a9)];if(!_0x415a4d){addLog(_0x1118f2(0x1a1));return;}const _0x456837=new Date(_0x415a4d),_0x156689=Math[_0x1118f2(0xd8)](_0x456837[_0x1118f2(0xd5)]()/0x3e8),_0x42ce0e=[_0x156689>>0x18&0xff,_0x156689>>0x10&0xff,_0x156689>>0x8&0xff,_0x156689&0xff];try{setStatus(_0x1118f2(0x121)),statusContainer[_0x1118f2(0xef)][_0x1118f2(0x135)]='block',await write(0xa3,_0x42ce0e),addLog(_0x1118f2(0x8a)+_0x456837[_0x1118f2(0x85)]()),addLog(_0x1118f2(0xf0)+_0x156689+_0x1118f2(0xdb)+_0x156689[_0x1118f2(0xe2)](0x10)['toUpperCase']()+')'),setTimeout(()=>{const _0x11999e=_0x1118f2;statusContainer['style'][_0x11999e(0x135)]=_0x11999e(0x13a);},0x7d0);}catch(_0x27a858){addLog(_0x1118f2(0x7e)+_0x27a858[_0x1118f2(0x198)]);}finally{hideTimeDialog();}}async function setClockMode(){const _0x35d310=_0x43c175;if(!epdCharacteristic){addLog(_0x35d310(0x79));return;}try{setStatus(_0x35d310(0x1a7)),statusContainer[_0x35d310(0xef)][_0x35d310(0x135)]='block',await write(0xae,[0x1]),currentMode=_0x35d310(0x10c),addLog(_0x35d310(0x125)),setTimeout(()=>{const _0x555ffc=_0x35d310;statusContainer[_0x555ffc(0xef)]['display']=_0x555ffc(0x13a);},0x7d0);}catch(_0x5adacb){addLog(_0x35d310(0x1b5)+_0x5adacb['message']);}}async function setCalendarMode(){const _0x27e9a0=_0x43c175;if(!epdCharacteristic){addLog(_0x27e9a0(0x79));return;}try{setStatus('正在切换到日历模式...'),statusContainer[_0x27e9a0(0xef)]['display']=_0x27e9a0(0xe6),await write(0xae,[0x2]),currentMode=_0x27e9a0(0x12d),addLog(_0x27e9a0(0x196)),setTimeout(()=>{const _0xdc51c1=_0x27e9a0;statusContainer[_0xdc51c1(0xef)][_0xdc51c1(0x135)]='none';},0x7d0);}catch(_0x157ce5){addLog(_0x27e9a0(0x1b5)+_0x157ce5[_0x27e9a0(0x198)]);}}async function clear_screen(){const _0x5f5dda=_0x43c175;if(!epdCharacteristic){addLog(_0x5f5dda(0x79));return;}if(!confirm(_0x5f5dda(0x174)))return;try{setStatus(_0x5f5dda(0x114)),statusContainer[_0x5f5dda(0xef)]['display']=_0x5f5dda(0xe6),await write(0xa8),await write(0xa5),addLog(_0x5f5dda(0x172)),setTimeout(()=>{const _0xa924f5=_0x5f5dda;statusContainer[_0xa924f5(0xef)]['display']='none';},0x7d0);}catch(_0x494e8e){addLog(_0x5f5dda(0x7c)+_0x494e8e[_0x5f5dda(0x198)]);}}function getEffectiveCanvasSize(_0x500154){const _0x117830=_0x43c175;let _0x33f78c=_0x500154[_0x117830(0x112)],_0x1702b9=_0x500154[_0x117830(0x1ae)];return imageRotation%0xb4!==0x0&&([_0x33f78c,_0x1702b9]=[_0x1702b9,_0x33f78c]),{'width':_0x33f78c,'height':_0x1702b9};}function _0x4f1d(_0x5d14cb,_0x3dbcdf){const _0x202974=_0x2029();return _0x4f1d=function(_0x4f1df9,_0x4e6414){_0x4f1df9=_0x4f1df9-0x74;let _0x507740=_0x202974[_0x4f1df9];return _0x507740;},_0x4f1d(_0x5d14cb,_0x3dbcdf);}function getRotatedImageData(_0x194cb6,_0x27e6c3,_0x8a7108){const _0xe79319=_0x43c175,_0x44aaf9=document[_0xe79319(0xb5)](_0xe79319(0x1a0)),_0x514bc6=_0x44aaf9[_0xe79319(0x148)]('2d'),{width:_0x4d3aa3,height:_0x4079ce}=getEffectiveCanvasSize(_0x27e6c3);_0x44aaf9[_0xe79319(0x112)]=_0x4d3aa3,_0x44aaf9['height']=_0x4079ce,_0x514bc6[_0xe79319(0x171)]();if(_0x8a7108===0x5a)_0x514bc6[_0xe79319(0x18c)](_0x4d3aa3,0x0),_0x514bc6[_0xe79319(0x1b1)](Math['PI']/0x2);else{if(_0x8a7108===0xb4)_0x514bc6[_0xe79319(0x18c)](_0x4d3aa3,_0x4079ce),_0x514bc6[_0xe79319(0x1b1)](Math['PI']);else _0x8a7108===0x10e&&(_0x514bc6[_0xe79319(0x18c)](0x0,_0x4079ce),_0x514bc6[_0xe79319(0x1b1)](0x3*Math['PI']/0x2));}return _0x514bc6['drawImage'](_0x194cb6,0x0,0x0),_0x514bc6[_0xe79319(0x118)](),_0x514bc6[_0xe79319(0xad)](0x0,0x0,_0x4d3aa3,_0x4079ce);}function getDitherAlgorithmName(_0x1478bf){const _0x2d6d1a=_0x43c175,_0x4e56d0={'floydSteinberg':'Floyd-Steinberg','atkinson':_0x2d6d1a(0x175),'bayer':_0x2d6d1a(0xce),'stucki':'Stucki','jarvis':'Jarvis-Judice-Ninke'};return _0x4e56d0[_0x1478bf]||_0x1478bf;}function _0x2029(){const _0x4dd271=['closeTimeDialog','liangdu','发送完成！耗时:\x20','正在设置时间...','some','processedImageInfo','<i\x20class=\x22fa\x20fa-plug\x20mr-1\x22></i>连接','已切换到时钟模式','putImageData','mouseup','diffusion','抖动算法','\x20MB','color_led','<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画','calendar','请先上传图片','from','red','NotFoundError','图片已铺满画布','fontSize','已添加文字:\x20\x22','display','未知设备','canvasResizeHandle','contrastValue','lineWidth','none','cursor','floatingCanvasContainer','saturation','toDataURL','ditherAlg','算法...','input','fillRect','padStart','fileInfo','xianshi_peizhi','确定要清除画布内容吗？','\x20字节\x20(','getContext','#FFFFFF','已选择画笔颜色:\x20','wendu_color','已选择','jieqi_color','silian_ziti','请先输入要添加的文字','33057BQXxlv','interleavedcount','getPrimaryService','floatPreviewCanvas','217730NLATaS','D_S_hour','fourColor','epdpins','mouseout','slice','提示：按住Shift键拖动图片，或直接点击图片拖动','blackWhiteColor','classList','trim','11459JavJJW','keydown','download','.txt','status','toFixed','brushSize','19789650aIiwGH','touches','4965750hhdXlO','imageScale','querySelector','Shift','正在连接:\x20','bg-primary','disconnect','contrast','add','noImagePlaceholder','save','已清空墨水屏显示内容','getBoundingClientRect','确定要清空墨水屏显示内容吗？','Atkinson','mb-1\x20border-b\x20border-gray-100\x20pb-1\x20last:border-0\x20last:mb-0\x20last:pb-0','imageScaleValue','top','xuanzhuan','btnProcess','dither-strength','32120001-0bf6-448a-9608-1b01a1a8f75c','getAttribute','selectedIndex','487976bFMhTh','confirmTimeBtn','btnBlackWhiteRed','imageWidth','statusContainer','target','className','toolClear','touchstart','ceil','clientX','strokeStyle','jushua_time1','translate','蓝牙设备选择失败:\x20','text','N_Z_hour','fillText','floydSteinberg','substr','已退出绘画模式，图片可以移动','textBaseline','已进入绘画模式，图片已锁定无法移动','已切换到日历模式','\x20像素\x20(','message',']</span>\x20<span\x20class=\x22text-gray-800\x22>','key','<span\x20class=\x22text-gray-500\x22>[','opacity-50','textContent','round','toggleDrawingMode','canvas','请选择日期和时间','result','r_jushua_time','4.2_400_300','4IePGrI','revokeObjectURL','正在切换到时钟模式...','hidden','value','moshi_id','keyup','gatt','parentElement','height','set','datetimeInput','rotate','fontFamily','7.5_800_480','<i\x20class=\x22fa\x20fa-unplug\x20mr-1\x22></i>断开','切换模式失败:\x20','未找到NRF前缀的蓝牙设备，请确认设备已开启','已加载图片:\x20','image','disabled','innerHTML','name','sqrt','liang_add','createImageData','logContainer','\x20的连接...','addTextBtn','请先连接蓝牙设备！','已显示浮动画布','drawImage','清空屏幕失败:\x20','cursor-not-allowed','设置时间失败:\x20','requestDevice','font','touchmove','text-amber-300','onload','eraser','toLocaleString','body','div:first-child','characteristicvaluechanged','change','已设置时间:\x20','contains','connect','moveTo','drawingStatus','已选择设备:\x20','url(\x22data:image/svg+xml,%3Csvg\x20xmlns=\x27http://www.w3.org/2000/svg\x27\x20width=\x2724\x27\x20height=\x2724\x27\x20viewBox=\x270\x200\x2024\x2024\x27\x20fill=\x27none\x27\x20stroke=\x27black\x27\x20stroke-width=\x272\x27\x20stroke-linecap=\x27round\x27\x20stroke-linejoin=\x27round\x27%3E%3Cpath\x20d=\x27M18\x2013L5\x205\x27/%3E%3C/svg%3E\x22)\x200\x2024,\x20auto','canvasSize','stroke','connected','color_11','未连接蓝牙设备','log','\x20像素','preventDefault','innerHeight','touchcancel','href','欢迎使用墨水屏蓝牙图片工具！','bg-amber-500','<i\x20class=\x22fa\x20fa-arrows-alt\x20mr-1\x22></i>浮动画布','收到通知:','D_S_min','text/plain','getElementById','2.13_122_250','\x20KB)，像素:\x20','floatToggleDrawingMode','drawingModeIndicator','offsetWidth','<i\x20class=\x22fa\x20fa-compress\x20mr-1\x22></i>隐藏画布','\x20×\x20','startNotifications','lineJoin','bluetooth','getImageData','touchend','日志已清除','max','atkinson','btnClearLog','connectbutton','已清除画布内容','createElement','mousemove','length','toLocaleTimeString','writeValueWithResponse','已经连接到设备，无需重复连接','div','processImage1','fillStyle','已同步时间！','data','color_1','toolText','src','options','threeColor','已成功连接到设备！','join','pen','catch','size','黑白红','.italic','gongli_color','图片已适应画布大小','Bayer','clientY','32120002-0bf6-448a-9608-1b01a1a8f75c','writeValueWithoutResponse','\x20KB','textInput','776lnCHLX','getTime','diffusionValue','发送失败:\x20','floor','appendChild','time_color','\x20(0x','图片尺寸已调整为:\x20','firstChild','图像尺寸已设置为:\x20','已清空画布，保留设置和图片','click','pow','toString','toolPen','childNodes','qiangzhi_shuaxing','block','1012896gRRUSY','active','addEventListener','包:\x20','forEach','连接过程出错:\x20','customColor','beginPath','style','时间戳:\x20','蓝牙操作异常:\x20','D_S_start','push','fanxian','brightness','crosshair','data-color','removeChild','<div\x20class=\x22text-gray-500\x20italic\x22>操作日志将显示在这里...</div>','主机已同步时间！','px\x20','files','timeDialog','文件名:\x20','</span>','data-size','toISOString','getTimezoneOffset','mtusize','sixColor','min','请输入文字','imageHeight','<i\x20class=\x22fa\x20fa-stop\x20mr-1\x22></i>退出绘画','fanxian1','xuanzhuan1','正在断开与\x20','clock','color','请输入有效的尺寸（最小50x50像素）','NRF设备(未知名称)','liang_time','then','width','e-paper-image-','正在清空屏幕...','move','innerWidth','图片已旋转至\x20','restore','shichen_color','left','图片处理完成','remove','closeCanvas'];_0x2029=function(){return _0x4dd271;};return _0x2029();}function setDitherMode(_0x352d94){const _0x267bb2=_0x43c175;ditherMode[_0x267bb2(0x1a9)]=_0x352d94,addLog(_0x267bb2(0x14c)+(_0x352d94===_0x267bb2(0x15b)?'黑白':_0x267bb2(0xca))+'模式');}function onDitherAlgChange(_0x501374){const _0x4a1e65=_0x43c175;currentParams[_0x4a1e65(0x13f)]=_0x501374['target']['value'],addLog(_0x4a1e65(0x14c)+getDitherAlgorithmName(currentParams[_0x4a1e65(0x13f)])+_0x4a1e65(0x129));}function getSelectedCanvasSize(){const _0x80a78a=_0x43c175,_0x36acf5=document[_0x80a78a(0xa2)]('canvasSize')[_0x80a78a(0x1a9)];return canvasSizes['find'](_0x30ade7=>_0x30ade7['name']===_0x36acf5)||canvasSizes[0x1];}let originalImageData=null;function updateCanvasSize(_0x2cd4e7=![]){const _0x4520f7=_0x43c175,_0x403548=getSelectedCanvasSize(),_0x1255ed=checkCanvasHasContent(canvas);imageWidthInput[_0x4520f7(0x1a9)]=_0x403548[_0x4520f7(0x112)],imageHeightInput[_0x4520f7(0x1a9)]=_0x403548[_0x4520f7(0x1ae)],canvas[_0x4520f7(0x112)]=_0x403548[_0x4520f7(0x112)],canvas[_0x4520f7(0x1ae)]=_0x403548['height'],floatCanvas[_0x4520f7(0x112)]=_0x403548[_0x4520f7(0x112)],floatCanvas[_0x4520f7(0x1ae)]=_0x403548['height'],_0x2cd4e7&&_0x1255ed?originalCanvasData&&ctx[_0x4520f7(0x126)](originalCanvasData,0x0,0x0):(ctx[_0x4520f7(0xbd)]='#FFFFFF',ctx['fillRect'](0x0,0x0,_0x403548['width'],_0x403548['height'])),syncCanvases(),processedImageInfo[_0x4520f7(0x19d)]=_0x403548[_0x4520f7(0x112)]+_0x4520f7(0xa9)+_0x403548[_0x4520f7(0x1ae)]+_0x4520f7(0x97),updateCanvasVisibility();}function updateDitcherOptions(){const _0x37cf89=_0x43c175,_0x11ff7c=document['getElementById']('epddriver'),_0x10be33=_0x11ff7c[_0x37cf89(0xc3)][_0x11ff7c['selectedIndex']],_0x10e16e=_0x10be33[_0x37cf89(0x17d)](_0x37cf89(0xf7)),_0x23f97b=_0x10be33[_0x37cf89(0x17d)](_0x37cf89(0x100));if(_0x10e16e)ditherMode[_0x37cf89(0x1a9)]=_0x10e16e;if(_0x23f97b){const _0x25c848=canvasSizes[_0x37cf89(0x122)](_0x1aa5cc=>_0x1aa5cc[_0x37cf89(0x1bb)]===_0x23f97b);_0x25c848&&(document[_0x37cf89(0xa2)](_0x37cf89(0x91))[_0x37cf89(0x1a9)]=_0x23f97b);}updateCanvasSize(!![]);}function processImage(){const _0x5259f5=_0x43c175;saveOriginalCanvasState(),addLog('开始处理图片，使用'+getDitherAlgorithmName(currentParams[_0x5259f5(0x13f)])+_0x5259f5(0x140));const _0x57615e=getSelectedCanvasSize();let _0x18ddd3=ctx[_0x5259f5(0xad)](0x0,0x0,_0x57615e[_0x5259f5(0x112)],_0x57615e[_0x5259f5(0x1ae)]);_0x18ddd3=adjustImageParameters(_0x18ddd3,currentParams);const _0x588ba2=ditherMode[_0x5259f5(0x1a9)];let _0x211186;const _0x3be5df=window[_0x5259f5(0xbc)](_0x18ddd3,document['getElementById']('brightness')['value'],document[_0x5259f5(0xa2)](_0x5259f5(0x16e))[_0x5259f5(0x1a9)],document[_0x5259f5(0xa2)](_0x5259f5(0x13d))[_0x5259f5(0x1a9)],document[_0x5259f5(0xa2)](_0x5259f5(0x128))[_0x5259f5(0x1a9)]/0xa,_0x588ba2,document[_0x5259f5(0xa2)](_0x5259f5(0x13f))['value']);ctx[_0x5259f5(0x126)](_0x3be5df,0x0,0x0),syncCanvases(),processedImageInfo['textContent']=_0x57615e['width']+_0x5259f5(0xa9)+_0x57615e[_0x5259f5(0x1ae)]+_0x5259f5(0x197)+(_0x588ba2===_0x5259f5(0x15b)?'黑白':_0x5259f5(0xca))+')',addLog(_0x5259f5(0x11b)),updateCanvasVisibility();}async function sendimg(){const _0x471e42=_0x43c175,_0x4075cf=document[_0x471e42(0xa2)](_0x471e42(0x91))[_0x471e42(0x1a9)],_0x155456=document['getElementById']('ditherMode')['value'],_0x290d8a=document[_0x471e42(0xa2)]('epddriver'),_0x544f46=_0x290d8a[_0x471e42(0xc3)][_0x290d8a[_0x471e42(0x17e)]];startTime=new Date()[_0x471e42(0xd5)]();const _0x42bbe5=document['getElementById'](_0x471e42(0x162));_0x42bbe5[_0x471e42(0x1ad)][_0x471e42(0xef)][_0x471e42(0x135)]='block';const _0x40f861=ctx[_0x471e42(0xad)](0x0,0x0,canvas[_0x471e42(0x112)],canvas['height']),_0x592ebf=processImageData(_0x40f861,_0x155456);updateButtonStatus(!![]);if(_0x155456===_0x471e42(0x156))await writeImage(_0x592ebf,_0x471e42(0x10d));else{if(_0x155456===_0x471e42(0xc4)){const _0x1c04b3=Math[_0x471e42(0xd8)](_0x592ebf['length']/0x2);await writeImage(_0x592ebf[_0x471e42(0x159)](0x0,_0x1c04b3),'bw'),await writeImage(_0x592ebf[_0x471e42(0x159)](_0x1c04b3),_0x471e42(0x130));}else{if(_0x155456==='blackWhiteColor')await writeImage(_0x592ebf,'bw');else{updateButtonStatus();return;}}}await write(0xa8),updateButtonStatus();const _0x325594=(new Date()[_0x471e42(0xd5)]()-startTime)/0x3e8;addLog(_0x471e42(0x120)+_0x325594+'s'),setTimeout(()=>{const _0x3dcb11=_0x471e42;_0x42bbe5[_0x3dcb11(0x1ad)][_0x3dcb11(0xef)][_0x3dcb11(0x135)]=_0x3dcb11(0x13a);},0x1388);}function adjustImageParameters(_0xf48211,_0x1a0a89){const _0x558b92=_0x43c175,_0x391a1a=_0xf48211[_0x558b92(0xbf)],_0x50a249=_0x1a0a89[_0x558b92(0x13d)]/0x64,_0x490edf=_0x1a0a89[_0x558b92(0xf5)]/0x64,_0xf75c06=_0x1a0a89['contrast']/0x64,_0x172d58=_0x1a0a89[_0x558b92(0x128)]/0x64,_0x13f584=_0xf75c06!==0x0?0x103*(_0xf75c06+0xff)/(0xff*(0x103-_0xf75c06)):0x1,_0x2b4e8c=new Uint8ClampedArray(_0x391a1a);for(let _0x310fc8=0x0;_0x310fc8<_0x391a1a[_0x558b92(0xb7)];_0x310fc8+=0x4){let _0x33a13f=Math['min'](0xff,Math['max'](0x0,_0x2b4e8c[_0x310fc8]*_0x490edf)),_0x520492=Math[_0x558b92(0x105)](0xff,Math[_0x558b92(0xb0)](0x0,_0x2b4e8c[_0x310fc8+0x1]*_0x490edf)),_0x4dfc48=Math[_0x558b92(0x105)](0xff,Math[_0x558b92(0xb0)](0x0,_0x2b4e8c[_0x310fc8+0x2]*_0x490edf));_0x33a13f=Math[_0x558b92(0x105)](0xff,Math['max'](0x0,_0x13f584*(_0x33a13f-0x80)+0x80)),_0x520492=Math[_0x558b92(0x105)](0xff,Math[_0x558b92(0xb0)](0x0,_0x13f584*(_0x520492-0x80)+0x80)),_0x4dfc48=Math['min'](0xff,Math[_0x558b92(0xb0)](0x0,_0x13f584*(_0x4dfc48-0x80)+0x80));const _0x26029a=0.299*_0x33a13f+0.587*_0x520492+0.114*_0x4dfc48;_0x33a13f=Math[_0x558b92(0x105)](0xff,Math[_0x558b92(0xb0)](0x0,_0x26029a+_0x50a249*(_0x33a13f-_0x26029a))),_0x520492=Math['min'](0xff,Math['max'](0x0,_0x26029a+_0x50a249*(_0x520492-_0x26029a))),_0x4dfc48=Math[_0x558b92(0x105)](0xff,Math[_0x558b92(0xb0)](0x0,_0x26029a+_0x50a249*(_0x4dfc48-_0x26029a)));if(_0x172d58>0x0){const _0x56a21a=_0xf48211[_0x558b92(0x112)],_0x33044f=_0x310fc8/0x4%_0x56a21a,_0x2ec6dd=Math[_0x558b92(0xd8)](_0x310fc8/0x4/_0x56a21a);if(_0x33044f>0x0&&_0x2ec6dd>0x0){const _0x2ab7eb=_0x310fc8-0x4*(_0x56a21a+0x1);_0x33a13f=Math[_0x558b92(0xd8)](_0x33a13f*(0x1-_0x172d58)+_0x2b4e8c[_0x2ab7eb]*_0x172d58),_0x520492=Math['floor'](_0x520492*(0x1-_0x172d58)+_0x2b4e8c[_0x2ab7eb+0x1]*_0x172d58),_0x4dfc48=Math[_0x558b92(0xd8)](_0x4dfc48*(0x1-_0x172d58)+_0x2b4e8c[_0x2ab7eb+0x2]*_0x172d58);}}_0x391a1a[_0x310fc8]=_0x33a13f,_0x391a1a[_0x310fc8+0x1]=_0x520492,_0x391a1a[_0x310fc8+0x2]=_0x4dfc48;}return _0xf48211;}function convertToBlackWhite(_0x2b00eb,_0x338acd){const _0x2837f7=_0x43c175,_0xdf582=_0x2b00eb['width'],_0x5a418f=_0x2b00eb[_0x2837f7(0x1ae)],_0xd03c67=ctx[_0x2837f7(0x75)](_0xdf582,_0x5a418f);return _0xd03c67[_0x2837f7(0xbf)][_0x2837f7(0x1af)](_0x2b00eb[_0x2837f7(0xbf)]),applyDitheringAlgorithm(_0xd03c67,0x80,_0x338acd),{'imageData':_0xd03c67};}function convertToBlackWhiteRed(_0x5ceb2c,_0x118463){const _0xf16d77=_0x43c175,_0x144e47=_0x5ceb2c['width'],_0x1748ac=_0x5ceb2c[_0xf16d77(0x1ae)],_0x2d38ae=ctx[_0xf16d77(0x75)](_0x144e47,_0x1748ac);_0x2d38ae[_0xf16d77(0xbf)][_0xf16d77(0x1af)](_0x5ceb2c[_0xf16d77(0xbf)]);const _0xed5c8c=_0x2d38ae['data'];for(let _0x5a30ba=0x0;_0x5a30ba<_0xed5c8c['length'];_0x5a30ba+=0x4){const _0x1289e9=_0xed5c8c[_0x5a30ba],_0x2bed1d=_0xed5c8c[_0x5a30ba+0x1],_0x29476c=_0xed5c8c[_0x5a30ba+0x2];if(_0x1289e9>0xb4&&_0x2bed1d<_0x1289e9*0.6&&_0x29476c<_0x1289e9*0.6)_0xed5c8c[_0x5a30ba+0x3]=0x1;else{const _0x1c17b3=0.299*_0x1289e9+0.587*_0x2bed1d+0.114*_0x29476c;_0xed5c8c[_0x5a30ba]=_0x1c17b3,_0xed5c8c[_0x5a30ba+0x1]=_0x1c17b3,_0xed5c8c[_0x5a30ba+0x2]=_0x1c17b3,_0xed5c8c[_0x5a30ba+0x3]=0x0;}}applyDitheringAlgorithm(_0x2d38ae,0x64,_0x118463,!![]);for(let _0x366480=0x0;_0x366480<_0xed5c8c[_0xf16d77(0xb7)];_0x366480+=0x4){if(_0xed5c8c[_0x366480+0x3]===0x1)_0xed5c8c[_0x366480]=0xff,_0xed5c8c[_0x366480+0x1]=0x0,_0xed5c8c[_0x366480+0x2]=0x0;else{const _0x3f2d64=_0xed5c8c[_0x366480]>0x64?0xff:0x0;_0xed5c8c[_0x366480]=_0xed5c8c[_0x366480+0x1]=_0xed5c8c[_0x366480+0x2]=_0x3f2d64;}_0xed5c8c[_0x366480+0x3]=0xff;}return{'imageData':_0x2d38ae};}function applyDitheringAlgorithm(_0x38c510,_0xb6eca1,_0x1b4a83,_0x32cc38=![]){const _0x40c29a=_0x43c175,_0x1098df=_0x38c510[_0x40c29a(0xbf)],_0x1c5971=_0x38c510[_0x40c29a(0x112)],_0x5b2db0=_0x38c510[_0x40c29a(0x1ae)],_0x21b5f6=_0x1b4a83[_0x40c29a(0x13f)],_0x42dc2e=_0x1b4a83[_0x40c29a(0x128)]/0x64,_0x14004e=new Uint8ClampedArray(_0x1098df);for(let _0x16ca69=0x0;_0x16ca69<_0x5b2db0;_0x16ca69++){for(let _0x463ad7=0x0;_0x463ad7<_0x1c5971;_0x463ad7++){const _0x245df8=(_0x16ca69*_0x1c5971+_0x463ad7)*0x4;if(_0x32cc38&&_0x14004e[_0x245df8+0x3]===0x1)continue;const _0x4fbc9f=_0x14004e[_0x245df8],_0x1de9f0=_0x4fbc9f<_0xb6eca1?0x0:0xff,_0x33f1f9=_0x4fbc9f-_0x1de9f0,_0x2fc46d=0x1+_0x42dc2e;switch(_0x21b5f6){case _0x40c29a(0x191):propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x7/0x10,0x1,0x0),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x3/0x10,-0x1,0x1),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x5/0x10,0x0,0x1),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x10,0x1,0x1);break;case _0x40c29a(0xb1):propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x8,0x1,0x0),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x8,0x2,0x0),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x8,-0x1,0x1),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x8,0x0,0x1),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x8,0x1,0x1),propagateError(_0x14004e,_0x463ad7,_0x16ca69,_0x1c5971,_0x5b2db0,_0x33f1f9*_0x2fc46d,0x1/0x8,0x0,0x2);break;default:break;}_0x1098df[_0x245df8]=_0x1de9f0,_0x1098df[_0x245df8+0x1]=_0x1de9f0,_0x1098df[_0x245df8+0x2]=_0x1de9f0;}}}function propagateError(_0x73c01e,_0x63609,_0x60b915,_0x53c4bb,_0x4f3f7b,_0x49cb9e,_0x588aa1,_0x5d5c37,_0x1a7c46){const _0x4ba3be=_0x43c175,_0x2b324a=_0x63609+_0x5d5c37,_0x3c7482=_0x60b915+_0x1a7c46;if(_0x2b324a>=0x0&&_0x2b324a<_0x53c4bb&&_0x3c7482>=0x0&&_0x3c7482<_0x4f3f7b){const _0x101e45=(_0x3c7482*_0x53c4bb+_0x2b324a)*0x4;_0x73c01e[_0x101e45]=Math[_0x4ba3be(0xb0)](0x0,Math[_0x4ba3be(0x105)](0xff,_0x73c01e[_0x101e45]+_0x49cb9e*_0x588aa1));}}function processImageData(_0xfc55cb,_0x418330){const _0x1f863e=_0x43c175,_0x41848c=_0xfc55cb[_0x1f863e(0x112)],_0x8f3e=_0xfc55cb[_0x1f863e(0x1ae)],_0x1743a2=_0xfc55cb[_0x1f863e(0xbf)];let _0x360f1e;if(_0x418330===_0x1f863e(0x104)){_0x360f1e=new Uint8Array(_0x41848c*_0x8f3e);for(let _0x7c21bd=0x0;_0x7c21bd<_0x8f3e;_0x7c21bd++){for(let _0x4c2f65=0x0;_0x4c2f65<_0x41848c;_0x4c2f65++){const _0x5d2c86=(_0x7c21bd*_0x41848c+_0x4c2f65)*0x4,_0x5c46f1=_0x1743a2[_0x5d2c86],_0x2ddb25=_0x1743a2[_0x5d2c86+0x1],_0x204fcd=_0x1743a2[_0x5d2c86+0x2],_0x1e7eab=findClosestColor(_0x5c46f1,_0x2ddb25,_0x204fcd,_0x418330),_0xf87315=_0x4c2f65*_0x8f3e+(_0x8f3e-0x1-_0x7c21bd);_0x360f1e[_0xf87315]=_0x1e7eab[_0x1f863e(0x1a9)];}}}else{if(_0x418330===_0x1f863e(0x156)){_0x360f1e=new Uint8Array(Math[_0x1f863e(0x188)](_0x41848c*_0x8f3e/0x4));for(let _0x40e64c=0x0;_0x40e64c<_0x8f3e;_0x40e64c++){for(let _0x40a88c=0x0;_0x40a88c<_0x41848c;_0x40a88c++){const _0xf5e29b=(_0x40e64c*_0x41848c+_0x40a88c)*0x4,_0x15d3eb=_0x1743a2[_0xf5e29b],_0x7a83c=_0x1743a2[_0xf5e29b+0x1],_0x41d953=_0x1743a2[_0xf5e29b+0x2],_0x2c5ea1=findClosestColor(_0x15d3eb,_0x7a83c,_0x41d953,_0x418330),_0x58fded=_0x2c5ea1['value'],_0x179e48=(_0x40e64c*_0x41848c+_0x40a88c)/0x4|0x0,_0x11b487=0x6-_0x40a88c%0x4*0x2;_0x360f1e[_0x179e48]|=_0x58fded<<_0x11b487;}}}else{if(_0x418330==='blackWhiteColor'){const _0x300a6d=Math[_0x1f863e(0x188)](_0x41848c/0x8);_0x360f1e=new Uint8Array(_0x300a6d*_0x8f3e);const _0x29d029=0x8c;for(let _0x498af=0x0;_0x498af<_0x8f3e;_0x498af++){for(let _0x40b639=0x0;_0x40b639<_0x41848c;_0x40b639++){const _0x9801fb=(_0x498af*_0x41848c+_0x40b639)*0x4,_0x299308=_0x1743a2[_0x9801fb],_0x31e434=_0x1743a2[_0x9801fb+0x1],_0xd795a2=_0x1743a2[_0x9801fb+0x2],_0x5cb77e=Math[_0x1f863e(0x19e)](0.299*_0x299308+0.587*_0x31e434+0.114*_0xd795a2),_0x24d382=_0x5cb77e>=_0x29d029?0x1:0x0,_0x1a2c64=_0x498af*_0x300a6d+Math[_0x1f863e(0xd8)](_0x40b639/0x8),_0x18e928=0x7-_0x40b639%0x8;_0x360f1e[_0x1a2c64]|=_0x24d382<<_0x18e928;}}}else{if(_0x418330===_0x1f863e(0xc4)){const _0x4d7d60=Math[_0x1f863e(0x188)](_0x41848c/0x8),_0x1bb277=0x8c,_0x1d542e=0xa0,_0x146116=new Uint8Array(_0x8f3e*_0x4d7d60),_0x20742d=new Uint8Array(_0x8f3e*_0x4d7d60);for(let _0x25da15=0x0;_0x25da15<_0x8f3e;_0x25da15++){for(let _0x5034fc=0x0;_0x5034fc<_0x41848c;_0x5034fc++){const _0x43a7d7=(_0x25da15*_0x41848c+_0x5034fc)*0x4,_0x5b5203=_0x1743a2[_0x43a7d7],_0x34ef0f=_0x1743a2[_0x43a7d7+0x1],_0x510be0=_0x1743a2[_0x43a7d7+0x2],_0x15d215=Math['round'](0.299*_0x5b5203+0.587*_0x34ef0f+0.114*_0x510be0),_0x1760e9=_0x15d215>=_0x1bb277?0x1:0x0,_0x5f4822=_0x25da15*_0x4d7d60+Math[_0x1f863e(0xd8)](_0x5034fc/0x8),_0x3ecdba=0x7-_0x5034fc%0x8;_0x1760e9?_0x146116[_0x5f4822]|=0x1<<_0x3ecdba:_0x146116[_0x5f4822]&=~(0x1<<_0x3ecdba);const _0x49f470=_0x5b5203>_0x1d542e&&_0x5b5203>_0x34ef0f&&_0x5b5203>_0x510be0?0x0:0x1,_0x1ce0c3=_0x25da15*_0x4d7d60+Math[_0x1f863e(0xd8)](_0x5034fc/0x8),_0x362dc3=0x7-_0x5034fc%0x8;_0x49f470?_0x20742d[_0x1ce0c3]|=0x1<<_0x362dc3:_0x20742d[_0x1ce0c3]&=~(0x1<<_0x362dc3);}}_0x360f1e=new Uint8Array(_0x146116[_0x1f863e(0xb7)]+_0x20742d['length']),_0x360f1e[_0x1f863e(0x1af)](_0x146116,0x0),_0x360f1e[_0x1f863e(0x1af)](_0x20742d,_0x146116['length']);}}}}return _0x360f1e;}function toggleCanvas(){const _0x2a6597=_0x43c175;floatingCanvasContainer[_0x2a6597(0x15c)][_0x2a6597(0x8b)](_0x2a6597(0x1a8))?(floatingCanvasContainer[_0x2a6597(0x15c)][_0x2a6597(0x11c)](_0x2a6597(0x1a8)),toggleCanvasFloat[_0x2a6597(0x1ba)]=_0x2a6597(0xa8),addLog(_0x2a6597(0x7a))):hideCanvas();}function hideCanvas(){const _0x3f1d3c=_0x43c175;floatingCanvasContainer[_0x3f1d3c(0x15c)][_0x3f1d3c(0x16f)]('hidden'),toggleCanvasFloat[_0x3f1d3c(0x1ba)]=_0x3f1d3c(0x9e),addLog('已隐藏浮动画布');}function updateCanvasVisibility(){const _0x23a8e1=_0x43c175,_0x42e139=checkCanvasHasContent(canvas);_0x42e139?(noImagePlaceholder[_0x23a8e1(0x15c)][_0x23a8e1(0x16f)](_0x23a8e1(0x1a8)),canvas[_0x23a8e1(0x15c)][_0x23a8e1(0x11c)](_0x23a8e1(0x1a8)),floatPreviewCanvas['classList'][_0x23a8e1(0x11c)](_0x23a8e1(0x1a8))):(noImagePlaceholder[_0x23a8e1(0x15c)][_0x23a8e1(0x11c)](_0x23a8e1(0x1a8)),canvas[_0x23a8e1(0x15c)][_0x23a8e1(0x16f)](_0x23a8e1(0x1a8)),floatPreviewCanvas[_0x23a8e1(0x15c)]['add'](_0x23a8e1(0x1a8)));}function checkCanvasHasContent(_0x1683b8){const _0x126eed=_0x43c175,_0x10f9e0=_0x1683b8['getContext']('2d'),_0x3b6e6a=_0x10f9e0[_0x126eed(0xad)](0x0,0x0,_0x1683b8[_0x126eed(0x112)],_0x1683b8['height']),_0x4bde16=_0x3b6e6a[_0x126eed(0xbf)];for(let _0x1c535a=0x0;_0x1c535a<_0x4bde16[_0x126eed(0xb7)];_0x1c535a+=0x4){if(_0x4bde16[_0x1c535a]!==0xff||_0x4bde16[_0x1c535a+0x1]!==0xff||_0x4bde16[_0x1c535a+0x2]!==0xff)return!![];}return![];}function startDrag(_0x422b0d){const _0x54a96a=_0x43c175;isDragging=!![];const _0x499d2a=floatingCanvasContainer['getBoundingClientRect']();dragOffset['x']=_0x422b0d[_0x54a96a(0x189)]-_0x499d2a[_0x54a96a(0x11a)],dragOffset['y']=_0x422b0d[_0x54a96a(0xcf)]-_0x499d2a[_0x54a96a(0x178)];}function drag(_0x350207){const _0x466eb2=_0x43c175;if(!isDragging)return;_0x350207[_0x466eb2(0x98)]();const _0x490a07=_0x350207[_0x466eb2(0x189)]-dragOffset['x'],_0x5a8152=_0x350207[_0x466eb2(0xcf)]-dragOffset['y'],_0x4e55b1=window[_0x466eb2(0x116)],_0x54081d=window[_0x466eb2(0x99)],_0x526e02=floatingCanvasContainer[_0x466eb2(0xa7)],_0x4e0a3b=floatingCanvasContainer['offsetHeight'],_0x5487f4=Math[_0x466eb2(0xb0)](0x0,Math[_0x466eb2(0x105)](_0x490a07,_0x4e55b1-_0x526e02)),_0x4c2ff6=Math['max'](0x0,Math['min'](_0x5a8152,_0x54081d-_0x4e0a3b));floatingCanvasContainer[_0x466eb2(0xef)]['left']=_0x5487f4+'px',floatingCanvasContainer[_0x466eb2(0xef)][_0x466eb2(0x178)]=_0x4c2ff6+'px';}function stopDrag(){isDragging=![];}function startResize(_0x162302){const _0x143d9e=_0x43c175;isResizing=!![],_0x162302[_0x143d9e(0x98)]();}function resize(_0x1105e7){const _0x4cb3e5=_0x43c175;if(!isResizing)return;_0x1105e7[_0x4cb3e5(0x98)]();const _0x4a3b15=floatingCanvasContainer[_0x4cb3e5(0x173)](),_0x5d08b5=_0x1105e7[_0x4cb3e5(0x189)]-_0x4a3b15[_0x4cb3e5(0x11a)],_0x3ba40a=_0x1105e7[_0x4cb3e5(0xcf)]-_0x4a3b15[_0x4cb3e5(0x178)];_0x5d08b5>0xc8&&_0x3ba40a>0x96&&(floatingCanvasContainer['style'][_0x4cb3e5(0x112)]=_0x5d08b5+'px',floatingCanvasContainer['style'][_0x4cb3e5(0x1ae)]=_0x3ba40a+'px');}function stopResize(){isResizing=![];}function resetProcessing(){const _0x35755e=_0x43c175;if(0x1){ctx['putImageData'](originalCanvasData,0x0,0x0),syncCanvases();const _0x453d22=getSelectedCanvasSize();processedImageInfo[_0x35755e(0x19d)]=_0x453d22[_0x35755e(0x112)]+'\x20×\x20'+_0x453d22[_0x35755e(0x1ae)]+_0x35755e(0x97),addLog('已重置处理效果，保留原始图片和设置');}else ctx[_0x35755e(0xbd)]=_0x35755e(0x149),ctx['fillRect'](0x0,0x0,canvas[_0x35755e(0x112)],canvas[_0x35755e(0x1ae)]),syncCanvases(),addLog(_0x35755e(0xdf));}function addLog(_0x5666b1){const _0x14b9b5=_0x43c175,_0x4c9004=new Date()[_0x14b9b5(0xb8)](),_0xc7dbc6=document['createElement'](_0x14b9b5(0xbb));_0xc7dbc6[_0x14b9b5(0x185)]=_0x14b9b5(0x176),_0xc7dbc6[_0x14b9b5(0x1ba)]=_0x14b9b5(0x19b)+_0x4c9004+_0x14b9b5(0x199)+_0x5666b1+_0x14b9b5(0xff);logContainer['querySelector'](_0x14b9b5(0xcb))&&(logContainer[_0x14b9b5(0x1ba)]='');logContainer['appendChild'](_0xc7dbc6),logContainer['scrollTop']=logContainer['scrollHeight'];while(logContainer[_0x14b9b5(0xe4)][_0x14b9b5(0xb7)]>0x1e){logContainer[_0x14b9b5(0xf8)](logContainer[_0x14b9b5(0xdd)]);}}function setStatus(_0x3d7901){const _0x3ddc8c=_0x43c175;document[_0x3ddc8c(0xa2)](_0x3ddc8c(0x162))[_0x3ddc8c(0x19d)]=_0x3d7901;}function updateButtonStatus(_0x1450c9=![]){const _0x21041c=_0x43c175,_0x1eedee=gattServer!=null&&gattServer[_0x21041c(0x93)],_0x19fd5e=_0x1450c9||!_0x1eedee;btnSend[_0x21041c(0x1b9)]=_0x19fd5e,btnSetTime[_0x21041c(0x1b9)]=_0x19fd5e,_0x19fd5e?(btnSend[_0x21041c(0x15c)][_0x21041c(0x16f)]('opacity-50',_0x21041c(0x7d)),btnSetTime[_0x21041c(0x15c)][_0x21041c(0x16f)]('opacity-50',_0x21041c(0x7d))):(btnSend[_0x21041c(0x15c)][_0x21041c(0x11c)](_0x21041c(0x19c),_0x21041c(0x7d)),btnSetTime[_0x21041c(0x15c)][_0x21041c(0x11c)]('opacity-50',_0x21041c(0x7d)));}function reConnect(){addLog('尝试重新连接设备...'),preConnect();}function handleNotify(_0x240e74){const _0x10a6dc=_0x43c175;console[_0x10a6dc(0x96)](_0x10a6dc(0x9f),_0x240e74);}function hex2bytes(_0x1da4d6){const _0x267ded=_0x43c175,_0x1ce6fb=[];for(let _0x2339a5=0x0;_0x2339a5<_0x1da4d6[_0x267ded(0xb7)];_0x2339a5+=0x2){_0x1ce6fb[_0x267ded(0xf3)](parseInt(_0x1da4d6[_0x267ded(0x192)](_0x2339a5,0x2),0x10));}return _0x1ce6fb;}function formatFileSize(_0x3f6618){const _0x52357a=_0x43c175;if(_0x3f6618<0x400)return _0x3f6618+'\x20B';else{if(_0x3f6618<0x100000)return(_0x3f6618/0x400)[_0x52357a(0x163)](0x2)+_0x52357a(0xd2);else return(_0x3f6618/0x100000)[_0x52357a(0x163)](0x2)+_0x52357a(0x12a);}}async function set_EPD_CMD_J_H(){const _0x1286c1=_0x43c175;await write(0xff,document[_0x1286c1(0xa2)](_0x1286c1(0x157))[_0x1286c1(0x1a9)]);}async function set_EPD_CMD_N_Z(){const _0x595713=_0x43c175,_0x2f8299=document[_0x595713(0xa2)](_0x595713(0x18f))[_0x595713(0x1a9)],_0x18be97=document['getElementById']('N_Z_min')[_0x595713(0x1a9)],_0xe6fc42=document[_0x595713(0xa2)]('N_Z_start')['value'],_0x26b1f9=[0x4];_0x26b1f9[0x0]=0x0,_0x26b1f9[0x1]=0x0,_0x26b1f9[0x2]=_0x2f8299,_0x26b1f9[0x3]=_0x18be97,_0x26b1f9[0x4]=_0xe6fc42,await write(0xef,_0x26b1f9);}async function set_EPD_CMD_D_S(){const _0x5ea2a3=_0x43c175,_0x3b1545=document[_0x5ea2a3(0xa2)](_0x5ea2a3(0x155))[_0x5ea2a3(0x1a9)],_0x5a0065=document[_0x5ea2a3(0xa2)](_0x5ea2a3(0xa0))[_0x5ea2a3(0x1a9)],_0x385c85=document[_0x5ea2a3(0xa2)](_0x5ea2a3(0xf2))[_0x5ea2a3(0x1a9)],_0x4d8c2d=[0x4];_0x4d8c2d[0x0]=0x0,_0x4d8c2d[0x1]=0x0,_0x4d8c2d[0x2]=_0x3b1545,_0x4d8c2d[0x3]=_0x5a0065,_0x4d8c2d[0x4]=_0x385c85,await write(0xed,_0x4d8c2d);}async function set_EPD_CMD_J_S(){const _0x1259d6=_0x43c175,_0x331a06=document[_0x1259d6(0xa2)]('J_S_hour')[_0x1259d6(0x1a9)],_0x1f88ef=document['getElementById']('J_S_min')[_0x1259d6(0x1a9)],_0x8206e4=document[_0x1259d6(0xa2)]('J_S_start')[_0x1259d6(0x1a9)],_0x1b9cdb=[0x4];_0x1b9cdb[0x0]=0x0,_0x1b9cdb[0x1]=0x0,_0x1b9cdb[0x2]=_0x331a06,_0x1b9cdb[0x3]=_0x1f88ef,_0x1b9cdb[0x4]=_0x8206e4,await write(0xee,_0x1b9cdb);}async function set_EPD_CMD_LED(){const _0x4b1ad0=_0x43c175,_0x3a032a=document[_0x4b1ad0(0xa2)](_0x4b1ad0(0x12b))[_0x4b1ad0(0x1a9)],_0x25963c=document[_0x4b1ad0(0xa2)](_0x4b1ad0(0x110))[_0x4b1ad0(0x1a9)],_0x21a782=document[_0x4b1ad0(0xa2)](_0x4b1ad0(0x74))[_0x4b1ad0(0x1a9)],_0x14fa0e=document['getElementById'](_0x4b1ad0(0x11f))[_0x4b1ad0(0x1a9)],_0x196430=document[_0x4b1ad0(0xa2)]('liang_s')[_0x4b1ad0(0x1a9)],_0x4462df=[0x5];_0x4462df[0x0]=_0x3a032a,_0x4462df[0x1]=_0x25963c,_0x4462df[0x2]=_0x21a782,_0x4462df[0x3]=_0x14fa0e,_0x4462df[0x4]=_0x196430,await write(0xec,_0x4462df);}async function set_EPD_CMD_LED1(){const _0x4f7b38=_0x43c175,_0x3d2def=document['getElementById'](_0x4f7b38(0x12b))['value'],_0x961eba=document['getElementById'](_0x4f7b38(0x110))[_0x4f7b38(0x1a9)],_0x2b317d=document[_0x4f7b38(0xa2)](_0x4f7b38(0x74))[_0x4f7b38(0x1a9)],_0x2f1fb5=document['getElementById'](_0x4f7b38(0x11f))[_0x4f7b38(0x1a9)],_0x18a16d=document['getElementById']('liang_s')['value'],_0x46fafd=[0x5];_0x46fafd[0x0]=_0x3d2def,_0x46fafd[0x1]=_0x961eba,_0x46fafd[0x2]=_0x2b317d,_0x46fafd[0x3]=_0x2f1fb5,_0x46fafd[0x4]=_0x18a16d,await write(0xfd,_0x46fafd);}async function set_EPD_CMD_MY(){const _0x2a873b=_0x43c175,_0x26c434=document['getElementById'](_0x2a873b(0xf4))[_0x2a873b(0x1a9)],_0xf45ffd=document[_0x2a873b(0xa2)](_0x2a873b(0x179))[_0x2a873b(0x1a9)],_0x102bdf=document[_0x2a873b(0xa2)](_0x2a873b(0xe5))[_0x2a873b(0x1a9)],_0x2cc24f=document[_0x2a873b(0xa2)]('jushua_time')['value'],_0x4c7174=[0x4];_0x4c7174[0x0]=_0x26c434,_0x4c7174[0x1]=_0xf45ffd,_0x4c7174[0x2]=_0x102bdf,_0x4c7174[0x3]=_0x2cc24f,await write(0xeb,_0x4c7174);}async function set_EPD_CMD_COLOR(){const _0xe8b24b=_0x43c175,_0x206d62=document['getElementById'](_0xe8b24b(0xc0))['value'],_0x4c4e4b=document[_0xe8b24b(0xa2)](_0xe8b24b(0xda))[_0xe8b24b(0x1a9)],_0x148f8a=document[_0xe8b24b(0xa2)](_0xe8b24b(0x14b))[_0xe8b24b(0x1a9)],_0x553641=document[_0xe8b24b(0xa2)](_0xe8b24b(0xcc))[_0xe8b24b(0x1a9)],_0x5ece61=document['getElementById'](_0xe8b24b(0x119))[_0xe8b24b(0x1a9)],_0x5325f6=document['getElementById'](_0xe8b24b(0x14d))[_0xe8b24b(0x1a9)],_0x4e745b=document[_0xe8b24b(0xa2)](_0xe8b24b(0x1a3))['value'],_0x4b552b=[0x7];_0x4b552b[0x0]=_0x206d62,_0x4b552b[0x1]=_0x4c4e4b,_0x4b552b[0x2]=_0x148f8a,_0x4b552b[0x3]=_0x553641,_0x4b552b[0x4]=_0x5ece61,_0x4b552b[0x5]=_0x5325f6,_0x4b552b[0x6]=_0x4e745b,await write(0xea,_0x4b552b);}async function set_EPD_CMD_4_MS(){const _0x369bc0=_0x43c175,_0x319c3f=document['getElementById'](_0x369bc0(0x109))[_0x369bc0(0x1a9)],_0x395935=document[_0x369bc0(0xa2)](_0x369bc0(0x10a))[_0x369bc0(0x1a9)],_0x48ee12=document[_0x369bc0(0xa2)](_0x369bc0(0x18b))[_0x369bc0(0x1a9)],_0x184fe9=document[_0x369bc0(0xa2)](_0x369bc0(0x145))[_0x369bc0(0x1a9)],_0x183008=document[_0x369bc0(0xa2)](_0x369bc0(0x1aa))[_0x369bc0(0x1a9)],_0xd676dc=document['getElementById'](_0x369bc0(0x94))['value'],_0x35fb8c=document[_0x369bc0(0xa2)](_0x369bc0(0x14e))[_0x369bc0(0x1a9)],_0x2a38d5=[0x7];_0x2a38d5[0x0]=_0x319c3f,_0x2a38d5[0x1]=_0x395935,_0x2a38d5[0x2]=_0x48ee12,_0x2a38d5[0x3]=_0x184fe9,_0x2a38d5[0x4]=_0x183008,_0x2a38d5[0x5]=_0xd676dc,_0x2a38d5[0x6]=_0x35fb8c,await write(0xfe,_0x2a38d5);}async function send_time(_0x550d31){const _0x13981b=_0x43c175,_0x2cd0e6=new Date()[_0x13981b(0xd5)]()/0x3e8,_0x59e31d=new Uint8Array([_0x2cd0e6>>0x18&0xff,_0x2cd0e6>>0x10&0xff,_0x2cd0e6>>0x8&0xff,_0x2cd0e6&0xff,-(new Date()[_0x13981b(0x102)]()/0x3c),_0x550d31]);await write(0xa3,_0x59e31d)&&addLog(_0x13981b(0xbe));}async function set_EPD_CMD_4_ZF(_0x347da7){const _0x49ec64=_0x43c175,_0x1c4812=[0x1];_0x1c4812[0x0]=_0x347da7,await write(0xfb,_0x1c4812),_0x347da7==0x0&&(syncTime(0x2),addLog(_0x49ec64(0xfa)));}window[_0x43c175(0x83)]=init;
