const _0x4f4f15=_0x4d08;(function(_0x11ea4c,_0xde1547){const _0x496cf4=_0x4d08,_0xafec9e=_0x11ea4c();while(!![]){try{const _0xbfa72a=parseInt(_0x496cf4(0x1ac))/0x1*(-parseInt(_0x496cf4(0x2e3))/0x2)+parseInt(_0x496cf4(0x281))/0x3*(parseInt(_0x496cf4(0x23f))/0x4)+parseInt(_0x496cf4(0x2ac))/0x5*(-parseInt(_0x496cf4(0x202))/0x6)+-parseInt(_0x496cf4(0x2a0))/0x7+parseInt(_0x496cf4(0x1d9))/0x8*(parseInt(_0x496cf4(0x232))/0x9)+-parseInt(_0x496cf4(0x1ca))/0xa+-parseInt(_0x496cf4(0x1bb))/0xb*(-parseInt(_0x496cf4(0x24f))/0xc);if(_0xbfa72a===_0xde1547)break;else _0xafec9e['push'](_0xafec9e['shift']());}catch(_0x36e58a){_0xafec9e['push'](_0xafec9e['shift']());}}}(_0x3f6a,0x771c6));let sourceImage=null,originalImage=null,canvas,ctx,floatCanvas,floatCtx,originalCanvasData=null,startTime,currentParams={'saturation':0x64,'brightness':0x64,'contrast':0x64,'diffusion':0x32,'ditherAlg':_0x4f4f15(0x2c8)},currentMode=_0x4f4f15(0x263),canvasRotation=0x0,isDrawing=![],lastX=0x0,lastY=0x0,currentTool='pen',brushSize=0x3,brushColor=_0x4f4f15(0x248),imageScale=0x64,imageOffset={'x':0x0,'y':0x0},isDraggingImage=![],dragStartPos={'x':0x0,'y':0x0},shiftKeyPressed=![],imageRotation=0x0,isDrawingModeActive=![],isDragging=![],dragOffset={'x':0x0,'y':0x0},isResizing=![],bleDevice,gattServer,epdService,epdCharacteristic,msgIndex,appVersion,textDecoder;const canvasSizes=[{'name':_0x4f4f15(0x218),'width':0x7a,'height':0xfa},{'name':_0x4f4f15(0x274),'width':0x190,'height':0x12c},{'name':'7.5_800_480','width':0x320,'height':0x1e0}],threeColorPalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1},{'name':'红色','r':0xff,'g':0x0,'b':0x0,'value':0x2}],blackWhitePalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1}];function adjustContrast(_0x4064ab,_0x22785f){const _0x4146e=_0x4f4f15,_0x3cc709=_0x4064ab[_0x4146e(0x259)];for(let _0x2e9474=0x0;_0x2e9474<_0x3cc709['length'];_0x2e9474+=0x4){_0x3cc709[_0x2e9474]=Math['min'](0xff,Math[_0x4146e(0x2e1)](0x0,(_0x3cc709[_0x2e9474]-0x80)*_0x22785f+0x80)),_0x3cc709[_0x2e9474+0x1]=Math['min'](0xff,Math[_0x4146e(0x2e1)](0x0,(_0x3cc709[_0x2e9474+0x1]-0x80)*_0x22785f+0x80)),_0x3cc709[_0x2e9474+0x2]=Math['min'](0xff,Math['max'](0x0,(_0x3cc709[_0x2e9474+0x2]-0x80)*_0x22785f+0x80));}return _0x4064ab;}function adjustBrightness(_0x2177be,_0x540388){const _0x260d9f=_0x4f4f15,_0x3cbcc3=_0x540388/0x64,_0x126464=_0x2177be[_0x260d9f(0x259)];for(let _0x235663=0x0;_0x235663<_0x126464[_0x260d9f(0x2a5)];_0x235663+=0x4){_0x126464[_0x235663]=Math['min'](0xff,Math['max'](0x0,_0x126464[_0x235663]*_0x3cbcc3)),_0x126464[_0x235663+0x1]=Math[_0x260d9f(0x20e)](0xff,Math[_0x260d9f(0x2e1)](0x0,_0x126464[_0x235663+0x1]*_0x3cbcc3)),_0x126464[_0x235663+0x2]=Math[_0x260d9f(0x20e)](0xff,Math[_0x260d9f(0x2e1)](0x0,_0x126464[_0x235663+0x2]*_0x3cbcc3));}return _0x2177be;}function adjustSaturation(_0x319373,_0x29b2cb){const _0x105b90=_0x4f4f15,_0x35af21=_0x319373[_0x105b90(0x259)];for(let _0xc7880c=0x0;_0xc7880c<_0x35af21[_0x105b90(0x2a5)];_0xc7880c+=0x4){const _0x399642=0.299*_0x35af21[_0xc7880c]+0.587*_0x35af21[_0xc7880c+0x1]+0.114*_0x35af21[_0xc7880c+0x2];_0x35af21[_0xc7880c]=Math[_0x105b90(0x20e)](0xff,Math['max'](0x0,_0x399642+(_0x35af21[_0xc7880c]-_0x399642)*_0x29b2cb)),_0x35af21[_0xc7880c+0x1]=Math['min'](0xff,Math['max'](0x0,_0x399642+(_0x35af21[_0xc7880c+0x1]-_0x399642)*_0x29b2cb)),_0x35af21[_0xc7880c+0x2]=Math[_0x105b90(0x20e)](0xff,Math['max'](0x0,_0x399642+(_0x35af21[_0xc7880c+0x2]-_0x399642)*_0x29b2cb));}return _0x319373;}function rgbToLab(_0x211b2a,_0xa5683a,_0x2e3d79){const _0x4bd536=_0x4f4f15;_0x211b2a=_0x211b2a/0xff,_0xa5683a=_0xa5683a/0xff,_0x2e3d79=_0x2e3d79/0xff,_0x211b2a=_0x211b2a>0.04045?Math['pow']((_0x211b2a+0.055)/1.055,2.4):_0x211b2a/12.92,_0xa5683a=_0xa5683a>0.04045?Math[_0x4bd536(0x216)]((_0xa5683a+0.055)/1.055,2.4):_0xa5683a/12.92,_0x2e3d79=_0x2e3d79>0.04045?Math[_0x4bd536(0x216)]((_0x2e3d79+0.055)/1.055,2.4):_0x2e3d79/12.92,_0x211b2a*=0x64,_0xa5683a*=0x64,_0x2e3d79*=0x64;let _0x2241c8=_0x211b2a*0.4124+_0xa5683a*0.3576+_0x2e3d79*0.1805,_0x9e3bd4=_0x211b2a*0.2126+_0xa5683a*0.7152+_0x2e3d79*0.0722,_0x584160=_0x211b2a*0.0193+_0xa5683a*0.1192+_0x2e3d79*0.9505;_0x2241c8/=95.047,_0x9e3bd4/=0x64,_0x584160/=108.883,_0x2241c8=_0x2241c8>0.008856?Math[_0x4bd536(0x216)](_0x2241c8,0x1/0x3):7.787*_0x2241c8+0x10/0x74,_0x9e3bd4=_0x9e3bd4>0.008856?Math[_0x4bd536(0x216)](_0x9e3bd4,0x1/0x3):7.787*_0x9e3bd4+0x10/0x74,_0x584160=_0x584160>0.008856?Math['pow'](_0x584160,0x1/0x3):7.787*_0x584160+0x10/0x74;const _0x5659ab=0x74*_0x9e3bd4-0x10,_0x1fec49=0x1f4*(_0x2241c8-_0x9e3bd4),_0x4179cf=0xc8*(_0x9e3bd4-_0x584160);return{'l':_0x5659ab,'a':_0x1fec49,'b':_0x4179cf};}function labDistance(_0x26aff6,_0x4afcc8){const _0x5ab10a=_0x4f4f15,_0x33258a=_0x26aff6['l']-_0x4afcc8['l'],_0x15f902=_0x26aff6['a']-_0x4afcc8['a'],_0x33e043=_0x26aff6['b']-_0x4afcc8['b'];return Math[_0x5ab10a(0x1d7)](0.2*_0x33258a*_0x33258a+0x3*_0x15f902*_0x15f902+0x3*_0x33e043*_0x33e043);}function findClosestColor(_0xd99e74,_0x27f107,_0x21a9bc,_0x215899){const _0x25b4f2=_0x4f4f15;let _0x3e2e9d;if(_0x215899===_0x25b4f2(0x240)){_0x3e2e9d=threeColorPalette;if(_0xd99e74>0x78&&_0xd99e74>_0x27f107*1.5&&_0xd99e74>_0x21a9bc*1.5)return threeColorPalette[0x2];const _0x4b40ff=0.299*_0xd99e74+0.587*_0x27f107+0.114*_0x21a9bc;return _0x4b40ff<0x80?threeColorPalette[0x0]:threeColorPalette[0x1];}else{_0x3e2e9d=blackWhitePalette;const _0x532f97=0.299*_0xd99e74+0.587*_0x27f107+0.114*_0x21a9bc;return _0x532f97<0x80?blackWhitePalette[0x0]:blackWhitePalette[0x1];}}const DitherAlgorithms={'floydSteinberg':function(_0x54d30e,_0x8a6300,_0x29a694){const _0x5f4958=_0x4f4f15,_0x152915=_0x54d30e['width'],_0x5686ea=_0x54d30e[_0x5f4958(0x1d2)],_0x50664f=_0x54d30e[_0x5f4958(0x259)],_0x5da222=new Uint8ClampedArray(_0x50664f);for(let _0x1db795=0x0;_0x1db795<_0x5686ea;_0x1db795++){for(let _0x212f98=0x0;_0x212f98<_0x152915;_0x212f98++){const _0x494bc0=(_0x1db795*_0x152915+_0x212f98)*0x4,_0x561029=_0x5da222[_0x494bc0],_0x6e93e5=_0x5da222[_0x494bc0+0x1],_0x588f42=_0x5da222[_0x494bc0+0x2],_0x397d60=findClosestColor(_0x561029,_0x6e93e5,_0x588f42,_0x29a694),_0x4b650e=(_0x561029-_0x397d60['r'])*_0x8a6300,_0x1f22d7=(_0x6e93e5-_0x397d60['g'])*_0x8a6300,_0x527749=(_0x588f42-_0x397d60['b'])*_0x8a6300;if(_0x212f98+0x1<_0x152915){const _0x427743=_0x494bc0+0x4;_0x5da222[_0x427743]=Math[_0x5f4958(0x20e)](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x427743]+_0x4b650e*0x7/0x10)),_0x5da222[_0x427743+0x1]=Math[_0x5f4958(0x20e)](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x427743+0x1]+_0x1f22d7*0x7/0x10)),_0x5da222[_0x427743+0x2]=Math[_0x5f4958(0x20e)](0xff,Math['max'](0x0,_0x5da222[_0x427743+0x2]+_0x527749*0x7/0x10));}if(_0x1db795+0x1<_0x5686ea){if(_0x212f98>0x0){const _0x4294bd=_0x494bc0+_0x152915*0x4-0x4;_0x5da222[_0x4294bd]=Math[_0x5f4958(0x20e)](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x4294bd]+_0x4b650e*0x3/0x10)),_0x5da222[_0x4294bd+0x1]=Math[_0x5f4958(0x20e)](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x4294bd+0x1]+_0x1f22d7*0x3/0x10)),_0x5da222[_0x4294bd+0x2]=Math['min'](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x4294bd+0x2]+_0x527749*0x3/0x10));}const _0x3a844b=_0x494bc0+_0x152915*0x4;_0x5da222[_0x3a844b]=Math[_0x5f4958(0x20e)](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x3a844b]+_0x4b650e*0x5/0x10)),_0x5da222[_0x3a844b+0x1]=Math['min'](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x3a844b+0x1]+_0x1f22d7*0x5/0x10)),_0x5da222[_0x3a844b+0x2]=Math['min'](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x3a844b+0x2]+_0x527749*0x5/0x10));if(_0x212f98+0x1<_0x152915){const _0x424231=_0x494bc0+_0x152915*0x4+0x4;_0x5da222[_0x424231]=Math['min'](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x424231]+_0x4b650e*0x1/0x10)),_0x5da222[_0x424231+0x1]=Math['min'](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x424231+0x1]+_0x1f22d7*0x1/0x10)),_0x5da222[_0x424231+0x2]=Math[_0x5f4958(0x20e)](0xff,Math[_0x5f4958(0x2e1)](0x0,_0x5da222[_0x424231+0x2]+_0x527749*0x1/0x10));}}}}for(let _0xb9bd03=0x0;_0xb9bd03<_0x5686ea;_0xb9bd03++){for(let _0x493e79=0x0;_0x493e79<_0x152915;_0x493e79++){const _0x1ef01c=(_0xb9bd03*_0x152915+_0x493e79)*0x4,_0x43f49d=_0x5da222[_0x1ef01c],_0x5d0486=_0x5da222[_0x1ef01c+0x1],_0x1d0bf5=_0x5da222[_0x1ef01c+0x2],_0x5b62fc=findClosestColor(_0x43f49d,_0x5d0486,_0x1d0bf5,_0x29a694);_0x50664f[_0x1ef01c]=_0x5b62fc['r'],_0x50664f[_0x1ef01c+0x1]=_0x5b62fc['g'],_0x50664f[_0x1ef01c+0x2]=_0x5b62fc['b'];}}return _0x54d30e;},'atkinson':function(_0xfb5eb4,_0x435dcb,_0x2d0929){const _0x378ec5=_0x4f4f15,_0x8ded73=_0xfb5eb4[_0x378ec5(0x1dc)],_0x1eeb6e=_0xfb5eb4[_0x378ec5(0x1d2)],_0x15e69f=_0xfb5eb4[_0x378ec5(0x259)],_0x313e0e=new Uint8ClampedArray(_0x15e69f),_0x30f1e9=_0x435dcb*0x1/0x8;for(let _0x12c49b=0x0;_0x12c49b<_0x1eeb6e;_0x12c49b++){for(let _0x33279a=0x0;_0x33279a<_0x8ded73;_0x33279a++){const _0x821520=(_0x12c49b*_0x8ded73+_0x33279a)*0x4,_0x5a9944=_0x313e0e[_0x821520],_0x558aa5=_0x313e0e[_0x821520+0x1],_0x1e3e68=_0x313e0e[_0x821520+0x2],_0x11cb95=findClosestColor(_0x5a9944,_0x558aa5,_0x1e3e68,_0x2d0929),_0x54a3b1=(_0x5a9944-_0x11cb95['r'])*_0x30f1e9,_0xc90dbe=(_0x558aa5-_0x11cb95['g'])*_0x30f1e9,_0x36ecf1=(_0x1e3e68-_0x11cb95['b'])*_0x30f1e9;if(_0x33279a+0x1<_0x8ded73){const _0x2ecd06=_0x821520+0x4;_0x313e0e[_0x2ecd06]=Math[_0x378ec5(0x20e)](0xff,Math['max'](0x0,_0x313e0e[_0x2ecd06]+_0x54a3b1)),_0x313e0e[_0x2ecd06+0x1]=Math[_0x378ec5(0x20e)](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x2ecd06+0x1]+_0xc90dbe)),_0x313e0e[_0x2ecd06+0x2]=Math[_0x378ec5(0x20e)](0xff,Math['max'](0x0,_0x313e0e[_0x2ecd06+0x2]+_0x36ecf1));}if(_0x33279a+0x2<_0x8ded73){const _0x3bbf4b=_0x821520+0x8;_0x313e0e[_0x3bbf4b]=Math[_0x378ec5(0x20e)](0xff,Math['max'](0x0,_0x313e0e[_0x3bbf4b]+_0x54a3b1)),_0x313e0e[_0x3bbf4b+0x1]=Math['min'](0xff,Math['max'](0x0,_0x313e0e[_0x3bbf4b+0x1]+_0xc90dbe)),_0x313e0e[_0x3bbf4b+0x2]=Math['min'](0xff,Math['max'](0x0,_0x313e0e[_0x3bbf4b+0x2]+_0x36ecf1));}if(_0x12c49b+0x1<_0x1eeb6e){if(_0x33279a>0x0){const _0x43ebab=_0x821520+_0x8ded73*0x4-0x4;_0x313e0e[_0x43ebab]=Math[_0x378ec5(0x20e)](0xff,Math['max'](0x0,_0x313e0e[_0x43ebab]+_0x54a3b1)),_0x313e0e[_0x43ebab+0x1]=Math[_0x378ec5(0x20e)](0xff,Math['max'](0x0,_0x313e0e[_0x43ebab+0x1]+_0xc90dbe)),_0x313e0e[_0x43ebab+0x2]=Math[_0x378ec5(0x20e)](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x43ebab+0x2]+_0x36ecf1));}const _0x29e6a3=_0x821520+_0x8ded73*0x4;_0x313e0e[_0x29e6a3]=Math[_0x378ec5(0x20e)](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x29e6a3]+_0x54a3b1)),_0x313e0e[_0x29e6a3+0x1]=Math[_0x378ec5(0x20e)](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x29e6a3+0x1]+_0xc90dbe)),_0x313e0e[_0x29e6a3+0x2]=Math[_0x378ec5(0x20e)](0xff,Math['max'](0x0,_0x313e0e[_0x29e6a3+0x2]+_0x36ecf1));if(_0x33279a+0x1<_0x8ded73){const _0x28b5fa=_0x821520+_0x8ded73*0x4+0x4;_0x313e0e[_0x28b5fa]=Math['min'](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x28b5fa]+_0x54a3b1)),_0x313e0e[_0x28b5fa+0x1]=Math[_0x378ec5(0x20e)](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x28b5fa+0x1]+_0xc90dbe)),_0x313e0e[_0x28b5fa+0x2]=Math['min'](0xff,Math[_0x378ec5(0x2e1)](0x0,_0x313e0e[_0x28b5fa+0x2]+_0x36ecf1));}}}}for(let _0x44a10e=0x0;_0x44a10e<_0x1eeb6e;_0x44a10e++){for(let _0x22aaac=0x0;_0x22aaac<_0x8ded73;_0x22aaac++){const _0x429f2c=(_0x44a10e*_0x8ded73+_0x22aaac)*0x4,_0x1d7956=_0x313e0e[_0x429f2c],_0x1ff229=_0x313e0e[_0x429f2c+0x1],_0x2fa785=_0x313e0e[_0x429f2c+0x2],_0xbce700=findClosestColor(_0x1d7956,_0x1ff229,_0x2fa785,_0x2d0929);_0x15e69f[_0x429f2c]=_0xbce700['r'],_0x15e69f[_0x429f2c+0x1]=_0xbce700['g'],_0x15e69f[_0x429f2c+0x2]=_0xbce700['b'];}}return _0xfb5eb4;},'bayer':function(_0x37f723,_0x32c54d,_0x34b295){const _0x3dccc1=_0x4f4f15,_0x32e919=_0x37f723['width'],_0x30a037=_0x37f723[_0x3dccc1(0x1d2)],_0x4bc00c=_0x37f723[_0x3dccc1(0x259)],_0x349546=[[0x0,0x8,0x2,0xa],[0xc,0x4,0xe,0x6],[0x3,0xb,0x1,0x9],[0xf,0x7,0xd,0x5]],_0x8d6534=0x4,_0x3fb2f1=0x10;for(let _0x34db33=0x0;_0x34db33<_0x30a037;_0x34db33++){for(let _0x4d51ac=0x0;_0x4d51ac<_0x32e919;_0x4d51ac++){const _0x191859=(_0x34db33*_0x32e919+_0x4d51ac)*0x4,_0xbe0daa=_0x4bc00c[_0x191859],_0x29571e=_0x4bc00c[_0x191859+0x1],_0x3023aa=_0x4bc00c[_0x191859+0x2],_0x4fc26e=0.299*_0xbe0daa+0.587*_0x29571e+0.114*_0x3023aa,_0x402fad=_0x4d51ac%_0x8d6534,_0x4ab17c=_0x34db33%_0x8d6534,_0x1eb549=_0x349546[_0x4ab17c][_0x402fad];let _0x4c4a98=_0x4fc26e;if(_0x34b295==='threeColor'&&_0xbe0daa>0x78&&_0xbe0daa>_0x29571e*1.5&&_0xbe0daa>_0x3023aa*1.5)_0x4bc00c[_0x191859]=0xff,_0x4bc00c[_0x191859+0x1]=0x0,_0x4bc00c[_0x191859+0x2]=0x0;else{const _0x28d15a=_0x1eb549/_0x3fb2f1*0xff*_0x32c54d;_0x4fc26e<0x80+(_0x28d15a-0x80)?(_0x4bc00c[_0x191859]=0x0,_0x4bc00c[_0x191859+0x1]=0x0,_0x4bc00c[_0x191859+0x2]=0x0):(_0x4bc00c[_0x191859]=0xff,_0x4bc00c[_0x191859+0x1]=0xff,_0x4bc00c[_0x191859+0x2]=0xff);}}}return _0x37f723;},'stucki':function(_0x5884fc,_0x5f071d,_0x535cbf){const _0x1261b8=_0x4f4f15,_0x123b9a=_0x5884fc['width'],_0x182967=_0x5884fc['height'],_0x3e42af=_0x5884fc[_0x1261b8(0x259)],_0x3ea961=new Uint8ClampedArray(_0x3e42af),_0x2d3aca=_0x5f071d*0x1/0x2a;for(let _0x3982f9=0x0;_0x3982f9<_0x182967;_0x3982f9++){for(let _0x22693e=0x0;_0x22693e<_0x123b9a;_0x22693e++){const _0x591f41=(_0x3982f9*_0x123b9a+_0x22693e)*0x4,_0x58af34=_0x3ea961[_0x591f41],_0x36aac4=_0x3ea961[_0x591f41+0x1],_0x22015d=_0x3ea961[_0x591f41+0x2],_0x1a4b72=findClosestColor(_0x58af34,_0x36aac4,_0x22015d,_0x535cbf),_0x41de39=(_0x58af34-_0x1a4b72['r'])*_0x2d3aca,_0x1477c3=(_0x36aac4-_0x1a4b72['g'])*_0x2d3aca,_0x4d4eee=(_0x22015d-_0x1a4b72['b'])*_0x2d3aca;if(_0x22693e+0x1<_0x123b9a){const _0x358a96=_0x591f41+0x4;_0x3ea961[_0x358a96]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x358a96]+_0x41de39*0x8)),_0x3ea961[_0x358a96+0x1]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x358a96+0x1]+_0x1477c3*0x8)),_0x3ea961[_0x358a96+0x2]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x358a96+0x2]+_0x4d4eee*0x8));}if(_0x22693e+0x2<_0x123b9a){const _0x4f4933=_0x591f41+0x8;_0x3ea961[_0x4f4933]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x4f4933]+_0x41de39*0x4)),_0x3ea961[_0x4f4933+0x1]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x4f4933+0x1]+_0x1477c3*0x4)),_0x3ea961[_0x4f4933+0x2]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x4f4933+0x2]+_0x4d4eee*0x4));}if(_0x3982f9+0x1<_0x182967){if(_0x22693e>0x1){const _0x891a9b=_0x591f41+_0x123b9a*0x4-0x8;_0x3ea961[_0x891a9b]=Math['min'](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x891a9b]+_0x41de39*0x2)),_0x3ea961[_0x891a9b+0x1]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x891a9b+0x1]+_0x1477c3*0x2)),_0x3ea961[_0x891a9b+0x2]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x891a9b+0x2]+_0x4d4eee*0x2));}if(_0x22693e>0x0){const _0x1405d5=_0x591f41+_0x123b9a*0x4-0x4;_0x3ea961[_0x1405d5]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x1405d5]+_0x41de39*0x4)),_0x3ea961[_0x1405d5+0x1]=Math['min'](0xff,Math['max'](0x0,_0x3ea961[_0x1405d5+0x1]+_0x1477c3*0x4)),_0x3ea961[_0x1405d5+0x2]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x1405d5+0x2]+_0x4d4eee*0x4));}const _0x4bd586=_0x591f41+_0x123b9a*0x4;_0x3ea961[_0x4bd586]=Math['min'](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x4bd586]+_0x41de39*0x8)),_0x3ea961[_0x4bd586+0x1]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x4bd586+0x1]+_0x1477c3*0x8)),_0x3ea961[_0x4bd586+0x2]=Math['min'](0xff,Math['max'](0x0,_0x3ea961[_0x4bd586+0x2]+_0x4d4eee*0x8));if(_0x22693e+0x1<_0x123b9a){const _0x2d3ba3=_0x591f41+_0x123b9a*0x4+0x4;_0x3ea961[_0x2d3ba3]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x2d3ba3]+_0x41de39*0x4)),_0x3ea961[_0x2d3ba3+0x1]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x2d3ba3+0x1]+_0x1477c3*0x4)),_0x3ea961[_0x2d3ba3+0x2]=Math['min'](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x2d3ba3+0x2]+_0x4d4eee*0x4));}if(_0x22693e+0x2<_0x123b9a){const _0x6ac625=_0x591f41+_0x123b9a*0x4+0x8;_0x3ea961[_0x6ac625]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x6ac625]+_0x41de39*0x2)),_0x3ea961[_0x6ac625+0x1]=Math[_0x1261b8(0x20e)](0xff,Math['max'](0x0,_0x3ea961[_0x6ac625+0x1]+_0x1477c3*0x2)),_0x3ea961[_0x6ac625+0x2]=Math[_0x1261b8(0x20e)](0xff,Math[_0x1261b8(0x2e1)](0x0,_0x3ea961[_0x6ac625+0x2]+_0x4d4eee*0x2));}}}}for(let _0x585e55=0x0;_0x585e55<_0x182967;_0x585e55++){for(let _0x17bfc5=0x0;_0x17bfc5<_0x123b9a;_0x17bfc5++){const _0x5c882e=(_0x585e55*_0x123b9a+_0x17bfc5)*0x4,_0x1c3670=_0x3ea961[_0x5c882e],_0x36bee4=_0x3ea961[_0x5c882e+0x1],_0x33b086=_0x3ea961[_0x5c882e+0x2],_0x1959dc=findClosestColor(_0x1c3670,_0x36bee4,_0x33b086,_0x535cbf);_0x3e42af[_0x5c882e]=_0x1959dc['r'],_0x3e42af[_0x5c882e+0x1]=_0x1959dc['g'],_0x3e42af[_0x5c882e+0x2]=_0x1959dc['b'];}}return _0x5884fc;},'jarvis':function(_0x34d005,_0x13f56a,_0x494e7a){const _0x31945d=_0x4f4f15,_0xf1e8b6=_0x34d005[_0x31945d(0x1dc)],_0x63603f=_0x34d005[_0x31945d(0x1d2)],_0x4e5a10=_0x34d005[_0x31945d(0x259)],_0x500590=new Uint8ClampedArray(_0x4e5a10),_0x213a94=_0x13f56a*0x1/0x30;for(let _0x327de0=0x0;_0x327de0<_0x63603f;_0x327de0++){for(let _0x1f789a=0x0;_0x1f789a<_0xf1e8b6;_0x1f789a++){const _0x217050=(_0x327de0*_0xf1e8b6+_0x1f789a)*0x4,_0x3d66ea=_0x500590[_0x217050],_0x316b04=_0x500590[_0x217050+0x1],_0x54d05e=_0x500590[_0x217050+0x2],_0x55781a=findClosestColor(_0x3d66ea,_0x316b04,_0x54d05e,_0x494e7a),_0x28936e=(_0x3d66ea-_0x55781a['r'])*_0x213a94,_0x12c2fa=(_0x316b04-_0x55781a['g'])*_0x213a94,_0x4b36fc=(_0x54d05e-_0x55781a['b'])*_0x213a94;if(_0x1f789a+0x1<_0xf1e8b6){const _0x43bf23=_0x217050+0x4;_0x500590[_0x43bf23]=Math['min'](0xff,Math['max'](0x0,_0x500590[_0x43bf23]+_0x28936e*0x7)),_0x500590[_0x43bf23+0x1]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x43bf23+0x1]+_0x12c2fa*0x7)),_0x500590[_0x43bf23+0x2]=Math['min'](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x43bf23+0x2]+_0x4b36fc*0x7));}if(_0x1f789a+0x2<_0xf1e8b6){const _0x30d9b4=_0x217050+0x8;_0x500590[_0x30d9b4]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x30d9b4]+_0x28936e*0x5)),_0x500590[_0x30d9b4+0x1]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x30d9b4+0x1]+_0x12c2fa*0x5)),_0x500590[_0x30d9b4+0x2]=Math['min'](0xff,Math['max'](0x0,_0x500590[_0x30d9b4+0x2]+_0x4b36fc*0x5));}if(_0x327de0+0x1<_0x63603f){if(_0x1f789a>0x1){const _0x7c9c51=_0x217050+_0xf1e8b6*0x4-0x8;_0x500590[_0x7c9c51]=Math['min'](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x7c9c51]+_0x28936e*0x3)),_0x500590[_0x7c9c51+0x1]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x7c9c51+0x1]+_0x12c2fa*0x3)),_0x500590[_0x7c9c51+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x7c9c51+0x2]+_0x4b36fc*0x3));}if(_0x1f789a>0x0){const _0x28cba5=_0x217050+_0xf1e8b6*0x4-0x4;_0x500590[_0x28cba5]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x28cba5]+_0x28936e*0x5)),_0x500590[_0x28cba5+0x1]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x28cba5+0x1]+_0x12c2fa*0x5)),_0x500590[_0x28cba5+0x2]=Math['min'](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x28cba5+0x2]+_0x4b36fc*0x5));}const _0x1f29d8=_0x217050+_0xf1e8b6*0x4;_0x500590[_0x1f29d8]=Math['min'](0xff,Math['max'](0x0,_0x500590[_0x1f29d8]+_0x28936e*0x7)),_0x500590[_0x1f29d8+0x1]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x1f29d8+0x1]+_0x12c2fa*0x7)),_0x500590[_0x1f29d8+0x2]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x1f29d8+0x2]+_0x4b36fc*0x7));if(_0x1f789a+0x1<_0xf1e8b6){const _0x20c813=_0x217050+_0xf1e8b6*0x4+0x4;_0x500590[_0x20c813]=Math['min'](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x20c813]+_0x28936e*0x5)),_0x500590[_0x20c813+0x1]=Math['min'](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x20c813+0x1]+_0x12c2fa*0x5)),_0x500590[_0x20c813+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x20c813+0x2]+_0x4b36fc*0x5));}if(_0x1f789a+0x2<_0xf1e8b6){const _0x37d610=_0x217050+_0xf1e8b6*0x4+0x8;_0x500590[_0x37d610]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x37d610]+_0x28936e*0x3)),_0x500590[_0x37d610+0x1]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x37d610+0x1]+_0x12c2fa*0x3)),_0x500590[_0x37d610+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x37d610+0x2]+_0x4b36fc*0x3));}}if(_0x327de0+0x2<_0x63603f){if(_0x1f789a>0x1){const _0x19ad79=_0x217050+_0xf1e8b6*0x4*0x2-0x8;_0x500590[_0x19ad79]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x19ad79]+_0x28936e*0x1)),_0x500590[_0x19ad79+0x1]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x19ad79+0x1]+_0x12c2fa*0x1)),_0x500590[_0x19ad79+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x19ad79+0x2]+_0x4b36fc*0x1));}if(_0x1f789a>0x0){const _0x3ccc7d=_0x217050+_0xf1e8b6*0x4*0x2-0x4;_0x500590[_0x3ccc7d]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x3ccc7d]+_0x28936e*0x3)),_0x500590[_0x3ccc7d+0x1]=Math['min'](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x3ccc7d+0x1]+_0x12c2fa*0x3)),_0x500590[_0x3ccc7d+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x3ccc7d+0x2]+_0x4b36fc*0x3));}const _0x14f228=_0x217050+_0xf1e8b6*0x4*0x2;_0x500590[_0x14f228]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x14f228]+_0x28936e*0x5)),_0x500590[_0x14f228+0x1]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x14f228+0x1]+_0x12c2fa*0x5)),_0x500590[_0x14f228+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x14f228+0x2]+_0x4b36fc*0x5));if(_0x1f789a+0x1<_0xf1e8b6){const _0x291948=_0x217050+_0xf1e8b6*0x4*0x2+0x4;_0x500590[_0x291948]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x291948]+_0x28936e*0x3)),_0x500590[_0x291948+0x1]=Math[_0x31945d(0x20e)](0xff,Math['max'](0x0,_0x500590[_0x291948+0x1]+_0x12c2fa*0x3)),_0x500590[_0x291948+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x291948+0x2]+_0x4b36fc*0x3));}if(_0x1f789a+0x2<_0xf1e8b6){const _0x11226b=_0x217050+_0xf1e8b6*0x4*0x2+0x8;_0x500590[_0x11226b]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x11226b]+_0x28936e*0x1)),_0x500590[_0x11226b+0x1]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x11226b+0x1]+_0x12c2fa*0x1)),_0x500590[_0x11226b+0x2]=Math[_0x31945d(0x20e)](0xff,Math[_0x31945d(0x2e1)](0x0,_0x500590[_0x11226b+0x2]+_0x4b36fc*0x1));}}}}for(let _0x271e4=0x0;_0x271e4<_0x63603f;_0x271e4++){for(let _0x3affed=0x0;_0x3affed<_0xf1e8b6;_0x3affed++){const _0x59de6b=(_0x271e4*_0xf1e8b6+_0x3affed)*0x4,_0x122d02=_0x500590[_0x59de6b],_0x1632d0=_0x500590[_0x59de6b+0x1],_0x1a7f0d=_0x500590[_0x59de6b+0x2],_0x3ef9eb=findClosestColor(_0x122d02,_0x1632d0,_0x1a7f0d,_0x494e7a);_0x4e5a10[_0x59de6b]=_0x3ef9eb['r'],_0x4e5a10[_0x59de6b+0x1]=_0x3ef9eb['g'],_0x4e5a10[_0x59de6b+0x2]=_0x3ef9eb['b'];}}return _0x34d005;}};function floydSteinbergDither(_0x2b4d69,_0x499898,_0x10e4b7){const _0x3d5875=_0x4f4f15,_0x53290b=_0x2b4d69[_0x3d5875(0x1dc)],_0x1f742e=_0x2b4d69[_0x3d5875(0x1d2)],_0x4f0405=_0x2b4d69[_0x3d5875(0x259)],_0x1aa8f1=new Uint8ClampedArray(_0x4f0405);for(let _0x1eec94=0x0;_0x1eec94<_0x1f742e;_0x1eec94++){for(let _0x39e1b1=0x0;_0x39e1b1<_0x53290b;_0x39e1b1++){const _0x5f0411=(_0x1eec94*_0x53290b+_0x39e1b1)*0x4,_0xbc6ecd=_0x1aa8f1[_0x5f0411],_0x4961d5=_0x1aa8f1[_0x5f0411+0x1],_0x28c0cb=_0x1aa8f1[_0x5f0411+0x2],_0x1803d2=findClosestColor(_0xbc6ecd,_0x4961d5,_0x28c0cb,_0x10e4b7),_0x5f4e3a=(_0xbc6ecd-_0x1803d2['r'])*_0x499898,_0x5bed1b=(_0x4961d5-_0x1803d2['g'])*_0x499898,_0x1beb9f=(_0x28c0cb-_0x1803d2['b'])*_0x499898;if(_0x39e1b1+0x1<_0x53290b){const _0x4e4e86=_0x5f0411+0x4;_0x1aa8f1[_0x4e4e86]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x4e4e86]+_0x5f4e3a*0x7/0x10)),_0x1aa8f1[_0x4e4e86+0x1]=Math['min'](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x4e4e86+0x1]+_0x5bed1b*0x7/0x10)),_0x1aa8f1[_0x4e4e86+0x2]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x4e4e86+0x2]+_0x1beb9f*0x7/0x10));}if(_0x1eec94+0x1<_0x1f742e){if(_0x39e1b1>0x0){const _0x3b2a21=_0x5f0411+_0x53290b*0x4-0x4;_0x1aa8f1[_0x3b2a21]=Math['min'](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x3b2a21]+_0x5f4e3a*0x3/0x10)),_0x1aa8f1[_0x3b2a21+0x1]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x3b2a21+0x1]+_0x5bed1b*0x3/0x10)),_0x1aa8f1[_0x3b2a21+0x2]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x3b2a21+0x2]+_0x1beb9f*0x3/0x10));}const _0x38f647=_0x5f0411+_0x53290b*0x4;_0x1aa8f1[_0x38f647]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x38f647]+_0x5f4e3a*0x5/0x10)),_0x1aa8f1[_0x38f647+0x1]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x38f647+0x1]+_0x5bed1b*0x5/0x10)),_0x1aa8f1[_0x38f647+0x2]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x38f647+0x2]+_0x1beb9f*0x5/0x10));if(_0x39e1b1+0x1<_0x53290b){const _0x4c7e78=_0x5f0411+_0x53290b*0x4+0x4;_0x1aa8f1[_0x4c7e78]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x4c7e78]+_0x5f4e3a*0x1/0x10)),_0x1aa8f1[_0x4c7e78+0x1]=Math[_0x3d5875(0x20e)](0xff,Math[_0x3d5875(0x2e1)](0x0,_0x1aa8f1[_0x4c7e78+0x1]+_0x5bed1b*0x1/0x10)),_0x1aa8f1[_0x4c7e78+0x2]=Math[_0x3d5875(0x20e)](0xff,Math['max'](0x0,_0x1aa8f1[_0x4c7e78+0x2]+_0x1beb9f*0x1/0x10));}}}}for(let _0x43ae1d=0x0;_0x43ae1d<_0x1f742e;_0x43ae1d++){for(let _0x16ad05=0x0;_0x16ad05<_0x53290b;_0x16ad05++){const _0x44b48d=(_0x43ae1d*_0x53290b+_0x16ad05)*0x4,_0x21798f=_0x1aa8f1[_0x44b48d],_0x350f49=_0x1aa8f1[_0x44b48d+0x1],_0x3e8617=_0x1aa8f1[_0x44b48d+0x2],_0x5830c5=findClosestColor(_0x21798f,_0x350f49,_0x3e8617,_0x10e4b7);_0x4f0405[_0x44b48d]=_0x5830c5['r'],_0x4f0405[_0x44b48d+0x1]=_0x5830c5['g'],_0x4f0405[_0x44b48d+0x2]=_0x5830c5['b'];}}return _0x2b4d69;}function processImage1(_0x40a820,_0x290bf5,_0x459444,_0x617ad5,_0x49305b,_0x34ab9c,_0x22f2fb){const _0x2f406f=_0x4f4f15,_0x1f3093=new ImageData(new Uint8ClampedArray(_0x40a820[_0x2f406f(0x259)]),_0x40a820[_0x2f406f(0x1dc)],_0x40a820['height']);return adjustBrightness(_0x1f3093,_0x290bf5),adjustContrast(_0x1f3093,_0x459444),adjustSaturation(_0x1f3093,_0x617ad5),DitherAlgorithms[_0x22f2fb]?DitherAlgorithms[_0x22f2fb](_0x1f3093,_0x49305b,_0x34ab9c):floydSteinbergDither(_0x1f3093,_0x49305b,_0x34ab9c),_0x1f3093;}function imageDataToEpdBytes(_0x421f7e,_0x497007){const _0x4301ce=_0x4f4f15,_0x57248e=_0x421f7e[_0x4301ce(0x1dc)],_0x3b751f=_0x421f7e[_0x4301ce(0x1d2)],_0x4db9d9=_0x421f7e[_0x4301ce(0x259)];let _0x53552d;if(_0x497007===_0x4301ce(0x240)){_0x53552d=new Uint8Array(Math[_0x4301ce(0x1c7)](_0x57248e*_0x3b751f/0x8)*0x2);let _0x31d40f=0x0,_0x272736=Math[_0x4301ce(0x1c7)](_0x57248e*_0x3b751f/0x8),_0x1acafe=0x0,_0x47d022=0x0,_0xd8cf19=0x0;for(let _0x3c04b0=0x0;_0x3c04b0<_0x4db9d9[_0x4301ce(0x2a5)];_0x3c04b0+=0x4){const _0x488f67=_0x4db9d9[_0x3c04b0],_0x52b5c8=_0x4db9d9[_0x3c04b0+0x1],_0x3b74ab=_0x4db9d9[_0x3c04b0+0x2],_0x589d60=_0x488f67>0xc8&&_0x52b5c8<0x32&&_0x3b74ab<0x32,_0x2518bd=!_0x589d60&&0.299*_0x488f67+0.587*_0x52b5c8+0.114*_0x3b74ab<0x80;_0x2518bd&&(_0x47d022|=0x1<<0x7-_0x1acafe),_0x589d60&&(_0xd8cf19|=0x1<<0x7-_0x1acafe),_0x1acafe++,_0x1acafe===0x8&&(_0x53552d[_0x31d40f++]=_0x47d022,_0x53552d[_0x272736++]=_0xd8cf19,_0x1acafe=0x0,_0x47d022=0x0,_0xd8cf19=0x0);}_0x1acafe>0x0&&(_0x53552d[_0x31d40f]=_0x47d022,_0x53552d[_0x272736]=_0xd8cf19);}else{_0x53552d=new Uint8Array(Math[_0x4301ce(0x1c7)](_0x57248e*_0x3b751f/0x8));let _0x1658a1=0x0,_0x180734=0x0,_0x16e520=0x0;for(let _0x1eec91=0x0;_0x1eec91<_0x4db9d9['length'];_0x1eec91+=0x4){const _0x352114=_0x4db9d9[_0x1eec91],_0x3ce12d=_0x4db9d9[_0x1eec91+0x1],_0x488c71=_0x4db9d9[_0x1eec91+0x2],_0xb6e1da=0.299*_0x352114+0.587*_0x3ce12d+0.114*_0x488c71<0x80;_0xb6e1da&&(_0x16e520|=0x1<<0x7-_0x180734),_0x180734++,_0x180734===0x8&&(_0x53552d[_0x1658a1++]=_0x16e520,_0x180734=0x0,_0x16e520=0x0);}_0x180734>0x0&&(_0x53552d[_0x1658a1]=_0x16e520);}return _0x53552d;}const imageUpload=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x210)),previewCanvas=document[_0x4f4f15(0x1f1)]('previewCanvas'),floatPreviewCanvas=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2cb)),noImagePlaceholder=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2c0)),processedImageInfo=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x296)),btnProcess=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x1dd)),btnSend=document[_0x4f4f15(0x1f1)]('btnSend'),btnDownload=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x283)),btnReset=document['getElementById']('btnReset'),btnClearLog=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x1d8)),btnBlackWhite=document['getElementById'](_0x4f4f15(0x211)),btnBlackWhiteRed=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2aa)),ditherMode=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2b5)),ditherAlg=document['getElementById']('ditherAlg'),logContainer=document['getElementById'](_0x4f4f15(0x2a9)),statusContainer=document['getElementById'](_0x4f4f15(0x22a)),floatingCanvasContainer=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x1c5)),toggleCanvasFloat=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2bc)),closeCanvas=document[_0x4f4f15(0x1f1)]('closeCanvas'),canvasResizeHandle=document['getElementById'](_0x4f4f15(0x23c)),imageScaleSlider=document['getElementById'](_0x4f4f15(0x200)),imageScaleValue=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x212)),addTextBtn=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2dd)),timeDialog=document[_0x4f4f15(0x1f1)]('timeDialog'),datetimeInput=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x29a)),closeTimeDialog=document[_0x4f4f15(0x1f1)]('closeTimeDialog'),confirmTimeBtn=document['getElementById'](_0x4f4f15(0x21e)),imageWidthInput=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2d2)),imageHeightInput=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x22b)),toolPen=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2ab)),toolEraser=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x251)),toolText=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x27b)),toolClear=document[_0x4f4f15(0x1f1)]('toolClear'),brushSizeSlider=document[_0x4f4f15(0x1f1)]('brushSize'),fontSizeInput=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x22d)),fontFamilySelect=document[_0x4f4f15(0x1f1)]('fontFamily'),textInput=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x236)),drawingStatus=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2b1)),currentToolEl=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x252)),currentSizeEl=document['getElementById'](_0x4f4f15(0x26f)),drawingModeIndicator=document['getElementById']('drawingModeIndicator'),toggleDrawingModeBtn=document[_0x4f4f15(0x1f1)](_0x4f4f15(0x246)),floatToggleDrawingModeBtn=document[_0x4f4f15(0x1f1)]('floatToggleDrawingMode'),sliders={'saturation':document[_0x4f4f15(0x1f1)]('saturation'),'brightness':document[_0x4f4f15(0x1f1)](_0x4f4f15(0x237)),'contrast':document[_0x4f4f15(0x1f1)](_0x4f4f15(0x1ce)),'diffusion':document[_0x4f4f15(0x1f1)](_0x4f4f15(0x2d8))},ditherSlider=document['getElementById'](_0x4f4f15(0x1da)),sliderValues={'saturation':document[_0x4f4f15(0x1f1)](_0x4f4f15(0x201)),'brightness':document['getElementById'](_0x4f4f15(0x282)),'contrast':document['getElementById'](_0x4f4f15(0x284)),'diffusion':document[_0x4f4f15(0x1f1)]('diffusionValue')};function init(){const _0x112526=_0x4f4f15;canvas=previewCanvas,ctx=canvas['getContext']('2d'),floatCanvas=floatPreviewCanvas,floatCtx=floatCanvas[_0x112526(0x25a)]('2d'),updateCanvasSize();const _0x5a28f6=new Date(),_0x1fa01d=new Date(_0x5a28f6['getTime']()-_0x5a28f6[_0x112526(0x1f5)]()*0xea60)[_0x112526(0x203)]()['slice'](0x0,0x10);datetimeInput['value']=_0x1fa01d,canvas[_0x112526(0x1ed)](_0x112526(0x1b9),startDrawing),canvas[_0x112526(0x1ed)]('mousemove',draw),canvas[_0x112526(0x1ed)](_0x112526(0x2c5),stopDrawing),canvas['addEventListener'](_0x112526(0x20c),stopDrawing),floatCanvas['addEventListener'](_0x112526(0x1b9),startDrawingFloat),floatCanvas[_0x112526(0x1ed)]('mousemove',drawFloat),floatCanvas['addEventListener']('mouseup',stopDrawing),floatCanvas[_0x112526(0x1ed)](_0x112526(0x20c),stopDrawing),canvas[_0x112526(0x1ed)](_0x112526(0x1c4),handleTouchStart,{'passive':![]}),canvas[_0x112526(0x1ed)](_0x112526(0x2c6),handleTouchMove,{'passive':![]}),canvas[_0x112526(0x1ed)](_0x112526(0x1b7),handleTouchEnd),canvas[_0x112526(0x1ed)](_0x112526(0x231),handleTouchEnd),floatCanvas['addEventListener'](_0x112526(0x1c4),handleFloatTouchStart,{'passive':![]}),floatCanvas[_0x112526(0x1ed)]('touchmove',handleFloatTouchMove,{'passive':![]}),floatCanvas['addEventListener'](_0x112526(0x1b7),handleTouchEnd),floatCanvas[_0x112526(0x1ed)](_0x112526(0x231),handleTouchEnd),document['addEventListener'](_0x112526(0x273),_0x4d55b0=>{const _0x5cc25a=_0x112526;_0x4d55b0[_0x5cc25a(0x214)]===_0x5cc25a(0x1ec)&&(shiftKeyPressed=!![],sourceImage&&!isDrawingModeActive&&(canvas[_0x5cc25a(0x24b)]['cursor']=_0x5cc25a(0x278),floatCanvas[_0x5cc25a(0x24b)][_0x5cc25a(0x1b1)]='move'));}),document[_0x112526(0x1ed)](_0x112526(0x2a2),_0xe3b7d9=>{const _0x19d226=_0x112526;_0xe3b7d9[_0x19d226(0x214)]===_0x19d226(0x1ec)&&(shiftKeyPressed=![],updateCursorStyle());}),toggleDrawingModeBtn[_0x112526(0x1ed)](_0x112526(0x1c3),toggleDrawingMode),floatToggleDrawingModeBtn[_0x112526(0x1ed)](_0x112526(0x1c3),toggleDrawingMode),btnProcess[_0x112526(0x1ed)](_0x112526(0x1c3),processImage),btnSend[_0x112526(0x1ed)](_0x112526(0x1c3),sendimg),btnDownload[_0x112526(0x1ed)](_0x112526(0x1c3),downloadImageFile),btnReset['addEventListener'](_0x112526(0x1c3),resetProcessing),btnClearLog['addEventListener'](_0x112526(0x1c3),clearLog),toggleCanvasFloat[_0x112526(0x1ed)](_0x112526(0x1c3),toggleCanvas),closeCanvas['addEventListener']('click',hideCanvas),btnSetTime[_0x112526(0x1ed)](_0x112526(0x1c3),showTimeDialog),closeTimeDialog[_0x112526(0x1ed)]('click',hideTimeDialog),confirmTimeBtn[_0x112526(0x1ed)](_0x112526(0x1c3),setTime),brushSizeSlider[_0x112526(0x1ed)]('input',function(){const _0x3d95d2=_0x112526;brushSize=parseInt(this[_0x3d95d2(0x1e4)]),currentSizeEl[_0x3d95d2(0x2c9)]=brushSize;});const _0x89ca=floatingCanvasContainer[_0x112526(0x22e)](_0x112526(0x220));_0x89ca[_0x112526(0x1ed)](_0x112526(0x1b9),startDrag),document[_0x112526(0x1ed)](_0x112526(0x1b5),drag),document[_0x112526(0x1ed)](_0x112526(0x2c5),stopDrag),canvasResizeHandle['addEventListener'](_0x112526(0x1b9),startResize),document['addEventListener'](_0x112526(0x1b5),resize),document[_0x112526(0x1ed)](_0x112526(0x2c5),stopResize),Object[_0x112526(0x1db)](sliders)[_0x112526(0x1d5)](_0xe0856e=>{const _0x468bef=_0x112526;sliders[_0xe0856e]['addEventListener'](_0x468bef(0x275),_0x11dc81=>{const _0x2718b5=_0x468bef;currentParams[_0xe0856e]=parseInt(_0x11dc81['target'][_0x2718b5(0x1e4)]),sliderValues[_0xe0856e][_0x2718b5(0x2c9)]=''+currentParams[_0xe0856e];});}),document[_0x112526(0x1f1)](_0x112526(0x238))[_0x112526(0x1ed)](_0x112526(0x27e),function(){const _0x5771e9=_0x112526,_0x46039c=getSelectedCanvasSize();imageWidthInput[_0x5771e9(0x1e4)]=_0x46039c['width'],imageHeightInput[_0x5771e9(0x1e4)]=_0x46039c[_0x5771e9(0x1d2)];}),addLog(_0x112526(0x1e2)),updateButtonStatus();}function toggleDrawingMode(){const _0x4223d3=_0x4f4f15;isDrawingModeActive=!isDrawingModeActive,isDrawingModeActive?(toggleDrawingModeBtn[_0x4223d3(0x2ba)]=_0x4223d3(0x253),toggleDrawingModeBtn[_0x4223d3(0x1e6)][_0x4223d3(0x1e5)](_0x4223d3(0x2e2)),toggleDrawingModeBtn[_0x4223d3(0x1e6)][_0x4223d3(0x2a8)](_0x4223d3(0x295)),floatToggleDrawingModeBtn[_0x4223d3(0x2ba)]=_0x4223d3(0x253),floatToggleDrawingModeBtn[_0x4223d3(0x1e6)][_0x4223d3(0x2a8)](_0x4223d3(0x2c2)),drawingModeIndicator[_0x4223d3(0x1e6)][_0x4223d3(0x1e5)](_0x4223d3(0x1ad)),addLog('已进入绘画模式，图片已锁定无法移动')):(toggleDrawingModeBtn[_0x4223d3(0x2ba)]='<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画',toggleDrawingModeBtn[_0x4223d3(0x1e6)]['remove'](_0x4223d3(0x295)),toggleDrawingModeBtn[_0x4223d3(0x1e6)][_0x4223d3(0x2a8)]('bg-primary'),floatToggleDrawingModeBtn[_0x4223d3(0x2ba)]=_0x4223d3(0x261),floatToggleDrawingModeBtn[_0x4223d3(0x1e6)][_0x4223d3(0x1e5)](_0x4223d3(0x2c2)),drawingModeIndicator[_0x4223d3(0x1e6)][_0x4223d3(0x2a8)](_0x4223d3(0x1ad)),addLog(_0x4223d3(0x1d4))),updateCursorStyle();}function updateCursorStyle(){const _0x306299=_0x4f4f15;if(isDrawingModeActive){if(currentTool==='pen')canvas[_0x306299(0x24b)]['cursor']='crosshair',floatCanvas[_0x306299(0x24b)]['cursor']=_0x306299(0x1f8);else{if(currentTool==='eraser')canvas['style'][_0x306299(0x1b1)]=_0x306299(0x215),floatCanvas[_0x306299(0x24b)][_0x306299(0x1b1)]=_0x306299(0x215);else currentTool===_0x306299(0x1a7)&&(canvas[_0x306299(0x24b)]['cursor']='text',floatCanvas['style']['cursor']='text');}}else{if(shiftKeyPressed&&sourceImage)canvas['style'][_0x306299(0x1b1)]=_0x306299(0x278),floatCanvas['style'][_0x306299(0x1b1)]=_0x306299(0x278);else{if(currentTool===_0x306299(0x1b4))canvas[_0x306299(0x24b)][_0x306299(0x1b1)]=_0x306299(0x1f8),floatCanvas['style'][_0x306299(0x1b1)]=_0x306299(0x1f8);else{if(currentTool===_0x306299(0x270))canvas[_0x306299(0x24b)][_0x306299(0x1b1)]=_0x306299(0x215),floatCanvas[_0x306299(0x24b)]['cursor']=_0x306299(0x215);else currentTool==='text'&&(canvas[_0x306299(0x24b)][_0x306299(0x1b1)]=_0x306299(0x1a7),floatCanvas['style']['cursor']=_0x306299(0x1a7));}}}}function setDrawingTool(_0x1fffa9){const _0x4447e3=_0x4f4f15;currentTool=_0x1fffa9,[toolPen,toolEraser,toolText,toolClear][_0x4447e3(0x1d5)](_0x1c7cc2=>{const _0x1bb1a5=_0x4447e3;_0x1c7cc2[_0x1bb1a5(0x1e6)][_0x1bb1a5(0x1e5)](_0x1bb1a5(0x2a4));});switch(_0x1fffa9){case'pen':toolPen[_0x4447e3(0x1e6)][_0x4447e3(0x2a8)](_0x4447e3(0x2a4)),currentToolEl[_0x4447e3(0x2c9)]='画笔';break;case _0x4447e3(0x270):toolEraser[_0x4447e3(0x1e6)][_0x4447e3(0x2a8)](_0x4447e3(0x2a4)),currentToolEl[_0x4447e3(0x2c9)]=_0x4447e3(0x255);break;case _0x4447e3(0x1a7):toolText[_0x4447e3(0x1e6)][_0x4447e3(0x2a8)]('active'),currentToolEl[_0x4447e3(0x2c9)]='文字';break;}currentSizeEl['textContent']=brushSize,drawingStatus[_0x4447e3(0x1e6)]['remove'](_0x4447e3(0x1ad)),updateCursorStyle();}function setBrushColor(_0x1a8346){const _0x258a5f=_0x4f4f15;brushColor=_0x1a8346,document[_0x258a5f(0x1f1)](_0x258a5f(0x1df))[_0x258a5f(0x1e4)]=_0x1a8346,addLog(_0x258a5f(0x208)+_0x1a8346);}function getCanvasCoordinates(_0xcc18f7,_0x21ac95,_0x4ab913=![]){const _0xa684a4=_0x4f4f15,_0x5d123e=_0xcc18f7[_0xa684a4(0x21a)](),_0x36ad10=_0xcc18f7['width']/_0x5d123e['width'],_0xa433a3=_0xcc18f7[_0xa684a4(0x1d2)]/_0x5d123e[_0xa684a4(0x1d2)];let _0x4734f2,_0x186862;return _0x4ab913?(_0x4734f2=(_0x21ac95['touches'][0x0][_0xa684a4(0x2b3)]-_0x5d123e[_0xa684a4(0x28a)])*_0x36ad10,_0x186862=(_0x21ac95[_0xa684a4(0x28c)][0x0][_0xa684a4(0x229)]-_0x5d123e[_0xa684a4(0x206)])*_0xa433a3):(_0x4734f2=(_0x21ac95[_0xa684a4(0x2b3)]-_0x5d123e['left'])*_0x36ad10,_0x186862=(_0x21ac95['clientY']-_0x5d123e[_0xa684a4(0x206)])*_0xa433a3),{'x':_0x4734f2,'y':_0x186862};}function isPointOnImage(_0x2be50d,_0x353a9b){const _0x454f15=_0x4f4f15;if(!sourceImage)return![];const _0x38d3e5=imageScale/0x64;let _0x3d91c7=sourceImage[_0x454f15(0x1dc)]*_0x38d3e5,_0x5b4a85=sourceImage[_0x454f15(0x1d2)]*_0x38d3e5;return imageRotation%0xb4!==0x0&&([_0x3d91c7,_0x5b4a85]=[_0x5b4a85,_0x3d91c7]),_0x2be50d>=imageOffset['x']&&_0x2be50d<=imageOffset['x']+_0x3d91c7&&_0x353a9b>=imageOffset['y']&&_0x353a9b<=imageOffset['y']+_0x5b4a85;}function startDrawing(_0x4a33a8){const _0x31a6c1=getCanvasCoordinates(canvas,_0x4a33a8);startDrawingCommon(_0x31a6c1);}function startDrawingFloat(_0x367d32){const _0x2543ed=getCanvasCoordinates(floatCanvas,_0x367d32);startDrawingCommon(_0x2543ed);}function handleTouchStart(_0x5ed624){const _0xc78eb8=_0x4f4f15;_0x5ed624[_0xc78eb8(0x1e0)]();if(_0x5ed624[_0xc78eb8(0x28c)][_0xc78eb8(0x2a5)]!==0x1)return;const _0x28b32e=getCanvasCoordinates(canvas,_0x5ed624,!![]);startDrawingCommon(_0x28b32e);}function handleFloatTouchStart(_0x45b63d){const _0x110eec=_0x4f4f15;_0x45b63d[_0x110eec(0x1e0)]();if(_0x45b63d[_0x110eec(0x28c)][_0x110eec(0x2a5)]!==0x1)return;const _0x3d5690=getCanvasCoordinates(floatCanvas,_0x45b63d,!![]);startDrawingCommon(_0x3d5690);}function startDrawingCommon(_0x37193a){const _0x7866e2=_0x4f4f15;lastX=_0x37193a['x'],lastY=_0x37193a['y'],isDrawing=!![];if(!isDrawingModeActive&&sourceImage&&(isPointOnImage(_0x37193a['x'],_0x37193a['y'])&&currentTool!=='text'))isDraggingImage=!![],dragStartPos={'x':_0x37193a['x'],'y':_0x37193a['y']},isDrawing=![],canvas[_0x7866e2(0x24b)][_0x7866e2(0x1b1)]='move',floatCanvas[_0x7866e2(0x24b)][_0x7866e2(0x1b1)]='move';else currentTool===_0x7866e2(0x1a7)&&(addTextToCanvas(_0x37193a['x'],_0x37193a['y']),isDrawing=![]);}function draw(_0x25e654){const _0x585198=getCanvasCoordinates(canvas,_0x25e654);drawCommon(_0x585198);}function drawFloat(_0x3de110){const _0x27fd1e=getCanvasCoordinates(floatCanvas,_0x3de110);drawCommon(_0x27fd1e);}function handleTouchMove(_0xa9401b){const _0x17174e=_0x4f4f15;_0xa9401b[_0x17174e(0x1e0)]();if(_0xa9401b[_0x17174e(0x28c)][_0x17174e(0x2a5)]!==0x1)return;const _0x4d1f1c=getCanvasCoordinates(canvas,_0xa9401b,!![]);drawCommon(_0x4d1f1c);}function handleFloatTouchMove(_0x1c4d06){const _0x32b294=_0x4f4f15;_0x1c4d06[_0x32b294(0x1e0)]();if(_0x1c4d06[_0x32b294(0x28c)]['length']!==0x1)return;const _0xf8f4a0=getCanvasCoordinates(floatCanvas,_0x1c4d06,!![]);drawCommon(_0xf8f4a0);}function drawCommon(_0x43bb32){if(isDraggingImage&&!isDrawingModeActive){const _0xee6008=_0x43bb32['x']-dragStartPos['x'],_0x50e4e9=_0x43bb32['y']-dragStartPos['y'];imageOffset['x']+=_0xee6008,imageOffset['y']+=_0x50e4e9,dragStartPos=_0x43bb32,redrawImageWithScaleAndOffset();return;}if(!isDrawing)return;drawOnCanvas(lastX,lastY,_0x43bb32['x'],_0x43bb32['y']),lastX=_0x43bb32['x'],lastY=_0x43bb32['y'],syncCanvases();}function stopDrawing(){isDrawing=![],isDraggingImage&&(isDraggingImage=![],updateCursorStyle());}function handleTouchEnd(){stopDrawing();}function drawOnCanvas(_0x1cf131,_0x4ac144,_0x19cf5e,_0xf49e32){const _0x2f346e=_0x4f4f15;ctx[_0x2f346e(0x225)](),ctx['lineCap']=_0x2f346e(0x27f),ctx['lineJoin']='round',ctx[_0x2f346e(0x268)]=brushSize;if(currentTool===_0x2f346e(0x1b4))ctx[_0x2f346e(0x2cd)]=brushColor;else currentTool===_0x2f346e(0x270)&&(ctx[_0x2f346e(0x2cd)]='#FFFFFF',ctx['lineWidth']=brushSize*0x2);ctx['beginPath'](),ctx[_0x2f346e(0x1f7)](_0x1cf131,_0x4ac144),ctx['lineTo'](_0x19cf5e,_0xf49e32),ctx['stroke'](),ctx[_0x2f346e(0x230)]();}function addTextToCanvas(_0x1a8f1a,_0x4a7bfe){const _0x422f68=_0x4f4f15,_0x2c0b20=textInput['value']||_0x422f68(0x1b8),_0x79437f=parseInt(fontSizeInput['value']),_0x78a916=fontFamilySelect[_0x422f68(0x1e4)];if(!_0x2c0b20['trim']())return;ctx[_0x422f68(0x225)](),ctx[_0x422f68(0x2b0)]=_0x79437f+_0x422f68(0x207)+_0x78a916,ctx['fillStyle']=brushColor,ctx[_0x422f68(0x21b)]=_0x422f68(0x206),ctx['fillText'](_0x2c0b20,_0x1a8f1a,_0x4a7bfe),ctx[_0x422f68(0x230)](),syncCanvases(),addLog(_0x422f68(0x271)+_0x2c0b20+'\x22');}function addTextManually(){const _0x27ec0f=_0x4f4f15;setDrawingTool(_0x27ec0f(0x1a7));if(textInput[_0x27ec0f(0x1e4)][_0x27ec0f(0x2ae)]()){const _0x514a8b=getSelectedCanvasSize(),_0x5abed1=_0x514a8b[_0x27ec0f(0x1dc)]/0x2,_0x5861f8=_0x514a8b['height']/0x2;addTextToCanvas(_0x5abed1,_0x5861f8);}else addLog(_0x27ec0f(0x1ee));}function clearCanvas(){const _0x81c77e=_0x4f4f15;confirm(_0x81c77e(0x2cf))&&(ctx[_0x81c77e(0x225)](),ctx['fillStyle']=_0x81c77e(0x24c),ctx[_0x81c77e(0x219)](0x0,0x0,canvas[_0x81c77e(0x1dc)],canvas[_0x81c77e(0x1d2)]),ctx[_0x81c77e(0x230)](),syncCanvases(),addLog(_0x81c77e(0x243)));}function syncCanvases(){const _0x2ae9c9=_0x4f4f15;floatCtx[_0x2ae9c9(0x1fe)](0x0,0x0,floatCanvas['width'],floatCanvas[_0x2ae9c9(0x1d2)]),floatCtx[_0x2ae9c9(0x2ce)](canvas,0x0,0x0);}function changeImageScale(_0x4f1828){const _0x5405b1=_0x4f4f15;if(!sourceImage)return;imageScale=Math[_0x5405b1(0x2e1)](0x0,Math['min'](0x3e8,imageScale+_0x4f1828)),imageScaleSlider[_0x5405b1(0x1e4)]=imageScale,updateImageScale();}function updateImageScale(){const _0x70381e=_0x4f4f15;if(!sourceImage)return;imageScale=parseInt(imageScaleSlider[_0x70381e(0x1e4)]),imageScaleValue['textContent']=imageScale+'%',redrawImageWithScaleAndOffset();}function redrawImageWithScaleAndOffset(){const _0x442326=_0x4f4f15;if(!sourceImage)return;ctx[_0x442326(0x20b)]='#FFFFFF',ctx[_0x442326(0x219)](0x0,0x0,canvas[_0x442326(0x1dc)],canvas[_0x442326(0x1d2)]);const _0x2acdfd=imageScale/0x64;let _0x5e8b44=sourceImage[_0x442326(0x1dc)]*_0x2acdfd,_0x1372ab=sourceImage['height']*_0x2acdfd;ctx['save'](),ctx[_0x442326(0x242)](imageOffset['x']+_0x5e8b44/0x2,imageOffset['y']+_0x1372ab/0x2),ctx[_0x442326(0x25b)](imageRotation*Math['PI']/0xb4),ctx['drawImage'](sourceImage,-_0x5e8b44/0x2,-_0x1372ab/0x2,_0x5e8b44,_0x1372ab),ctx['restore'](),syncCanvases();}function fitImageToCanvas(){const _0x356c67=_0x4f4f15;if(!sourceImage)return;const _0x526c1a=getSelectedCanvasSize();let _0x5c9927=_0x526c1a[_0x356c67(0x1dc)],_0x588e36=_0x526c1a[_0x356c67(0x1d2)];const _0x2408c1=_0x5c9927/sourceImage['width'],_0x33e934=_0x588e36/sourceImage[_0x356c67(0x1d2)],_0x2b6dd0=Math[_0x356c67(0x20e)](_0x2408c1,_0x33e934);imageScale=_0x2b6dd0*0x64,imageScaleSlider[_0x356c67(0x1e4)]=imageScale,imageScaleValue[_0x356c67(0x2c9)]=imageScale[_0x356c67(0x297)](0x0)+'%',imageOffset['x']=_0x5c9927-sourceImage[_0x356c67(0x1dc)]*_0x2b6dd0,imageOffset['y']=_0x588e36-sourceImage['height']*_0x2b6dd0,redrawImageWithScaleAndOffset(),addLog(_0x356c67(0x1fa));}function _0x4d08(_0x118a68,_0x377c0d){const _0x3f6ab4=_0x3f6a();return _0x4d08=function(_0x4d08ac,_0x5c8fa7){_0x4d08ac=_0x4d08ac-0x1a5;let _0x160845=_0x3f6ab4[_0x4d08ac];return _0x160845;},_0x4d08(_0x118a68,_0x377c0d);}function fillCanvas(){const _0x259964=_0x4f4f15;if(!sourceImage)return;const _0x228ffa=getSelectedCanvasSize();let _0x4f03a0=_0x228ffa['width'],_0x23cc61=_0x228ffa[_0x259964(0x1d2)];const _0x3a87af=_0x4f03a0/sourceImage['width'],_0x3ff766=_0x23cc61/sourceImage[_0x259964(0x1d2)];imageScale=Math['max'](_0x3a87af,_0x3ff766)*0x64,imageScaleSlider[_0x259964(0x1e4)]=imageScale,imageScaleValue[_0x259964(0x2c9)]=imageScale[_0x259964(0x297)](0x0)+'%',imageOffset['x']=0x0,imageOffset['y']=0x0,redrawImageWithScaleAndOffset(),addLog(_0x259964(0x25e));}function centerImageOnCanvas(){const _0x1f26ba=_0x4f4f15;if(!sourceImage)return;const _0x505d74=getSelectedCanvasSize();let _0x3f91c4=_0x505d74['width'],_0x3716e3=_0x505d74[_0x1f26ba(0x1d2)];const _0x90a48e=imageScale/0x64;let _0x266917=sourceImage[_0x1f26ba(0x1dc)]*_0x90a48e,_0x4477b8=sourceImage[_0x1f26ba(0x1d2)]*_0x90a48e;imageOffset['x']=(_0x3f91c4-_0x266917)/0x2,imageOffset['y']=(_0x3716e3-_0x4477b8)/0x2,redrawImageWithScaleAndOffset(),addLog(_0x1f26ba(0x2c7));}function rotateImage(_0x5b8673){const _0x1f8238=_0x4f4f15;if(!sourceImage){addLog(_0x1f8238(0x291));return;}imageRotation=(imageRotation+_0x5b8673)%0x168,redrawImageWithScaleAndOffset(),addLog(_0x1f8238(0x2c3)+imageRotation+'°');}function resizeImage(_0x22e236,_0x35e3f4){const _0x33d96f=_0x4f4f15;if(!sourceImage||!originalImage)return;const _0x44f531=originalImage[_0x33d96f(0x1dc)]/originalImage[_0x33d96f(0x1d2)];let _0x3076a9=sourceImage[_0x33d96f(0x1dc)]+_0x22e236,_0xf48dba=sourceImage[_0x33d96f(0x1d2)]+_0x35e3f4;_0x3076a9=Math[_0x33d96f(0x2e1)](0x32,_0x3076a9),_0xf48dba=Math[_0x33d96f(0x2e1)](0x32,_0xf48dba),imageWidthInput[_0x33d96f(0x1e4)]=Math[_0x33d96f(0x27f)](_0x3076a9),imageHeightInput['value']=Math[_0x33d96f(0x27f)](_0xf48dba);const _0x367ad8=new Image();_0x367ad8[_0x33d96f(0x23e)]=function(){sourceImage=_0x367ad8,redrawImageWithScaleAndOffset(),addLog('图片尺寸已调整为:\x20'+_0x3076a9+'\x20×\x20'+_0xf48dba);};const _0x53a2f6=document['createElement'](_0x33d96f(0x2b4));_0x53a2f6[_0x33d96f(0x1dc)]=_0x3076a9,_0x53a2f6[_0x33d96f(0x1d2)]=_0xf48dba;const _0x182422=_0x53a2f6[_0x33d96f(0x25a)]('2d');_0x182422[_0x33d96f(0x2ce)](originalImage,0x0,0x0,_0x3076a9,_0xf48dba),_0x367ad8['src']=_0x53a2f6[_0x33d96f(0x279)]();}function applyImageDimensions(){const _0x34af12=_0x4f4f15,_0x416434=parseInt(imageWidthInput['value']),_0x4cdf1d=parseInt(imageHeightInput['value']);if(isNaN(_0x416434)||isNaN(_0x4cdf1d)||_0x416434<0x32||_0x4cdf1d<0x32){addLog('请输入有效的尺寸（最小50x50像素）');return;}if(originalImage){const _0x226fcf=new Image();_0x226fcf[_0x34af12(0x23e)]=function(){const _0x5ddd57=_0x34af12;sourceImage=_0x226fcf,fitImageToCanvas(),addLog(_0x5ddd57(0x1b2)+_0x416434+_0x5ddd57(0x204)+_0x4cdf1d);};const _0x57321c=document[_0x34af12(0x1f9)](_0x34af12(0x2b4));_0x57321c[_0x34af12(0x1dc)]=_0x416434,_0x57321c[_0x34af12(0x1d2)]=_0x4cdf1d;const _0x1516ee=_0x57321c[_0x34af12(0x25a)]('2d');_0x1516ee['drawImage'](originalImage,0x0,0x0,_0x416434,_0x4cdf1d),_0x226fcf[_0x34af12(0x26b)]=_0x57321c[_0x34af12(0x279)]();}else addLog('图像尺寸已设置为:\x20'+_0x416434+_0x34af12(0x204)+_0x4cdf1d);}function handleImageUpload(_0x303a25){const _0x1c18ad=_0x4f4f15,_0x212412=_0x303a25[_0x1c18ad(0x266)][_0x1c18ad(0x260)][0x0];if(!_0x212412)return;document['getElementById']('fileInfo')['textContent']=_0x1c18ad(0x228)+_0x212412['name']+'\x20('+formatFileSize(_0x212412[_0x1c18ad(0x254)])+')',document[_0x1c18ad(0x1f1)]('fileInfo')[_0x1c18ad(0x1e6)][_0x1c18ad(0x1e5)](_0x1c18ad(0x1ad));const _0x8557a2=new FileReader();_0x8557a2[_0x1c18ad(0x23e)]=function(_0x443c72){const _0x4552f4=_0x1c18ad,_0x13d2cd=new Image();_0x13d2cd[_0x4552f4(0x23e)]=function(){const _0x5a6a19=_0x4552f4;originalImage=new Image(),originalImage[_0x5a6a19(0x26b)]=_0x13d2cd['src'],sourceImage=new Image(),sourceImage['src']=_0x13d2cd[_0x5a6a19(0x26b)],imageRotation=0x0,imageWidthInput[_0x5a6a19(0x1e4)]=_0x13d2cd[_0x5a6a19(0x1dc)],imageHeightInput['value']=_0x13d2cd[_0x5a6a19(0x1d2)],fitImageToCanvas(),centerImageOnCanvas(),saveOriginalCanvasState(),addLog(_0x5a6a19(0x227)+_0x212412[_0x5a6a19(0x2ad)]),addLog('图片原始尺寸:\x20'+_0x13d2cd[_0x5a6a19(0x1dc)]+_0x5a6a19(0x204)+_0x13d2cd[_0x5a6a19(0x1d2)]),addLog(_0x5a6a19(0x28e)),updateCanvasVisibility();},_0x13d2cd[_0x4552f4(0x26b)]=_0x443c72[_0x4552f4(0x266)][_0x4552f4(0x2b8)];},_0x8557a2['readAsDataURL'](_0x212412);}function saveOriginalCanvasState(){const _0x879b7=_0x4f4f15,_0x58e545=getSelectedCanvasSize();originalCanvasData=ctx[_0x879b7(0x267)](0x0,0x0,_0x58e545[_0x879b7(0x1dc)],_0x58e545[_0x879b7(0x1d2)]);}function clearLog(){const _0xbaf220=_0x4f4f15;logContainer['innerHTML']=_0xbaf220(0x249),addLog(_0xbaf220(0x293));}function preConnect(){const _0x1261b3=_0x4f4f15;if(gattServer!=null&&gattServer[_0x1261b3(0x1ea)])bleDevice!=null&&bleDevice[_0x1261b3(0x2b6)][_0x1261b3(0x1ea)]&&(addLog('正在断开与\x20'+(bleDevice[_0x1261b3(0x2ad)]||_0x1261b3(0x1f6))+'\x20的连接...'),bleDevice[_0x1261b3(0x2b6)][_0x1261b3(0x2b7)]());else{resetBluetoothVariables();try{navigator['bluetooth'][_0x1261b3(0x2bb)]({'filters':[{'namePrefix':_0x1261b3(0x21f)}],'optionalServices':[_0x1261b3(0x2d5)]})[_0x1261b3(0x1c1)](_0x4e51e2=>{const _0x5e99d0=_0x1261b3;addLog(_0x5e99d0(0x29c)+(_0x4e51e2['name']||_0x5e99d0(0x290))),bleDevice=_0x4e51e2,bleDevice['addEventListener']('gattserverdisconnected',disconnect),setTimeout(()=>connect(),0x12c);})['catch'](_0x52b782=>{const _0x34d7fc=_0x1261b3;addLog(_0x34d7fc(0x2af)+_0x52b782[_0x34d7fc(0x1e8)]),_0x52b782['name']===_0x34d7fc(0x2d9)&&addLog(_0x34d7fc(0x233));});}catch(_0x534645){addLog(_0x1261b3(0x258)+_0x534645[_0x1261b3(0x1e8)]),addLog('请检查蓝牙是否已开启并授予权限');}}}async function connect(){const _0x54f932=_0x4f4f15;if(!bleDevice){addLog(_0x54f932(0x265));return;}if(epdCharacteristic){addLog(_0x54f932(0x1ff));return;}try{addLog(_0x54f932(0x2e0)+(bleDevice[_0x54f932(0x2ad)]||_0x54f932(0x290))),gattServer=await bleDevice['gatt']['connect'](),epdService=await gattServer[_0x54f932(0x2c1)]('32120001-0bf6-448a-9608-1b01a1a8f75c'),epdCharacteristic=await epdService[_0x54f932(0x29e)](_0x54f932(0x25d)),addLog('已成功连接到设备！'),await epdCharacteristic[_0x54f932(0x288)](),epdCharacteristic['addEventListener']('characteristicvaluechanged',_0xff2634=>{const _0x19d374=_0x54f932;handleNotify(_0xff2634['target'][_0x19d374(0x1e4)]);}),await write(0xa9),document['getElementById'](_0x54f932(0x1ef))[_0x54f932(0x2ba)]=_0x54f932(0x1aa),updateButtonStatus();}catch(_0x12fcf7){addLog(_0x54f932(0x223)+_0x12fcf7[_0x54f932(0x1e8)]),disconnect();}}function disconnect(){const _0x4677b0=_0x4f4f15;bleDevice&&bleDevice['gatt'][_0x4677b0(0x1ea)]&&bleDevice[_0x4677b0(0x2b6)][_0x4677b0(0x2b7)](),resetBluetoothVariables(),addLog(_0x4677b0(0x1be)),document[_0x4677b0(0x1f1)](_0x4677b0(0x1ef))[_0x4677b0(0x2ba)]=_0x4677b0(0x1fc),updateButtonStatus();}function resetBluetoothVariables(){gattServer=null,epdService=null,epdCharacteristic=null,msgIndex=0x0;}async function write(_0x543339,_0x32bec5,_0x456244=!![]){const _0x1c2aed=_0x4f4f15;if(!epdCharacteristic)return addLog('未连接蓝牙设备'),![];let _0x5e4c8c=[_0x543339];if(_0x32bec5){if(typeof _0x32bec5==_0x1c2aed(0x2bf))_0x32bec5=hex2bytes(_0x32bec5);if(_0x32bec5 instanceof Uint8Array)_0x32bec5=Array[_0x1c2aed(0x2da)](_0x32bec5);_0x5e4c8c[_0x1c2aed(0x2d6)](..._0x32bec5);}try{if(_0x456244)await epdCharacteristic['writeValueWithResponse'](Uint8Array[_0x1c2aed(0x2da)](_0x5e4c8c));else await epdCharacteristic[_0x1c2aed(0x1cf)](Uint8Array[_0x1c2aed(0x2da)](_0x5e4c8c));}catch(_0x56e1da){return addLog(_0x1c2aed(0x2db)+_0x56e1da[_0x1c2aed(0x1e8)]),![];}return!![];}async function writeImage(_0x500a2b,_0x20adfe='bw'){const _0x149bc4=_0x4f4f15,_0x35c660=document['getElementById'](_0x149bc4(0x2d4))[_0x149bc4(0x1e4)]-0x2,_0x48b035=document[_0x149bc4(0x1f1)](_0x149bc4(0x2a6))[_0x149bc4(0x1e4)],_0x4a212d=Math[_0x149bc4(0x1c7)](_0x500a2b[_0x149bc4(0x2a5)]/_0x35c660);let _0x5b9252=0x0,_0x150608=_0x48b035;const _0x2d6749=getSelectedCanvasSize();for(let _0x1c31b2=0x0;_0x1c31b2<_0x500a2b['length'];_0x1c31b2+=_0x35c660){let _0x2a8390=(new Date()[_0x149bc4(0x1c8)]()-startTime)/0x3e8;addLog((_0x20adfe=='bw'?'黑白':'红色')+_0x149bc4(0x1bf)+(_0x5b9252+0x1)+'/'+_0x4a212d+_0x149bc4(0x262)+_0x2a8390['toFixed'](0x1)+'s');const _0x346fc5=[(_0x20adfe=='bw'?0xf:0x0)|(_0x1c31b2==0x0?0x0:0xf0),..._0x500a2b['slice'](_0x1c31b2,_0x1c31b2+_0x35c660)];_0x150608>0x0?(await write(0xa1,_0x346fc5,![]),_0x150608--):(await write(0xa1,_0x346fc5,!![]),_0x150608=_0x48b035),_0x5b9252++;}}function downloadImageFile(){const _0x5a8c0d=_0x4f4f15;if(!checkCanvasHasContent(canvas)){addLog('请先上传或绘制图像并处理后再下载');return;}const _0x2a73e2=getSelectedCanvasSize(),{width:_0x41077e,height:_0x205a63}=getEffectiveCanvasSize(_0x2a73e2),_0xff7556=getRotatedImageData(canvas,_0x2a73e2,imageRotation),_0x3fd130=ditherMode[_0x5a8c0d(0x1e4)],_0x31af19=processImageData(_0xff7556,_0x3fd130,_0x41077e,_0x205a63),_0x214a55=_0x31af19[_0x5a8c0d(0x2a5)],_0x8e2b13=(_0x214a55/0x400)[_0x5a8c0d(0x297)](0x2),_0xd7d45b=_0x41077e*_0x205a63,_0x3e951c=_0x31af19[_0x5a8c0d(0x23a)](_0x25087d=>_0x25087d[_0x5a8c0d(0x28d)](0x10)[_0x5a8c0d(0x2df)](0x2,'0'))[_0x5a8c0d(0x1e9)]('\x20'),_0xf6711f=new Blob([_0x3e951c],{'type':_0x5a8c0d(0x1cb)}),_0x13fa1f=URL[_0x5a8c0d(0x1b3)](_0xf6711f),_0x149830=document[_0x5a8c0d(0x1f9)]('a');_0x149830[_0x5a8c0d(0x2dc)]=_0x13fa1f,_0x149830[_0x5a8c0d(0x1ab)]=_0x5a8c0d(0x2be)+new Date()[_0x5a8c0d(0x1c8)]()+_0x5a8c0d(0x245),document['body'][_0x5a8c0d(0x1c0)](_0x149830),_0x149830[_0x5a8c0d(0x1c3)](),setTimeout(()=>{const _0x489548=_0x5a8c0d;document[_0x489548(0x1c9)][_0x489548(0x224)](_0x149830),URL['revokeObjectURL'](_0x13fa1f);},0x0),addLog(_0x5a8c0d(0x226)+_0x214a55+_0x5a8c0d(0x1de)+_0x8e2b13+_0x5a8c0d(0x241)+_0xd7d45b);}function showTimeDialog(){const _0x585c9a=_0x4f4f15;if(!epdCharacteristic){addLog(_0x585c9a(0x27d));return;}const _0x2dac45=new Date(),_0x34ec61=new Date(_0x2dac45[_0x585c9a(0x1c8)]()-_0x2dac45[_0x585c9a(0x1f5)]()*0xea60)[_0x585c9a(0x203)]()['slice'](0x0,0x10);datetimeInput[_0x585c9a(0x1e4)]=_0x34ec61,timeDialog['classList'][_0x585c9a(0x1e5)]('hidden');}function hideTimeDialog(){const _0x3c3008=_0x4f4f15;timeDialog[_0x3c3008(0x1e6)][_0x3c3008(0x2a8)](_0x3c3008(0x1ad));}async function setTime(){const _0x2ab43a=_0x4f4f15;if(!epdCharacteristic){addLog(_0x2ab43a(0x27d)),hideTimeDialog();return;}const _0x3b432d=datetimeInput[_0x2ab43a(0x1e4)];if(!_0x3b432d){addLog(_0x2ab43a(0x298));return;}const _0x5b4243=new Date(_0x3b432d),_0x53418d=Math['floor'](_0x5b4243['getTime']()/0x3e8),_0x5850f9=[_0x53418d>>0x18&0xff,_0x53418d>>0x10&0xff,_0x53418d>>0x8&0xff,_0x53418d&0xff];try{setStatus(_0x2ab43a(0x2a3)),statusContainer[_0x2ab43a(0x24b)][_0x2ab43a(0x27a)]=_0x2ab43a(0x1c2),await write(0xa3,_0x5850f9),addLog('已设置时间:\x20'+_0x5b4243['toLocaleString']()),addLog(_0x2ab43a(0x21d)+_0x53418d+_0x2ab43a(0x22c)+_0x53418d['toString'](0x10)['toUpperCase']()+')'),setTimeout(()=>{const _0x5d4bd2=_0x2ab43a;statusContainer[_0x5d4bd2(0x24b)]['display']='none';},0x7d0);}catch(_0x1132e8){addLog(_0x2ab43a(0x276)+_0x1132e8[_0x2ab43a(0x1e8)]);}finally{hideTimeDialog();}}async function setClockMode(){const _0x4870b2=_0x4f4f15;if(!epdCharacteristic){addLog(_0x4870b2(0x27d));return;}try{setStatus('正在切换到时钟模式...'),statusContainer[_0x4870b2(0x24b)][_0x4870b2(0x27a)]=_0x4870b2(0x1c2),await write(0xae,[0x1]),currentMode=_0x4870b2(0x1fd),addLog(_0x4870b2(0x1a5)),setTimeout(()=>{const _0x57b9e9=_0x4870b2;statusContainer[_0x57b9e9(0x24b)][_0x57b9e9(0x27a)]='none';},0x7d0);}catch(_0x321ae5){addLog(_0x4870b2(0x285)+_0x321ae5[_0x4870b2(0x1e8)]);}}async function setCalendarMode(){const _0x34efbe=_0x4f4f15;if(!epdCharacteristic){addLog('请先连接蓝牙设备！');return;}try{setStatus(_0x34efbe(0x1d6)),statusContainer['style'][_0x34efbe(0x27a)]=_0x34efbe(0x1c2),await write(0xae,[0x2]),currentMode=_0x34efbe(0x1e7),addLog(_0x34efbe(0x1e3)),setTimeout(()=>{const _0x1d4af1=_0x34efbe;statusContainer[_0x1d4af1(0x24b)][_0x1d4af1(0x27a)]=_0x1d4af1(0x2a7);},0x7d0);}catch(_0x4d29ef){addLog(_0x34efbe(0x285)+_0x4d29ef[_0x34efbe(0x1e8)]);}}async function clearScreen(){const _0x1442ce=_0x4f4f15;if(!epdCharacteristic){addLog(_0x1442ce(0x27d));return;}if(!confirm(_0x1442ce(0x2cc)))return;try{setStatus(_0x1442ce(0x239)),statusContainer[_0x1442ce(0x24b)]['display']=_0x1442ce(0x1c2),await write(0xa8),await write(0xa5),addLog(_0x1442ce(0x20d)),setTimeout(()=>{const _0x42bbdc=_0x1442ce;statusContainer[_0x42bbdc(0x24b)][_0x42bbdc(0x27a)]=_0x42bbdc(0x2a7);},0x7d0);}catch(_0x28caa7){addLog(_0x1442ce(0x29b)+_0x28caa7['message']);}}function getEffectiveCanvasSize(_0x423167){const _0x12ba07=_0x4f4f15;let _0x5e4864=_0x423167['width'],_0x2274f4=_0x423167[_0x12ba07(0x1d2)];return imageRotation%0xb4!==0x0&&([_0x5e4864,_0x2274f4]=[_0x2274f4,_0x5e4864]),{'width':_0x5e4864,'height':_0x2274f4};}function getRotatedImageData(_0x399edd,_0x2afcba,_0x57d0ee){const _0xbc16ef=_0x4f4f15,_0x71c088=document[_0xbc16ef(0x1f9)](_0xbc16ef(0x2b4)),_0x476dc2=_0x71c088[_0xbc16ef(0x25a)]('2d'),{width:_0x2ef3b5,height:_0x33026b}=getEffectiveCanvasSize(_0x2afcba);_0x71c088[_0xbc16ef(0x1dc)]=_0x2ef3b5,_0x71c088[_0xbc16ef(0x1d2)]=_0x33026b,_0x476dc2[_0xbc16ef(0x225)]();if(_0x57d0ee===0x5a)_0x476dc2[_0xbc16ef(0x242)](_0x2ef3b5,0x0),_0x476dc2['rotate'](Math['PI']/0x2);else{if(_0x57d0ee===0xb4)_0x476dc2[_0xbc16ef(0x242)](_0x2ef3b5,_0x33026b),_0x476dc2[_0xbc16ef(0x25b)](Math['PI']);else _0x57d0ee===0x10e&&(_0x476dc2['translate'](0x0,_0x33026b),_0x476dc2[_0xbc16ef(0x25b)](0x3*Math['PI']/0x2));}return _0x476dc2['drawImage'](_0x399edd,0x0,0x0),_0x476dc2[_0xbc16ef(0x230)](),_0x476dc2[_0xbc16ef(0x267)](0x0,0x0,_0x2ef3b5,_0x33026b);}function getDitherAlgorithmName(_0x5a5c54){const _0x4790e6=_0x4f4f15,_0x121162={'floydSteinberg':_0x4790e6(0x217),'atkinson':'Atkinson','bayer':'Bayer','stucki':'Stucki','jarvis':_0x4790e6(0x29d)};return _0x121162[_0x5a5c54]||_0x5a5c54;}function setDitherMode(_0x140448){const _0x34f221=_0x4f4f15;ditherMode[_0x34f221(0x1e4)]=_0x140448,addLog(_0x34f221(0x205)+(_0x140448===_0x34f221(0x1d0)?'黑白':_0x34f221(0x286))+'模式');}function onDitherAlgChange(_0x438385){const _0x1cca54=_0x4f4f15;currentParams[_0x1cca54(0x2b9)]=_0x438385[_0x1cca54(0x266)][_0x1cca54(0x1e4)],addLog('已选择'+getDitherAlgorithmName(currentParams[_0x1cca54(0x2b9)])+_0x1cca54(0x289));}function getSelectedCanvasSize(){const _0x16f1e3=_0x4f4f15,_0x50c34a=document[_0x16f1e3(0x1f1)](_0x16f1e3(0x238))[_0x16f1e3(0x1e4)];return canvasSizes[_0x16f1e3(0x1d1)](_0x4de2f6=>_0x4de2f6[_0x16f1e3(0x2ad)]===_0x50c34a)||canvasSizes[0x1];}let originalImageData=null;function updateCanvasSize(_0x488590=![]){const _0x373588=_0x4f4f15,_0x1b6060=getSelectedCanvasSize(),_0x29d29f=checkCanvasHasContent(canvas);imageWidthInput[_0x373588(0x1e4)]=_0x1b6060['width'],imageHeightInput[_0x373588(0x1e4)]=_0x1b6060['height'],canvas['width']=_0x1b6060[_0x373588(0x1dc)],canvas[_0x373588(0x1d2)]=_0x1b6060[_0x373588(0x1d2)],floatCanvas[_0x373588(0x1dc)]=_0x1b6060[_0x373588(0x1dc)],floatCanvas[_0x373588(0x1d2)]=_0x1b6060[_0x373588(0x1d2)],_0x488590&&_0x29d29f?originalCanvasData&&ctx[_0x373588(0x1f0)](originalCanvasData,0x0,0x0):(ctx[_0x373588(0x20b)]='#FFFFFF',ctx[_0x373588(0x219)](0x0,0x0,_0x1b6060[_0x373588(0x1dc)],_0x1b6060[_0x373588(0x1d2)])),syncCanvases(),processedImageInfo[_0x373588(0x2c9)]=_0x1b6060[_0x373588(0x1dc)]+'\x20×\x20'+_0x1b6060[_0x373588(0x1d2)]+'\x20像素',updateCanvasVisibility();}function updateDitcherOptions(){const _0x1c893b=_0x4f4f15,_0x5a4bdd=document[_0x1c893b(0x1f1)](_0x1c893b(0x20f)),_0x2cf6f2=_0x5a4bdd[_0x1c893b(0x2ca)][_0x5a4bdd[_0x1c893b(0x29f)]],_0x987525=_0x2cf6f2[_0x1c893b(0x235)](_0x1c893b(0x20a)),_0x3a7e81=_0x2cf6f2['getAttribute'](_0x1c893b(0x26c));if(_0x987525)ditherMode['value']=_0x987525;if(_0x3a7e81){const _0x347398=canvasSizes[_0x1c893b(0x2d1)](_0x380d30=>_0x380d30['name']===_0x3a7e81);_0x347398&&(document[_0x1c893b(0x1f1)](_0x1c893b(0x238))[_0x1c893b(0x1e4)]=_0x3a7e81);}updateCanvasSize(!![]);}function processImage(){const _0x3b67ca=_0x4f4f15;saveOriginalCanvasState(),addLog(_0x3b67ca(0x287)+getDitherAlgorithmName(currentParams['ditherAlg'])+_0x3b67ca(0x221));const _0x48876d=getSelectedCanvasSize();let _0x35d3b5=ctx[_0x3b67ca(0x267)](0x0,0x0,_0x48876d[_0x3b67ca(0x1dc)],_0x48876d['height']);_0x35d3b5=adjustImageParameters(_0x35d3b5,currentParams);const _0x25e48b=ditherMode['value'];let _0x3b8a8d;const _0x14db2e=window[_0x3b67ca(0x234)](_0x35d3b5,document[_0x3b67ca(0x1f1)](_0x3b67ca(0x237))[_0x3b67ca(0x1e4)],document[_0x3b67ca(0x1f1)](_0x3b67ca(0x1ce))[_0x3b67ca(0x1e4)],document[_0x3b67ca(0x1f1)]('saturation')[_0x3b67ca(0x1e4)],document['getElementById'](_0x3b67ca(0x2d8))['value']/0xa,_0x25e48b,document[_0x3b67ca(0x1f1)](_0x3b67ca(0x2b9))['value']);ctx[_0x3b67ca(0x1f0)](_0x14db2e,0x0,0x0),syncCanvases(),processedImageInfo['textContent']=_0x48876d[_0x3b67ca(0x1dc)]+_0x3b67ca(0x204)+_0x48876d[_0x3b67ca(0x1d2)]+'\x20像素\x20('+(_0x25e48b===_0x3b67ca(0x1d0)?'黑白':'黑白红')+')',addLog(_0x3b67ca(0x256)),updateCanvasVisibility();}async function sendimg(){const _0x30b97d=_0x4f4f15,_0x4a706d=document[_0x30b97d(0x1f1)](_0x30b97d(0x238))[_0x30b97d(0x1e4)],_0x54f881=document['getElementById'](_0x30b97d(0x2b5))[_0x30b97d(0x1e4)],_0xc5645=document[_0x30b97d(0x1f1)](_0x30b97d(0x20f)),_0x145b65=_0xc5645[_0x30b97d(0x2ca)][_0xc5645[_0x30b97d(0x29f)]];startTime=new Date()['getTime']();const _0x129df4=document['getElementById'](_0x30b97d(0x23d));_0x129df4[_0x30b97d(0x1eb)][_0x30b97d(0x24b)]['display']=_0x30b97d(0x1c2);const _0x39f95a=ctx[_0x30b97d(0x267)](0x0,0x0,canvas[_0x30b97d(0x1dc)],canvas['height']),_0x15c6a7=processImageData(_0x39f95a,_0x54f881);updateButtonStatus(!![]);if(_0x54f881==='fourColor')await writeImage(_0x15c6a7,_0x30b97d(0x299));else{if(_0x54f881===_0x30b97d(0x240)){const _0x592238=Math['floor'](_0x15c6a7['length']/0x2);await writeImage(_0x15c6a7[_0x30b97d(0x1bc)](0x0,_0x592238),'bw'),await writeImage(_0x15c6a7['slice'](_0x592238),_0x30b97d(0x257));}else{if(_0x54f881===_0x30b97d(0x1d0))await writeImage(_0x15c6a7,'bw');else{updateButtonStatus();return;}}}await write(0xa8),updateButtonStatus();const _0x489552=(new Date()[_0x30b97d(0x1c8)]()-startTime)/0x3e8;addLog(_0x30b97d(0x1af)+_0x489552+'s'),setTimeout(()=>{const _0x26497b=_0x30b97d;_0x129df4[_0x26497b(0x1eb)]['style'][_0x26497b(0x27a)]=_0x26497b(0x2a7);},0x1388);}function adjustImageParameters(_0x40cc74,_0x4a974d){const _0x16555d=_0x4f4f15,_0x1c0313=_0x40cc74['data'],_0x4c23fa=_0x4a974d['saturation']/0x64,_0x17b215=_0x4a974d[_0x16555d(0x237)]/0x64,_0x1c1a96=_0x4a974d[_0x16555d(0x1ce)]/0x64,_0x34ea5b=_0x4a974d['diffusion']/0x64,_0x51260b=_0x1c1a96!==0x0?0x103*(_0x1c1a96+0xff)/(0xff*(0x103-_0x1c1a96)):0x1,_0x348d3d=new Uint8ClampedArray(_0x1c0313);for(let _0x224426=0x0;_0x224426<_0x1c0313[_0x16555d(0x2a5)];_0x224426+=0x4){let _0x5106af=Math[_0x16555d(0x20e)](0xff,Math['max'](0x0,_0x348d3d[_0x224426]*_0x17b215)),_0x57ad27=Math[_0x16555d(0x20e)](0xff,Math[_0x16555d(0x2e1)](0x0,_0x348d3d[_0x224426+0x1]*_0x17b215)),_0x599018=Math[_0x16555d(0x20e)](0xff,Math[_0x16555d(0x2e1)](0x0,_0x348d3d[_0x224426+0x2]*_0x17b215));_0x5106af=Math[_0x16555d(0x20e)](0xff,Math[_0x16555d(0x2e1)](0x0,_0x51260b*(_0x5106af-0x80)+0x80)),_0x57ad27=Math[_0x16555d(0x20e)](0xff,Math[_0x16555d(0x2e1)](0x0,_0x51260b*(_0x57ad27-0x80)+0x80)),_0x599018=Math['min'](0xff,Math['max'](0x0,_0x51260b*(_0x599018-0x80)+0x80));const _0x4e03e1=0.299*_0x5106af+0.587*_0x57ad27+0.114*_0x599018;_0x5106af=Math['min'](0xff,Math[_0x16555d(0x2e1)](0x0,_0x4e03e1+_0x4c23fa*(_0x5106af-_0x4e03e1))),_0x57ad27=Math[_0x16555d(0x20e)](0xff,Math[_0x16555d(0x2e1)](0x0,_0x4e03e1+_0x4c23fa*(_0x57ad27-_0x4e03e1))),_0x599018=Math['min'](0xff,Math[_0x16555d(0x2e1)](0x0,_0x4e03e1+_0x4c23fa*(_0x599018-_0x4e03e1)));if(_0x34ea5b>0x0){const _0x2e3af4=_0x40cc74[_0x16555d(0x1dc)],_0x1cd548=_0x224426/0x4%_0x2e3af4,_0xeb92f6=Math['floor'](_0x224426/0x4/_0x2e3af4);if(_0x1cd548>0x0&&_0xeb92f6>0x0){const _0x14600d=_0x224426-0x4*(_0x2e3af4+0x1);_0x5106af=Math['floor'](_0x5106af*(0x1-_0x34ea5b)+_0x348d3d[_0x14600d]*_0x34ea5b),_0x57ad27=Math[_0x16555d(0x24e)](_0x57ad27*(0x1-_0x34ea5b)+_0x348d3d[_0x14600d+0x1]*_0x34ea5b),_0x599018=Math[_0x16555d(0x24e)](_0x599018*(0x1-_0x34ea5b)+_0x348d3d[_0x14600d+0x2]*_0x34ea5b);}}_0x1c0313[_0x224426]=_0x5106af,_0x1c0313[_0x224426+0x1]=_0x57ad27,_0x1c0313[_0x224426+0x2]=_0x599018;}return _0x40cc74;}function convertToBlackWhite(_0x1774a5,_0x5ed9eb){const _0xcaf61c=_0x4f4f15,_0x26e94e=_0x1774a5['width'],_0xa0a5e8=_0x1774a5['height'],_0x180dd8=ctx[_0xcaf61c(0x280)](_0x26e94e,_0xa0a5e8);return _0x180dd8[_0xcaf61c(0x259)][_0xcaf61c(0x1b0)](_0x1774a5[_0xcaf61c(0x259)]),applyDitheringAlgorithm(_0x180dd8,0x80,_0x5ed9eb),{'imageData':_0x180dd8};}function convertToBlackWhiteRed(_0x469aa7,_0x4efa31){const _0x179dd3=_0x4f4f15,_0x275aa9=_0x469aa7[_0x179dd3(0x1dc)],_0x223853=_0x469aa7[_0x179dd3(0x1d2)],_0x4b8aac=ctx[_0x179dd3(0x280)](_0x275aa9,_0x223853);_0x4b8aac[_0x179dd3(0x259)][_0x179dd3(0x1b0)](_0x469aa7[_0x179dd3(0x259)]);const _0x510e42=_0x4b8aac[_0x179dd3(0x259)];for(let _0x4e8171=0x0;_0x4e8171<_0x510e42[_0x179dd3(0x2a5)];_0x4e8171+=0x4){const _0x4028e0=_0x510e42[_0x4e8171],_0x3fe612=_0x510e42[_0x4e8171+0x1],_0x47e384=_0x510e42[_0x4e8171+0x2];if(_0x4028e0>0xb4&&_0x3fe612<_0x4028e0*0.6&&_0x47e384<_0x4028e0*0.6)_0x510e42[_0x4e8171+0x3]=0x1;else{const _0x13aca5=0.299*_0x4028e0+0.587*_0x3fe612+0.114*_0x47e384;_0x510e42[_0x4e8171]=_0x13aca5,_0x510e42[_0x4e8171+0x1]=_0x13aca5,_0x510e42[_0x4e8171+0x2]=_0x13aca5,_0x510e42[_0x4e8171+0x3]=0x0;}}applyDitheringAlgorithm(_0x4b8aac,0x64,_0x4efa31,!![]);for(let _0x9dd258=0x0;_0x9dd258<_0x510e42[_0x179dd3(0x2a5)];_0x9dd258+=0x4){if(_0x510e42[_0x9dd258+0x3]===0x1)_0x510e42[_0x9dd258]=0xff,_0x510e42[_0x9dd258+0x1]=0x0,_0x510e42[_0x9dd258+0x2]=0x0;else{const _0x2a5d3d=_0x510e42[_0x9dd258]>0x64?0xff:0x0;_0x510e42[_0x9dd258]=_0x510e42[_0x9dd258+0x1]=_0x510e42[_0x9dd258+0x2]=_0x2a5d3d;}_0x510e42[_0x9dd258+0x3]=0xff;}return{'imageData':_0x4b8aac};}function applyDitheringAlgorithm(_0xffb707,_0x614822,_0x54d62a,_0x23bc48=![]){const _0x30d34b=_0x4f4f15,_0x5f300c=_0xffb707[_0x30d34b(0x259)],_0x2fae9c=_0xffb707[_0x30d34b(0x1dc)],_0x57059e=_0xffb707[_0x30d34b(0x1d2)],_0x565c71=_0x54d62a[_0x30d34b(0x2b9)],_0x122007=_0x54d62a['diffusion']/0x64,_0x215b20=new Uint8ClampedArray(_0x5f300c);for(let _0x3fd947=0x0;_0x3fd947<_0x57059e;_0x3fd947++){for(let _0x26871c=0x0;_0x26871c<_0x2fae9c;_0x26871c++){const _0x57bf8e=(_0x3fd947*_0x2fae9c+_0x26871c)*0x4;if(_0x23bc48&&_0x215b20[_0x57bf8e+0x3]===0x1)continue;const _0x5cfebd=_0x215b20[_0x57bf8e],_0x3b16b9=_0x5cfebd<_0x614822?0x0:0xff,_0x1ec70b=_0x5cfebd-_0x3b16b9,_0x121416=0x1+_0x122007;switch(_0x565c71){case _0x30d34b(0x2c8):propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x7/0x10,0x1,0x0),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x3/0x10,-0x1,0x1),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x5/0x10,0x0,0x1),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x10,0x1,0x1);break;case _0x30d34b(0x247):propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x8,0x1,0x0),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x8,0x2,0x0),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x8,-0x1,0x1),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x8,0x0,0x1),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x8,0x1,0x1),propagateError(_0x215b20,_0x26871c,_0x3fd947,_0x2fae9c,_0x57059e,_0x1ec70b*_0x121416,0x1/0x8,0x0,0x2);break;default:break;}_0x5f300c[_0x57bf8e]=_0x3b16b9,_0x5f300c[_0x57bf8e+0x1]=_0x3b16b9,_0x5f300c[_0x57bf8e+0x2]=_0x3b16b9;}}}function propagateError(_0x1e245b,_0x60efbe,_0x24bd39,_0x4a53d4,_0x584f9d,_0x7b338e,_0x596ee0,_0x4c816c,_0x48551c){const _0x5532f0=_0x4f4f15,_0x352aec=_0x60efbe+_0x4c816c,_0x55d70a=_0x24bd39+_0x48551c;if(_0x352aec>=0x0&&_0x352aec<_0x4a53d4&&_0x55d70a>=0x0&&_0x55d70a<_0x584f9d){const _0x43ac92=(_0x55d70a*_0x4a53d4+_0x352aec)*0x4;_0x1e245b[_0x43ac92]=Math[_0x5532f0(0x2e1)](0x0,Math[_0x5532f0(0x20e)](0xff,_0x1e245b[_0x43ac92]+_0x7b338e*_0x596ee0));}}function processImageData(_0x55f0e3,_0x2f71e2){const _0x5a9430=_0x4f4f15,_0x4b8544=_0x55f0e3[_0x5a9430(0x1dc)],_0x4c9dd1=_0x55f0e3[_0x5a9430(0x1d2)],_0x3d8a63=_0x55f0e3[_0x5a9430(0x259)];let _0x32c795;if(_0x2f71e2===_0x5a9430(0x213)){_0x32c795=new Uint8Array(_0x4b8544*_0x4c9dd1);for(let _0x3b0168=0x0;_0x3b0168<_0x4c9dd1;_0x3b0168++){for(let _0x10d079=0x0;_0x10d079<_0x4b8544;_0x10d079++){const _0x364585=(_0x3b0168*_0x4b8544+_0x10d079)*0x4,_0x1dffd8=_0x3d8a63[_0x364585],_0x589123=_0x3d8a63[_0x364585+0x1],_0x5b633e=_0x3d8a63[_0x364585+0x2],_0x3ef303=findClosestColor(_0x1dffd8,_0x589123,_0x5b633e,_0x2f71e2),_0x3e3840=_0x10d079*_0x4c9dd1+(_0x4c9dd1-0x1-_0x3b0168);_0x32c795[_0x3e3840]=_0x3ef303['value'];}}}else{if(_0x2f71e2==='fourColor'){_0x32c795=new Uint8Array(Math[_0x5a9430(0x1c7)](_0x4b8544*_0x4c9dd1/0x4));for(let _0x3e4aca=0x0;_0x3e4aca<_0x4c9dd1;_0x3e4aca++){for(let _0x1085a3=0x0;_0x1085a3<_0x4b8544;_0x1085a3++){const _0x5a8e62=(_0x3e4aca*_0x4b8544+_0x1085a3)*0x4,_0x202094=_0x3d8a63[_0x5a8e62],_0x1ed200=_0x3d8a63[_0x5a8e62+0x1],_0x24815b=_0x3d8a63[_0x5a8e62+0x2],_0x1c2e82=findClosestColor(_0x202094,_0x1ed200,_0x24815b,_0x2f71e2),_0x18fc04=_0x1c2e82[_0x5a9430(0x1e4)],_0x5a71ad=(_0x3e4aca*_0x4b8544+_0x1085a3)/0x4|0x0,_0x1be6b0=0x6-_0x1085a3%0x4*0x2;_0x32c795[_0x5a71ad]|=_0x18fc04<<_0x1be6b0;}}}else{if(_0x2f71e2===_0x5a9430(0x1d0)){const _0x23606f=Math['ceil'](_0x4b8544/0x8);_0x32c795=new Uint8Array(_0x23606f*_0x4c9dd1);const _0x43713e=0x8c;for(let _0x360035=0x0;_0x360035<_0x4c9dd1;_0x360035++){for(let _0x433d6f=0x0;_0x433d6f<_0x4b8544;_0x433d6f++){const _0x1b0940=(_0x360035*_0x4b8544+_0x433d6f)*0x4,_0x4ea0ba=_0x3d8a63[_0x1b0940],_0x3c4d01=_0x3d8a63[_0x1b0940+0x1],_0x1b9edb=_0x3d8a63[_0x1b0940+0x2],_0x1ef229=Math[_0x5a9430(0x27f)](0.299*_0x4ea0ba+0.587*_0x3c4d01+0.114*_0x1b9edb),_0x33970d=_0x1ef229>=_0x43713e?0x1:0x0,_0x1f38b6=_0x360035*_0x23606f+Math['floor'](_0x433d6f/0x8),_0x4dc475=0x7-_0x433d6f%0x8;_0x32c795[_0x1f38b6]|=_0x33970d<<_0x4dc475;}}}else{if(_0x2f71e2===_0x5a9430(0x240)){const _0x40ef20=Math[_0x5a9430(0x1c7)](_0x4b8544/0x8),_0x2fbd57=0x8c,_0x162d4a=0xa0,_0x26591c=new Uint8Array(_0x4c9dd1*_0x40ef20),_0x5bf278=new Uint8Array(_0x4c9dd1*_0x40ef20);for(let _0x17d65b=0x0;_0x17d65b<_0x4c9dd1;_0x17d65b++){for(let _0x3d6faa=0x0;_0x3d6faa<_0x4b8544;_0x3d6faa++){const _0x413e9f=(_0x17d65b*_0x4b8544+_0x3d6faa)*0x4,_0x334b28=_0x3d8a63[_0x413e9f],_0x25bffa=_0x3d8a63[_0x413e9f+0x1],_0x214ddc=_0x3d8a63[_0x413e9f+0x2],_0x2a1329=Math[_0x5a9430(0x27f)](0.299*_0x334b28+0.587*_0x25bffa+0.114*_0x214ddc),_0x2c1b8a=_0x2a1329>=_0x2fbd57?0x1:0x0,_0x3370e7=_0x17d65b*_0x40ef20+Math[_0x5a9430(0x24e)](_0x3d6faa/0x8),_0x311c51=0x7-_0x3d6faa%0x8;_0x2c1b8a?_0x26591c[_0x3370e7]|=0x1<<_0x311c51:_0x26591c[_0x3370e7]&=~(0x1<<_0x311c51);const _0xff261=_0x334b28>_0x162d4a&&_0x334b28>_0x25bffa&&_0x334b28>_0x214ddc?0x0:0x1,_0x50e76e=_0x17d65b*_0x40ef20+Math[_0x5a9430(0x24e)](_0x3d6faa/0x8),_0xc38fe1=0x7-_0x3d6faa%0x8;_0xff261?_0x5bf278[_0x50e76e]|=0x1<<_0xc38fe1:_0x5bf278[_0x50e76e]&=~(0x1<<_0xc38fe1);}}_0x32c795=new Uint8Array(_0x26591c['length']+_0x5bf278[_0x5a9430(0x2a5)]),_0x32c795[_0x5a9430(0x1b0)](_0x26591c,0x0),_0x32c795['set'](_0x5bf278,_0x26591c[_0x5a9430(0x2a5)]);}}}}return _0x32c795;}function _0x3f6a(){const _0x4477ca=['blackWhiteColor','find','height','fanxian','已退出绘画模式，图片可以移动','forEach','正在切换到日历模式...','sqrt','btnClearLog','8imXHyo','dither-strength','keys','width','btnProcess','\x20字节\x20(','customColor','preventDefault','已重置处理效果，保留原始图片和设置','欢迎使用墨水屏蓝牙图片工具！','已切换到日历模式','value','remove','classList','calendar','message','join','connected','parentElement','Shift','addEventListener','请先输入要添加的文字','connectbutton','putImageData','getElementById','jieqi_color','color_1','innerWidth','getTimezoneOffset','未知设备','moveTo','crosshair','createElement','图片已适应画布大小','opacity-50','<i\x20class=\x22fa\x20fa-plug\x20mr-1\x22></i>连接','clock','clearRect','已经连接到设备，无需重复连接','imageScale','saturationValue','678IfIkMX','toISOString','\x20×\x20','已选择','top','px\x20','已选择画笔颜色:\x20','J_S_start','data-color','fillStyle','mouseout','已清空墨水屏显示内容','min','epddriver','imageFile','btnBlackWhite','imageScaleValue','sixColor','key','url(\x22data:image/svg+xml,%3Csvg\x20xmlns=\x27http://www.w3.org/2000/svg\x27\x20width=\x2724\x27\x20height=\x2724\x27\x20viewBox=\x270\x200\x2024\x2024\x27\x20fill=\x27none\x27\x20stroke=\x27black\x27\x20stroke-width=\x272\x27\x20stroke-linecap=\x27round\x27\x20stroke-linejoin=\x27round\x27%3E%3Cpath\x20d=\x27M18\x2013L5\x205\x27/%3E%3C/svg%3E\x22)\x200\x2024,\x20auto','pow','Floyd-Steinberg','2.13_122_250','fillRect','getBoundingClientRect','textBaseline','已隐藏浮动画布','时间戳:\x20','confirmTimeBtn','NRF_','div:first-child','算法...','N_Z_hour','连接过程出错:\x20','removeChild','save','图像文本文件已下载\x20-\x20数据量:\x20','已加载图片:\x20','文件名:\x20','clientY','statusContainer','imageHeight','\x20(0x','fontSize','querySelector','已显示浮动画布','restore','touchcancel','7977708OzEWhs','未找到NRF前缀的蓝牙设备，请确认设备已开启','processImage1','getAttribute','textInput','brightness','canvasSize','正在清空屏幕...','map','liangdu','canvasResizeHandle','status','onload','1244396CWKOpe','threeColor','\x20KB)，像素:\x20','translate','已清除画布内容','收到通知:','.txt','toggleDrawingMode','atkinson','#000000','<div\x20class=\x22text-gray-500\x20italic\x22>操作日志将显示在这里...</div>','r_jushua_time','style','#FFFFFF','time_color','floor','4879128oDYQIP','childNodes','toolEraser','currentTool','<i\x20class=\x22fa\x20fa-stop\x20mr-1\x22></i>退出绘画','size','橡皮擦','图片处理完成','red','蓝牙操作异常:\x20','data','getContext','rotate','liang_add','32120002-0bf6-448a-9608-1b01a1a8f75c','图片已铺满画布','offsetHeight','files','<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画',',\x20用时:\x20','image','liang_s','连接失败:\x20未选择蓝牙设备','target','getImageData','lineWidth','gongli_color','liang_time','src','data-size','offsetWidth','color_11','currentSize','eraser','已添加文字:\x20\x22','jushua_time','keydown','4.2_400_300','input','设置时间失败:\x20','D_S_hour','move','toDataURL','display','toolText','\x20MB','请先连接蓝牙设备！','change','round','createImageData','3FPrzNv','brightnessValue','btnDownload','contrastValue','切换模式失败:\x20','黑白红','开始处理图片，使用','startNotifications','抖动算法','left','qiangzhi_shuaxing','touches','toString','提示：按住Shift键拖动图片，或直接点击图片拖动','contains','NRF设备(未知名称)','请先上传图片','cursor-not-allowed','日志已清除','className','bg-amber-500','processedImageInfo','toFixed','请选择日期和时间','color','datetimeInput','清空屏幕失败:\x20','已选择设备:\x20','Jarvis-Judice-Ninke','getCharacteristic','selectedIndex','1079932BzvAGi','disabled','keyup','正在设置时间...','active','length','interleavedcount','none','add','logContainer','btnBlackWhiteRed','toolPen','1615vPmzqx','name','trim','蓝牙设备选择失败:\x20','font','drawingStatus','div','clientX','canvas','ditherMode','gatt','disconnect','result','ditherAlg','innerHTML','requestDevice','toggleCanvasFloat','jushua_time1','e-paper-image-','string','noImagePlaceholder','getPrimaryService','text-amber-300','图片已旋转至\x20','</span>','mouseup','touchmove','图片已居中显示','floydSteinberg','textContent','options','floatPreviewCanvas','确定要清空墨水屏显示内容吗？','strokeStyle','drawImage','确定要清除画布内容吗？','xuanzhuan','some','imageWidth','J_S_min','mtusize','32120001-0bf6-448a-9608-1b01a1a8f75c','push','D_S_min','diffusion','NotFoundError','from','发送失败:\x20','href','addTextBtn','已同步时间！','padStart','正在连接:\x20','max','bg-primary','966746qNSArm','已切换到时钟模式','color_led','text','xianshi_peizhi','fanxian1','<i\x20class=\x22fa\x20fa-unplug\x20mr-1\x22></i>断开','download','1EOTEfA','hidden','wendu_color','发送完成！耗时:\x20','set','cursor','图像尺寸已设置为:\x20','createObjectURL','pen','mousemove','J_S_hour','touchend','请输入文字','mousedown','N_Z_start','11UCyTrB','slice','epdpins','已断开连接','包:\x20','appendChild','then','block','click','touchstart','floatingCanvasContainer','log','ceil','getTime','body','4420790ocXwsj','text/plain','已清空画布，保留设置和图片','主机已同步时间！','contrast','writeValueWithoutResponse'];_0x3f6a=function(){return _0x4477ca;};return _0x3f6a();}function toggleCanvas(){const _0x19d8c6=_0x4f4f15;floatingCanvasContainer[_0x19d8c6(0x1e6)][_0x19d8c6(0x28f)](_0x19d8c6(0x1ad))?(floatingCanvasContainer[_0x19d8c6(0x1e6)]['remove'](_0x19d8c6(0x1ad)),toggleCanvasFloat[_0x19d8c6(0x2ba)]='<i\x20class=\x22fa\x20fa-compress\x20mr-1\x22></i>隐藏画布',addLog(_0x19d8c6(0x22f))):hideCanvas();}function hideCanvas(){const _0x6da783=_0x4f4f15;floatingCanvasContainer[_0x6da783(0x1e6)][_0x6da783(0x2a8)](_0x6da783(0x1ad)),toggleCanvasFloat['innerHTML']='<i\x20class=\x22fa\x20fa-arrows-alt\x20mr-1\x22></i>浮动画布',addLog(_0x6da783(0x21c));}function updateCanvasVisibility(){const _0x408730=_0x4f4f15,_0x404c51=checkCanvasHasContent(canvas);_0x404c51?(noImagePlaceholder['classList'][_0x408730(0x2a8)](_0x408730(0x1ad)),canvas[_0x408730(0x1e6)][_0x408730(0x1e5)](_0x408730(0x1ad)),floatPreviewCanvas[_0x408730(0x1e6)][_0x408730(0x1e5)](_0x408730(0x1ad))):(noImagePlaceholder[_0x408730(0x1e6)][_0x408730(0x1e5)](_0x408730(0x1ad)),canvas[_0x408730(0x1e6)][_0x408730(0x2a8)](_0x408730(0x1ad)),floatPreviewCanvas['classList'][_0x408730(0x2a8)](_0x408730(0x1ad)));}function checkCanvasHasContent(_0x8fe6dc){const _0x988c3=_0x4f4f15,_0x3aa1b5=_0x8fe6dc[_0x988c3(0x25a)]('2d'),_0x54ca93=_0x3aa1b5['getImageData'](0x0,0x0,_0x8fe6dc[_0x988c3(0x1dc)],_0x8fe6dc[_0x988c3(0x1d2)]),_0xf18770=_0x54ca93['data'];for(let _0x13be03=0x0;_0x13be03<_0xf18770['length'];_0x13be03+=0x4){if(_0xf18770[_0x13be03]!==0xff||_0xf18770[_0x13be03+0x1]!==0xff||_0xf18770[_0x13be03+0x2]!==0xff)return!![];}return![];}function startDrag(_0x1c4eb8){const _0x1798ba=_0x4f4f15;isDragging=!![];const _0x6ec845=floatingCanvasContainer[_0x1798ba(0x21a)]();dragOffset['x']=_0x1c4eb8[_0x1798ba(0x2b3)]-_0x6ec845[_0x1798ba(0x28a)],dragOffset['y']=_0x1c4eb8[_0x1798ba(0x229)]-_0x6ec845[_0x1798ba(0x206)];}function drag(_0x41fae1){const _0x3dd57c=_0x4f4f15;if(!isDragging)return;_0x41fae1[_0x3dd57c(0x1e0)]();const _0x204861=_0x41fae1[_0x3dd57c(0x2b3)]-dragOffset['x'],_0x45d8b4=_0x41fae1[_0x3dd57c(0x229)]-dragOffset['y'],_0x285157=window[_0x3dd57c(0x1f4)],_0x431bf2=window['innerHeight'],_0x99a7da=floatingCanvasContainer[_0x3dd57c(0x26d)],_0x297d39=floatingCanvasContainer[_0x3dd57c(0x25f)],_0x1476b9=Math[_0x3dd57c(0x2e1)](0x0,Math[_0x3dd57c(0x20e)](_0x204861,_0x285157-_0x99a7da)),_0x31890b=Math['max'](0x0,Math[_0x3dd57c(0x20e)](_0x45d8b4,_0x431bf2-_0x297d39));floatingCanvasContainer[_0x3dd57c(0x24b)]['left']=_0x1476b9+'px',floatingCanvasContainer[_0x3dd57c(0x24b)]['top']=_0x31890b+'px';}function stopDrag(){isDragging=![];}function startResize(_0x50bc59){const _0x3e5a15=_0x4f4f15;isResizing=!![],_0x50bc59[_0x3e5a15(0x1e0)]();}function resize(_0x319f13){const _0x1652f1=_0x4f4f15;if(!isResizing)return;_0x319f13[_0x1652f1(0x1e0)]();const _0x502240=floatingCanvasContainer['getBoundingClientRect'](),_0x570cd1=_0x319f13[_0x1652f1(0x2b3)]-_0x502240['left'],_0x2ab20d=_0x319f13[_0x1652f1(0x229)]-_0x502240[_0x1652f1(0x206)];_0x570cd1>0xc8&&_0x2ab20d>0x96&&(floatingCanvasContainer[_0x1652f1(0x24b)][_0x1652f1(0x1dc)]=_0x570cd1+'px',floatingCanvasContainer['style'][_0x1652f1(0x1d2)]=_0x2ab20d+'px');}function stopResize(){isResizing=![];}function resetProcessing(){const _0x4b091f=_0x4f4f15;if(0x1){ctx[_0x4b091f(0x1f0)](originalCanvasData,0x0,0x0),syncCanvases();const _0x5e9237=getSelectedCanvasSize();processedImageInfo[_0x4b091f(0x2c9)]=_0x5e9237[_0x4b091f(0x1dc)]+_0x4b091f(0x204)+_0x5e9237['height']+'\x20像素',addLog(_0x4b091f(0x1e1));}else ctx['fillStyle']='#FFFFFF',ctx[_0x4b091f(0x219)](0x0,0x0,canvas[_0x4b091f(0x1dc)],canvas[_0x4b091f(0x1d2)]),syncCanvases(),addLog(_0x4b091f(0x1cc));}function addLog(_0x408408){const _0x5f3896=_0x4f4f15,_0x525389=new Date()['toLocaleTimeString'](),_0x32f807=document[_0x5f3896(0x1f9)](_0x5f3896(0x2b2));_0x32f807[_0x5f3896(0x294)]='mb-1\x20border-b\x20border-gray-100\x20pb-1\x20last:border-0\x20last:mb-0\x20last:pb-0',_0x32f807[_0x5f3896(0x2ba)]='<span\x20class=\x22text-gray-500\x22>['+_0x525389+']</span>\x20<span\x20class=\x22text-gray-800\x22>'+_0x408408+_0x5f3896(0x2c4);logContainer[_0x5f3896(0x22e)]('.italic')&&(logContainer[_0x5f3896(0x2ba)]='');logContainer[_0x5f3896(0x1c0)](_0x32f807),logContainer['scrollTop']=logContainer['scrollHeight'];while(logContainer[_0x5f3896(0x250)][_0x5f3896(0x2a5)]>0x1e){logContainer['removeChild'](logContainer['firstChild']);}}function setStatus(_0x503285){const _0x27d7fc=_0x4f4f15;document[_0x27d7fc(0x1f1)](_0x27d7fc(0x23d))['textContent']=_0x503285;}function updateButtonStatus(_0x16a0ca=![]){const _0x3b1f9b=_0x4f4f15,_0x1e78da=gattServer!=null&&gattServer[_0x3b1f9b(0x1ea)],_0x5a012a=_0x16a0ca||!_0x1e78da;btnSend[_0x3b1f9b(0x2a1)]=_0x5a012a,btnSetTime['disabled']=_0x5a012a,_0x5a012a?(btnSend[_0x3b1f9b(0x1e6)]['add'](_0x3b1f9b(0x1fb),_0x3b1f9b(0x292)),btnSetTime[_0x3b1f9b(0x1e6)][_0x3b1f9b(0x2a8)](_0x3b1f9b(0x1fb),'cursor-not-allowed')):(btnSend['classList'][_0x3b1f9b(0x1e5)](_0x3b1f9b(0x1fb),_0x3b1f9b(0x292)),btnSetTime['classList'][_0x3b1f9b(0x1e5)]('opacity-50',_0x3b1f9b(0x292)));}function reConnect(){addLog('尝试重新连接设备...'),preConnect();}function handleNotify(_0x33594c){const _0x1a3081=_0x4f4f15;console[_0x1a3081(0x1c6)](_0x1a3081(0x244),_0x33594c);}function hex2bytes(_0x53c4b9){const _0x355d04=_0x4f4f15,_0x112591=[];for(let _0x5ac7e1=0x0;_0x5ac7e1<_0x53c4b9[_0x355d04(0x2a5)];_0x5ac7e1+=0x2){_0x112591[_0x355d04(0x2d6)](parseInt(_0x53c4b9['substr'](_0x5ac7e1,0x2),0x10));}return _0x112591;}function formatFileSize(_0x321c73){const _0x12c4ce=_0x4f4f15;if(_0x321c73<0x400)return _0x321c73+'\x20B';else{if(_0x321c73<0x100000)return(_0x321c73/0x400)['toFixed'](0x2)+'\x20KB';else return(_0x321c73/0x100000)[_0x12c4ce(0x297)](0x2)+_0x12c4ce(0x27c);}}async function set_EPD_CMD_J_H(){const _0x441f18=_0x4f4f15;await write(0xff,document['getElementById'](_0x441f18(0x1bd))[_0x441f18(0x1e4)]);}async function set_EPD_CMD_N_Z(){const _0x41565d=_0x4f4f15,_0x2eacf3=document[_0x41565d(0x1f1)](_0x41565d(0x222))[_0x41565d(0x1e4)],_0x22cce8=document['getElementById']('N_Z_min')[_0x41565d(0x1e4)],_0x3c6255=document['getElementById'](_0x41565d(0x1ba))['value'],_0x17ec5e=[0x4];_0x17ec5e[0x0]=0x0,_0x17ec5e[0x1]=0x0,_0x17ec5e[0x2]=_0x2eacf3,_0x17ec5e[0x3]=_0x22cce8,_0x17ec5e[0x4]=_0x3c6255,await write(0xef,_0x17ec5e);}async function set_EPD_CMD_D_S(){const _0x2e2014=_0x4f4f15,_0x120782=document[_0x2e2014(0x1f1)](_0x2e2014(0x277))['value'],_0xc80992=document['getElementById'](_0x2e2014(0x2d7))[_0x2e2014(0x1e4)],_0x2ca8f4=document[_0x2e2014(0x1f1)]('D_S_start')[_0x2e2014(0x1e4)],_0xa3ac83=[0x4];_0xa3ac83[0x0]=0x0,_0xa3ac83[0x1]=0x0,_0xa3ac83[0x2]=_0x120782,_0xa3ac83[0x3]=_0xc80992,_0xa3ac83[0x4]=_0x2ca8f4,await write(0xed,_0xa3ac83);}async function set_EPD_CMD_J_S(){const _0x4c6580=_0x4f4f15,_0x4f4db4=document[_0x4c6580(0x1f1)](_0x4c6580(0x1b6))[_0x4c6580(0x1e4)],_0x3010a1=document[_0x4c6580(0x1f1)](_0x4c6580(0x2d3))['value'],_0x2d9780=document[_0x4c6580(0x1f1)](_0x4c6580(0x209))[_0x4c6580(0x1e4)],_0x1cada0=[0x4];_0x1cada0[0x0]=0x0,_0x1cada0[0x1]=0x0,_0x1cada0[0x2]=_0x4f4db4,_0x1cada0[0x3]=_0x3010a1,_0x1cada0[0x4]=_0x2d9780,await write(0xee,_0x1cada0);}async function set_EPD_CMD_LED(){const _0x14ef3b=_0x4f4f15,_0x4758ee=document['getElementById']('color_led')[_0x14ef3b(0x1e4)],_0x4d6f2b=document['getElementById'](_0x14ef3b(0x26a))['value'],_0x349971=document[_0x14ef3b(0x1f1)](_0x14ef3b(0x25c))[_0x14ef3b(0x1e4)],_0x2990d5=document['getElementById'](_0x14ef3b(0x23b))[_0x14ef3b(0x1e4)],_0x12ec61=document['getElementById'](_0x14ef3b(0x264))[_0x14ef3b(0x1e4)],_0x4c166b=[0x5];_0x4c166b[0x0]=_0x4758ee,_0x4c166b[0x1]=_0x4d6f2b,_0x4c166b[0x2]=_0x349971,_0x4c166b[0x3]=_0x2990d5,_0x4c166b[0x4]=_0x12ec61,await write(0xec,_0x4c166b);}async function set_EPD_CMD_LED1(){const _0x33fb03=_0x4f4f15,_0x27b61f=document[_0x33fb03(0x1f1)](_0x33fb03(0x1a6))[_0x33fb03(0x1e4)],_0x15661b=document[_0x33fb03(0x1f1)]('liang_time')[_0x33fb03(0x1e4)],_0x3b66f4=document[_0x33fb03(0x1f1)](_0x33fb03(0x25c))[_0x33fb03(0x1e4)],_0xdfb789=document[_0x33fb03(0x1f1)]('liangdu')[_0x33fb03(0x1e4)],_0x4e223d=document[_0x33fb03(0x1f1)](_0x33fb03(0x264))['value'],_0x52846c=[0x5];_0x52846c[0x0]=_0x27b61f,_0x52846c[0x1]=_0x15661b,_0x52846c[0x2]=_0x3b66f4,_0x52846c[0x3]=_0xdfb789,_0x52846c[0x4]=_0x4e223d,await write(0xfd,_0x52846c);}async function set_EPD_CMD_MY(){const _0x478808=_0x4f4f15,_0x25dfde=document['getElementById'](_0x478808(0x1d3))[_0x478808(0x1e4)],_0x3edeaa=document[_0x478808(0x1f1)](_0x478808(0x2d0))[_0x478808(0x1e4)],_0xca8d7c=document[_0x478808(0x1f1)](_0x478808(0x28b))['value'],_0x5f2d8c=document[_0x478808(0x1f1)](_0x478808(0x272))['value'],_0x225489=[0x4];_0x225489[0x0]=_0x25dfde,_0x225489[0x1]=_0x3edeaa,_0x225489[0x2]=_0xca8d7c,_0x225489[0x3]=_0x5f2d8c,await write(0xeb,_0x225489);}async function set_EPD_CMD_COLOR(){const _0x2efd6e=_0x4f4f15,_0x5aea83=document[_0x2efd6e(0x1f1)](_0x2efd6e(0x1f3))[_0x2efd6e(0x1e4)],_0x424d76=document[_0x2efd6e(0x1f1)](_0x2efd6e(0x24d))[_0x2efd6e(0x1e4)],_0x76ea03=document[_0x2efd6e(0x1f1)](_0x2efd6e(0x1ae))[_0x2efd6e(0x1e4)],_0x2654f5=document[_0x2efd6e(0x1f1)](_0x2efd6e(0x269))[_0x2efd6e(0x1e4)],_0x4b636a=document[_0x2efd6e(0x1f1)]('shichen_color')[_0x2efd6e(0x1e4)],_0x35eb18=document[_0x2efd6e(0x1f1)](_0x2efd6e(0x1f2))['value'],_0x1f84d6=document[_0x2efd6e(0x1f1)](_0x2efd6e(0x24a))[_0x2efd6e(0x1e4)],_0x4e3639=[0x7];_0x4e3639[0x0]=_0x5aea83,_0x4e3639[0x1]=_0x424d76,_0x4e3639[0x2]=_0x76ea03,_0x4e3639[0x3]=_0x2654f5,_0x4e3639[0x4]=_0x4b636a,_0x4e3639[0x5]=_0x35eb18,_0x4e3639[0x6]=_0x1f84d6,await write(0xea,_0x4e3639);}async function set_EPD_CMD_4_MS(){const _0x22c37b=_0x4f4f15,_0x547f22=document[_0x22c37b(0x1f1)](_0x22c37b(0x1a9))[_0x22c37b(0x1e4)],_0xf50081=document[_0x22c37b(0x1f1)]('xuanzhuan1')['value'],_0x1f8350=document[_0x22c37b(0x1f1)](_0x22c37b(0x2bd))[_0x22c37b(0x1e4)],_0x3b728e=document['getElementById'](_0x22c37b(0x1a8))[_0x22c37b(0x1e4)],_0x444f24=document[_0x22c37b(0x1f1)]('moshi_id')[_0x22c37b(0x1e4)],_0x5e3e1e=document['getElementById'](_0x22c37b(0x26e))[_0x22c37b(0x1e4)],_0x1ab07f=document[_0x22c37b(0x1f1)]('silian_ziti')[_0x22c37b(0x1e4)],_0xa1eaa=[0x7];_0xa1eaa[0x0]=_0x547f22,_0xa1eaa[0x1]=_0xf50081,_0xa1eaa[0x2]=_0x1f8350,_0xa1eaa[0x3]=_0x3b728e,_0xa1eaa[0x4]=_0x444f24,_0xa1eaa[0x5]=_0x5e3e1e,_0xa1eaa[0x6]=_0x1ab07f,await write(0xfe,_0xa1eaa);}async function syncTime(_0x3c8e22){const _0x18c709=_0x4f4f15,_0x1d3fb5=new Date()[_0x18c709(0x1c8)]()/0x3e8,_0x110dae=new Uint8Array([_0x1d3fb5>>0x18&0xff,_0x1d3fb5>>0x10&0xff,_0x1d3fb5>>0x8&0xff,_0x1d3fb5&0xff,-(new Date()['getTimezoneOffset']()/0x3c),_0x3c8e22]);await write(0xa3,_0x110dae)&&addLog(_0x18c709(0x2de));}async function set_EPD_CMD_4_ZF(_0x4e98a1){const _0x1eb95a=_0x4f4f15,_0x468006=[0x1];_0x468006[0x0]=_0x4e98a1,await write(0xfb,_0x468006),_0x4e98a1==0x0&&(syncTime(0x2),addLog(_0x1eb95a(0x1cd)));}window[_0x4f4f15(0x23e)]=init;
