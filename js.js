const _0x4a9634=_0x1140;(function(_0x26eb5b,_0x28830f){const _0x312dc3=_0x1140,_0x5bf629=_0x26eb5b();while(!![]){try{const _0x5dc9eb=parseInt(_0x312dc3(0x2b0))/0x1*(parseInt(_0x312dc3(0x21e))/0x2)+-parseInt(_0x312dc3(0x2d6))/0x3*(parseInt(_0x312dc3(0x284))/0x4)+-parseInt(_0x312dc3(0x27a))/0x5+parseInt(_0x312dc3(0x255))/0x6+-parseInt(_0x312dc3(0x328))/0x7+-parseInt(_0x312dc3(0x290))/0x8+parseInt(_0x312dc3(0x2ee))/0x9;if(_0x5dc9eb===_0x28830f)break;else _0x5bf629['push'](_0x5bf629['shift']());}catch(_0x4b6952){_0x5bf629['push'](_0x5bf629['shift']());}}}(_0x4d40,0xd0117));let sourceImage=null,originalImage=null,canvas,ctx,floatCanvas,floatCtx,originalCanvasData=null,startTime,currentParams={'saturation':0x64,'brightness':0x64,'contrast':0x64,'diffusion':0x32,'ditherAlg':_0x4a9634(0x214)},currentMode=_0x4a9634(0x2a6),canvasRotation=0x0,isDrawing=![],lastX=0x0,lastY=0x0,currentTool=_0x4a9634(0x200),brushSize=0x3,brushColor=_0x4a9634(0x2e0),imageScale=0x64,imageOffset={'x':0x0,'y':0x0},isDraggingImage=![],dragStartPos={'x':0x0,'y':0x0},shiftKeyPressed=![],imageRotation=0x0,isDrawingModeActive=![],isDragging=![],dragOffset={'x':0x0,'y':0x0},isResizing=![],bleDevice,gattServer,epdService,epdCharacteristic,msgIndex,appVersion,textDecoder;const EpdCmd={'SET_PINS':0xaa,'INIT':0xa9,'CLEAR':0xa8,'SEND_CMD':0xa7,'SEND_DATA':0xa6,'REFRESH':0xa5,'SLEEP':0xa4,'SET_TIME':0xa3,'WEEK_START':0xa2,'WRITE_IMG':0xa1,'SET_CONFIG':0xa0,'SYS_RESET':0xab,'SYS_SLEEP':0xac,'CFG_ERASE':0xad,'SET_MODE':0xae,'EPD_CMD_J_H':0xff,'EPD_CMD_N_Z':0xef,'EPD_CMD_J_S':0xee,'EPD_CMD_D_S':0xed,'EPD_CMD_LED':0xec,'EPD_CMD_MY':0xeb,'EPD_CMD_COLOR':0xea,'EPD_CMD_4_MS':0xfe,'EPD_CMD_4_LED':0xfd,'EPD_CMD_4_XZ':0xfc,'EPD_CMD_4_ZF':0xfb},DisplayMode={'IMAGE':0x0,'CLOCK':0x1,'CALENDAR':0x2},canvasSizes=[{'name':_0x4a9634(0x23e),'width':0x7a,'height':0xfa},{'name':_0x4a9634(0x1fe),'width':0x190,'height':0x12c},{'name':_0x4a9634(0x304),'width':0x320,'height':0x1e0}],threeColorPalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1},{'name':'红色','r':0xff,'g':0x0,'b':0x0,'value':0x2}],blackWhitePalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1}];function adjustContrast(_0x1f5072,_0x274e69){const _0x27e97b=_0x4a9634,_0x91a840=_0x1f5072[_0x27e97b(0x218)];for(let _0x505101=0x0;_0x505101<_0x91a840['length'];_0x505101+=0x4){_0x91a840[_0x505101]=Math['min'](0xff,Math[_0x27e97b(0x203)](0x0,(_0x91a840[_0x505101]-0x80)*_0x274e69+0x80)),_0x91a840[_0x505101+0x1]=Math[_0x27e97b(0x330)](0xff,Math[_0x27e97b(0x203)](0x0,(_0x91a840[_0x505101+0x1]-0x80)*_0x274e69+0x80)),_0x91a840[_0x505101+0x2]=Math[_0x27e97b(0x330)](0xff,Math[_0x27e97b(0x203)](0x0,(_0x91a840[_0x505101+0x2]-0x80)*_0x274e69+0x80));}return _0x1f5072;}function adjustBrightness(_0x4b2f6c,_0x128227){const _0x29a440=_0x4a9634,_0xf1b061=_0x128227/0x64,_0x58698c=_0x4b2f6c[_0x29a440(0x218)];for(let _0xe83a7e=0x0;_0xe83a7e<_0x58698c['length'];_0xe83a7e+=0x4){_0x58698c[_0xe83a7e]=Math[_0x29a440(0x330)](0xff,Math[_0x29a440(0x203)](0x0,_0x58698c[_0xe83a7e]*_0xf1b061)),_0x58698c[_0xe83a7e+0x1]=Math[_0x29a440(0x330)](0xff,Math[_0x29a440(0x203)](0x0,_0x58698c[_0xe83a7e+0x1]*_0xf1b061)),_0x58698c[_0xe83a7e+0x2]=Math[_0x29a440(0x330)](0xff,Math[_0x29a440(0x203)](0x0,_0x58698c[_0xe83a7e+0x2]*_0xf1b061));}return _0x4b2f6c;}function adjustSaturation(_0x5ef158,_0x1be422){const _0x4b0551=_0x4a9634,_0x1f2ecb=_0x5ef158[_0x4b0551(0x218)];for(let _0x47659f=0x0;_0x47659f<_0x1f2ecb[_0x4b0551(0x29e)];_0x47659f+=0x4){const _0x2705b3=0.299*_0x1f2ecb[_0x47659f]+0.587*_0x1f2ecb[_0x47659f+0x1]+0.114*_0x1f2ecb[_0x47659f+0x2];_0x1f2ecb[_0x47659f]=Math[_0x4b0551(0x330)](0xff,Math[_0x4b0551(0x203)](0x0,_0x2705b3+(_0x1f2ecb[_0x47659f]-_0x2705b3)*_0x1be422)),_0x1f2ecb[_0x47659f+0x1]=Math[_0x4b0551(0x330)](0xff,Math['max'](0x0,_0x2705b3+(_0x1f2ecb[_0x47659f+0x1]-_0x2705b3)*_0x1be422)),_0x1f2ecb[_0x47659f+0x2]=Math[_0x4b0551(0x330)](0xff,Math[_0x4b0551(0x203)](0x0,_0x2705b3+(_0x1f2ecb[_0x47659f+0x2]-_0x2705b3)*_0x1be422));}return _0x5ef158;}function rgbToLab(_0xf27b23,_0x19373a,_0x202275){const _0xbc4d=_0x4a9634;_0xf27b23=_0xf27b23/0xff,_0x19373a=_0x19373a/0xff,_0x202275=_0x202275/0xff,_0xf27b23=_0xf27b23>0.04045?Math[_0xbc4d(0x30f)]((_0xf27b23+0.055)/1.055,2.4):_0xf27b23/12.92,_0x19373a=_0x19373a>0.04045?Math['pow']((_0x19373a+0.055)/1.055,2.4):_0x19373a/12.92,_0x202275=_0x202275>0.04045?Math['pow']((_0x202275+0.055)/1.055,2.4):_0x202275/12.92,_0xf27b23*=0x64,_0x19373a*=0x64,_0x202275*=0x64;let _0x47995d=_0xf27b23*0.4124+_0x19373a*0.3576+_0x202275*0.1805,_0xe37b46=_0xf27b23*0.2126+_0x19373a*0.7152+_0x202275*0.0722,_0x1b5315=_0xf27b23*0.0193+_0x19373a*0.1192+_0x202275*0.9505;_0x47995d/=95.047,_0xe37b46/=0x64,_0x1b5315/=108.883,_0x47995d=_0x47995d>0.008856?Math[_0xbc4d(0x30f)](_0x47995d,0x1/0x3):7.787*_0x47995d+0x10/0x74,_0xe37b46=_0xe37b46>0.008856?Math[_0xbc4d(0x30f)](_0xe37b46,0x1/0x3):7.787*_0xe37b46+0x10/0x74,_0x1b5315=_0x1b5315>0.008856?Math[_0xbc4d(0x30f)](_0x1b5315,0x1/0x3):7.787*_0x1b5315+0x10/0x74;const _0x3d1060=0x74*_0xe37b46-0x10,_0x3180f0=0x1f4*(_0x47995d-_0xe37b46),_0x1dfd7d=0xc8*(_0xe37b46-_0x1b5315);return{'l':_0x3d1060,'a':_0x3180f0,'b':_0x1dfd7d};}function labDistance(_0xd05775,_0x2228aa){const _0x1e42d0=_0xd05775['l']-_0x2228aa['l'],_0x5a28de=_0xd05775['a']-_0x2228aa['a'],_0x43f77e=_0xd05775['b']-_0x2228aa['b'];return Math['sqrt'](0.2*_0x1e42d0*_0x1e42d0+0x3*_0x5a28de*_0x5a28de+0x3*_0x43f77e*_0x43f77e);}function findClosestColor(_0x5bd580,_0xe5580c,_0x55c005,_0x5c4e9b){let _0x2ec6b1;if(_0x5c4e9b==='threeColor'){_0x2ec6b1=threeColorPalette;if(_0x5bd580>0x78&&_0x5bd580>_0xe5580c*1.5&&_0x5bd580>_0x55c005*1.5)return threeColorPalette[0x2];const _0x206780=0.299*_0x5bd580+0.587*_0xe5580c+0.114*_0x55c005;return _0x206780<0x80?threeColorPalette[0x0]:threeColorPalette[0x1];}else{_0x2ec6b1=blackWhitePalette;const _0x41f458=0.299*_0x5bd580+0.587*_0xe5580c+0.114*_0x55c005;return _0x41f458<0x80?blackWhitePalette[0x0]:blackWhitePalette[0x1];}}const DitherAlgorithms={'floydSteinberg':function(_0x3370f1,_0x2c12ff,_0x9441ae){const _0x57fbd5=_0x4a9634,_0x4d0fc2=_0x3370f1[_0x57fbd5(0x26a)],_0x45a32d=_0x3370f1['height'],_0x2ef9c5=_0x3370f1[_0x57fbd5(0x218)],_0x374657=new Uint8ClampedArray(_0x2ef9c5);for(let _0x139e08=0x0;_0x139e08<_0x45a32d;_0x139e08++){for(let _0x2717e4=0x0;_0x2717e4<_0x4d0fc2;_0x2717e4++){const _0x3903f5=(_0x139e08*_0x4d0fc2+_0x2717e4)*0x4,_0x116202=_0x374657[_0x3903f5],_0x48ec8d=_0x374657[_0x3903f5+0x1],_0x271cb7=_0x374657[_0x3903f5+0x2],_0x125eda=findClosestColor(_0x116202,_0x48ec8d,_0x271cb7,_0x9441ae),_0x1b19c5=(_0x116202-_0x125eda['r'])*_0x2c12ff,_0x100fab=(_0x48ec8d-_0x125eda['g'])*_0x2c12ff,_0x1e987c=(_0x271cb7-_0x125eda['b'])*_0x2c12ff;if(_0x2717e4+0x1<_0x4d0fc2){const _0x3e45e9=_0x3903f5+0x4;_0x374657[_0x3e45e9]=Math['min'](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x3e45e9]+_0x1b19c5*0x7/0x10)),_0x374657[_0x3e45e9+0x1]=Math[_0x57fbd5(0x330)](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x3e45e9+0x1]+_0x100fab*0x7/0x10)),_0x374657[_0x3e45e9+0x2]=Math[_0x57fbd5(0x330)](0xff,Math['max'](0x0,_0x374657[_0x3e45e9+0x2]+_0x1e987c*0x7/0x10));}if(_0x139e08+0x1<_0x45a32d){if(_0x2717e4>0x0){const _0x250520=_0x3903f5+_0x4d0fc2*0x4-0x4;_0x374657[_0x250520]=Math[_0x57fbd5(0x330)](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x250520]+_0x1b19c5*0x3/0x10)),_0x374657[_0x250520+0x1]=Math['min'](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x250520+0x1]+_0x100fab*0x3/0x10)),_0x374657[_0x250520+0x2]=Math['min'](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x250520+0x2]+_0x1e987c*0x3/0x10));}const _0x3609fe=_0x3903f5+_0x4d0fc2*0x4;_0x374657[_0x3609fe]=Math[_0x57fbd5(0x330)](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x3609fe]+_0x1b19c5*0x5/0x10)),_0x374657[_0x3609fe+0x1]=Math[_0x57fbd5(0x330)](0xff,Math['max'](0x0,_0x374657[_0x3609fe+0x1]+_0x100fab*0x5/0x10)),_0x374657[_0x3609fe+0x2]=Math[_0x57fbd5(0x330)](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x3609fe+0x2]+_0x1e987c*0x5/0x10));if(_0x2717e4+0x1<_0x4d0fc2){const _0x4cc109=_0x3903f5+_0x4d0fc2*0x4+0x4;_0x374657[_0x4cc109]=Math[_0x57fbd5(0x330)](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x4cc109]+_0x1b19c5*0x1/0x10)),_0x374657[_0x4cc109+0x1]=Math[_0x57fbd5(0x330)](0xff,Math[_0x57fbd5(0x203)](0x0,_0x374657[_0x4cc109+0x1]+_0x100fab*0x1/0x10)),_0x374657[_0x4cc109+0x2]=Math[_0x57fbd5(0x330)](0xff,Math['max'](0x0,_0x374657[_0x4cc109+0x2]+_0x1e987c*0x1/0x10));}}}}for(let _0x40091b=0x0;_0x40091b<_0x45a32d;_0x40091b++){for(let _0x3ff471=0x0;_0x3ff471<_0x4d0fc2;_0x3ff471++){const _0x39f0f7=(_0x40091b*_0x4d0fc2+_0x3ff471)*0x4,_0x2790b1=_0x374657[_0x39f0f7],_0x2d80e3=_0x374657[_0x39f0f7+0x1],_0x3dca05=_0x374657[_0x39f0f7+0x2],_0x3b285f=findClosestColor(_0x2790b1,_0x2d80e3,_0x3dca05,_0x9441ae);_0x2ef9c5[_0x39f0f7]=_0x3b285f['r'],_0x2ef9c5[_0x39f0f7+0x1]=_0x3b285f['g'],_0x2ef9c5[_0x39f0f7+0x2]=_0x3b285f['b'];}}return _0x3370f1;},'atkinson':function(_0x43df56,_0x355fd0,_0x1f5589){const _0x5ae0ca=_0x4a9634,_0x5258f4=_0x43df56[_0x5ae0ca(0x26a)],_0x280b68=_0x43df56[_0x5ae0ca(0x1f5)],_0xa23f72=_0x43df56[_0x5ae0ca(0x218)],_0x5af0d0=new Uint8ClampedArray(_0xa23f72),_0x18697e=_0x355fd0*0x1/0x8;for(let _0x400ef4=0x0;_0x400ef4<_0x280b68;_0x400ef4++){for(let _0x599221=0x0;_0x599221<_0x5258f4;_0x599221++){const _0x5f2983=(_0x400ef4*_0x5258f4+_0x599221)*0x4,_0x373b5d=_0x5af0d0[_0x5f2983],_0x18b4a5=_0x5af0d0[_0x5f2983+0x1],_0x1bb0d8=_0x5af0d0[_0x5f2983+0x2],_0x1de58e=findClosestColor(_0x373b5d,_0x18b4a5,_0x1bb0d8,_0x1f5589),_0x299283=(_0x373b5d-_0x1de58e['r'])*_0x18697e,_0x24cdfb=(_0x18b4a5-_0x1de58e['g'])*_0x18697e,_0x1750d4=(_0x1bb0d8-_0x1de58e['b'])*_0x18697e;if(_0x599221+0x1<_0x5258f4){const _0x2a9e99=_0x5f2983+0x4;_0x5af0d0[_0x2a9e99]=Math['min'](0xff,Math['max'](0x0,_0x5af0d0[_0x2a9e99]+_0x299283)),_0x5af0d0[_0x2a9e99+0x1]=Math['min'](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x2a9e99+0x1]+_0x24cdfb)),_0x5af0d0[_0x2a9e99+0x2]=Math['min'](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x2a9e99+0x2]+_0x1750d4));}if(_0x599221+0x2<_0x5258f4){const _0x210a5e=_0x5f2983+0x8;_0x5af0d0[_0x210a5e]=Math[_0x5ae0ca(0x330)](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x210a5e]+_0x299283)),_0x5af0d0[_0x210a5e+0x1]=Math['min'](0xff,Math['max'](0x0,_0x5af0d0[_0x210a5e+0x1]+_0x24cdfb)),_0x5af0d0[_0x210a5e+0x2]=Math[_0x5ae0ca(0x330)](0xff,Math['max'](0x0,_0x5af0d0[_0x210a5e+0x2]+_0x1750d4));}if(_0x400ef4+0x1<_0x280b68){if(_0x599221>0x0){const _0x3c1e7e=_0x5f2983+_0x5258f4*0x4-0x4;_0x5af0d0[_0x3c1e7e]=Math['min'](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x3c1e7e]+_0x299283)),_0x5af0d0[_0x3c1e7e+0x1]=Math[_0x5ae0ca(0x330)](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x3c1e7e+0x1]+_0x24cdfb)),_0x5af0d0[_0x3c1e7e+0x2]=Math['min'](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x3c1e7e+0x2]+_0x1750d4));}const _0x536cea=_0x5f2983+_0x5258f4*0x4;_0x5af0d0[_0x536cea]=Math[_0x5ae0ca(0x330)](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x536cea]+_0x299283)),_0x5af0d0[_0x536cea+0x1]=Math[_0x5ae0ca(0x330)](0xff,Math['max'](0x0,_0x5af0d0[_0x536cea+0x1]+_0x24cdfb)),_0x5af0d0[_0x536cea+0x2]=Math[_0x5ae0ca(0x330)](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0x536cea+0x2]+_0x1750d4));if(_0x599221+0x1<_0x5258f4){const _0xd994fc=_0x5f2983+_0x5258f4*0x4+0x4;_0x5af0d0[_0xd994fc]=Math['min'](0xff,Math['max'](0x0,_0x5af0d0[_0xd994fc]+_0x299283)),_0x5af0d0[_0xd994fc+0x1]=Math['min'](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0xd994fc+0x1]+_0x24cdfb)),_0x5af0d0[_0xd994fc+0x2]=Math[_0x5ae0ca(0x330)](0xff,Math[_0x5ae0ca(0x203)](0x0,_0x5af0d0[_0xd994fc+0x2]+_0x1750d4));}}}}for(let _0x448f4b=0x0;_0x448f4b<_0x280b68;_0x448f4b++){for(let _0x10f08e=0x0;_0x10f08e<_0x5258f4;_0x10f08e++){const _0x222079=(_0x448f4b*_0x5258f4+_0x10f08e)*0x4,_0x5f46ca=_0x5af0d0[_0x222079],_0x3e7af7=_0x5af0d0[_0x222079+0x1],_0x248316=_0x5af0d0[_0x222079+0x2],_0x34d931=findClosestColor(_0x5f46ca,_0x3e7af7,_0x248316,_0x1f5589);_0xa23f72[_0x222079]=_0x34d931['r'],_0xa23f72[_0x222079+0x1]=_0x34d931['g'],_0xa23f72[_0x222079+0x2]=_0x34d931['b'];}}return _0x43df56;},'bayer':function(_0x5a1db8,_0x361c8d,_0x3d75c5){const _0x2b8e04=_0x4a9634,_0x59f9f6=_0x5a1db8['width'],_0x190daa=_0x5a1db8[_0x2b8e04(0x1f5)],_0xd9241b=_0x5a1db8['data'],_0x1f9a68=[[0x0,0x8,0x2,0xa],[0xc,0x4,0xe,0x6],[0x3,0xb,0x1,0x9],[0xf,0x7,0xd,0x5]],_0x327a28=0x4,_0x423fc0=0x10;for(let _0x865a29=0x0;_0x865a29<_0x190daa;_0x865a29++){for(let _0x45317a=0x0;_0x45317a<_0x59f9f6;_0x45317a++){const _0x399a37=(_0x865a29*_0x59f9f6+_0x45317a)*0x4,_0x84c6d0=_0xd9241b[_0x399a37],_0x72f8ac=_0xd9241b[_0x399a37+0x1],_0x35f60a=_0xd9241b[_0x399a37+0x2],_0xf4586=0.299*_0x84c6d0+0.587*_0x72f8ac+0.114*_0x35f60a,_0x36c085=_0x45317a%_0x327a28,_0x1445a0=_0x865a29%_0x327a28,_0x445c16=_0x1f9a68[_0x1445a0][_0x36c085];let _0x2e723b=_0xf4586;if(_0x3d75c5===_0x2b8e04(0x231)&&_0x84c6d0>0x78&&_0x84c6d0>_0x72f8ac*1.5&&_0x84c6d0>_0x35f60a*1.5)_0xd9241b[_0x399a37]=0xff,_0xd9241b[_0x399a37+0x1]=0x0,_0xd9241b[_0x399a37+0x2]=0x0;else{const _0x4939da=_0x445c16/_0x423fc0*0xff*_0x361c8d;_0xf4586<0x80+(_0x4939da-0x80)?(_0xd9241b[_0x399a37]=0x0,_0xd9241b[_0x399a37+0x1]=0x0,_0xd9241b[_0x399a37+0x2]=0x0):(_0xd9241b[_0x399a37]=0xff,_0xd9241b[_0x399a37+0x1]=0xff,_0xd9241b[_0x399a37+0x2]=0xff);}}}return _0x5a1db8;},'stucki':function(_0x4445d7,_0x46eda6,_0x398a49){const _0x16f1c7=_0x4a9634,_0x36a295=_0x4445d7[_0x16f1c7(0x26a)],_0x569975=_0x4445d7['height'],_0x2d53b4=_0x4445d7[_0x16f1c7(0x218)],_0x5a33fb=new Uint8ClampedArray(_0x2d53b4),_0x4d3208=_0x46eda6*0x1/0x2a;for(let _0x483f83=0x0;_0x483f83<_0x569975;_0x483f83++){for(let _0x495667=0x0;_0x495667<_0x36a295;_0x495667++){const _0x27b24b=(_0x483f83*_0x36a295+_0x495667)*0x4,_0x4a1f6d=_0x5a33fb[_0x27b24b],_0xcc32fb=_0x5a33fb[_0x27b24b+0x1],_0x8cffb4=_0x5a33fb[_0x27b24b+0x2],_0x355399=findClosestColor(_0x4a1f6d,_0xcc32fb,_0x8cffb4,_0x398a49),_0x55d742=(_0x4a1f6d-_0x355399['r'])*_0x4d3208,_0x478a97=(_0xcc32fb-_0x355399['g'])*_0x4d3208,_0x26b146=(_0x8cffb4-_0x355399['b'])*_0x4d3208;if(_0x495667+0x1<_0x36a295){const _0x55ef19=_0x27b24b+0x4;_0x5a33fb[_0x55ef19]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x55ef19]+_0x55d742*0x8)),_0x5a33fb[_0x55ef19+0x1]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x55ef19+0x1]+_0x478a97*0x8)),_0x5a33fb[_0x55ef19+0x2]=Math['min'](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x55ef19+0x2]+_0x26b146*0x8));}if(_0x495667+0x2<_0x36a295){const _0x1282f5=_0x27b24b+0x8;_0x5a33fb[_0x1282f5]=Math[_0x16f1c7(0x330)](0xff,Math['max'](0x0,_0x5a33fb[_0x1282f5]+_0x55d742*0x4)),_0x5a33fb[_0x1282f5+0x1]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x1282f5+0x1]+_0x478a97*0x4)),_0x5a33fb[_0x1282f5+0x2]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x1282f5+0x2]+_0x26b146*0x4));}if(_0x483f83+0x1<_0x569975){if(_0x495667>0x1){const _0x17832a=_0x27b24b+_0x36a295*0x4-0x8;_0x5a33fb[_0x17832a]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x17832a]+_0x55d742*0x2)),_0x5a33fb[_0x17832a+0x1]=Math[_0x16f1c7(0x330)](0xff,Math['max'](0x0,_0x5a33fb[_0x17832a+0x1]+_0x478a97*0x2)),_0x5a33fb[_0x17832a+0x2]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x17832a+0x2]+_0x26b146*0x2));}if(_0x495667>0x0){const _0x20cd21=_0x27b24b+_0x36a295*0x4-0x4;_0x5a33fb[_0x20cd21]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x20cd21]+_0x55d742*0x4)),_0x5a33fb[_0x20cd21+0x1]=Math[_0x16f1c7(0x330)](0xff,Math['max'](0x0,_0x5a33fb[_0x20cd21+0x1]+_0x478a97*0x4)),_0x5a33fb[_0x20cd21+0x2]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x20cd21+0x2]+_0x26b146*0x4));}const _0x1bdf5d=_0x27b24b+_0x36a295*0x4;_0x5a33fb[_0x1bdf5d]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x1bdf5d]+_0x55d742*0x8)),_0x5a33fb[_0x1bdf5d+0x1]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x1bdf5d+0x1]+_0x478a97*0x8)),_0x5a33fb[_0x1bdf5d+0x2]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x1bdf5d+0x2]+_0x26b146*0x8));if(_0x495667+0x1<_0x36a295){const _0xb854d7=_0x27b24b+_0x36a295*0x4+0x4;_0x5a33fb[_0xb854d7]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0xb854d7]+_0x55d742*0x4)),_0x5a33fb[_0xb854d7+0x1]=Math['min'](0xff,Math['max'](0x0,_0x5a33fb[_0xb854d7+0x1]+_0x478a97*0x4)),_0x5a33fb[_0xb854d7+0x2]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0xb854d7+0x2]+_0x26b146*0x4));}if(_0x495667+0x2<_0x36a295){const _0x324301=_0x27b24b+_0x36a295*0x4+0x8;_0x5a33fb[_0x324301]=Math[_0x16f1c7(0x330)](0xff,Math[_0x16f1c7(0x203)](0x0,_0x5a33fb[_0x324301]+_0x55d742*0x2)),_0x5a33fb[_0x324301+0x1]=Math[_0x16f1c7(0x330)](0xff,Math['max'](0x0,_0x5a33fb[_0x324301+0x1]+_0x478a97*0x2)),_0x5a33fb[_0x324301+0x2]=Math['min'](0xff,Math['max'](0x0,_0x5a33fb[_0x324301+0x2]+_0x26b146*0x2));}}}}for(let _0x487257=0x0;_0x487257<_0x569975;_0x487257++){for(let _0xea408=0x0;_0xea408<_0x36a295;_0xea408++){const _0x232321=(_0x487257*_0x36a295+_0xea408)*0x4,_0x3f2178=_0x5a33fb[_0x232321],_0x11a758=_0x5a33fb[_0x232321+0x1],_0x319f8d=_0x5a33fb[_0x232321+0x2],_0x36685b=findClosestColor(_0x3f2178,_0x11a758,_0x319f8d,_0x398a49);_0x2d53b4[_0x232321]=_0x36685b['r'],_0x2d53b4[_0x232321+0x1]=_0x36685b['g'],_0x2d53b4[_0x232321+0x2]=_0x36685b['b'];}}return _0x4445d7;},'jarvis':function(_0x53e746,_0x2a01eb,_0x567779){const _0x17d000=_0x4a9634,_0x3cc006=_0x53e746[_0x17d000(0x26a)],_0x28c718=_0x53e746[_0x17d000(0x1f5)],_0x2d2903=_0x53e746[_0x17d000(0x218)],_0xa9eeb5=new Uint8ClampedArray(_0x2d2903),_0x2e9152=_0x2a01eb*0x1/0x30;for(let _0x43b5f7=0x0;_0x43b5f7<_0x28c718;_0x43b5f7++){for(let _0x43dc4f=0x0;_0x43dc4f<_0x3cc006;_0x43dc4f++){const _0x4cc499=(_0x43b5f7*_0x3cc006+_0x43dc4f)*0x4,_0x42730d=_0xa9eeb5[_0x4cc499],_0x501f4d=_0xa9eeb5[_0x4cc499+0x1],_0x5ddc6e=_0xa9eeb5[_0x4cc499+0x2],_0x420fe1=findClosestColor(_0x42730d,_0x501f4d,_0x5ddc6e,_0x567779),_0x5cf13c=(_0x42730d-_0x420fe1['r'])*_0x2e9152,_0x5378be=(_0x501f4d-_0x420fe1['g'])*_0x2e9152,_0x3184fb=(_0x5ddc6e-_0x420fe1['b'])*_0x2e9152;if(_0x43dc4f+0x1<_0x3cc006){const _0x203bba=_0x4cc499+0x4;_0xa9eeb5[_0x203bba]=Math[_0x17d000(0x330)](0xff,Math['max'](0x0,_0xa9eeb5[_0x203bba]+_0x5cf13c*0x7)),_0xa9eeb5[_0x203bba+0x1]=Math[_0x17d000(0x330)](0xff,Math['max'](0x0,_0xa9eeb5[_0x203bba+0x1]+_0x5378be*0x7)),_0xa9eeb5[_0x203bba+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x203bba+0x2]+_0x3184fb*0x7));}if(_0x43dc4f+0x2<_0x3cc006){const _0x169a54=_0x4cc499+0x8;_0xa9eeb5[_0x169a54]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x169a54]+_0x5cf13c*0x5)),_0xa9eeb5[_0x169a54+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x169a54+0x1]+_0x5378be*0x5)),_0xa9eeb5[_0x169a54+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x169a54+0x2]+_0x3184fb*0x5));}if(_0x43b5f7+0x1<_0x28c718){if(_0x43dc4f>0x1){const _0x3826cd=_0x4cc499+_0x3cc006*0x4-0x8;_0xa9eeb5[_0x3826cd]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x3826cd]+_0x5cf13c*0x3)),_0xa9eeb5[_0x3826cd+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x3826cd+0x1]+_0x5378be*0x3)),_0xa9eeb5[_0x3826cd+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x3826cd+0x2]+_0x3184fb*0x3));}if(_0x43dc4f>0x0){const _0x361e56=_0x4cc499+_0x3cc006*0x4-0x4;_0xa9eeb5[_0x361e56]=Math['min'](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x361e56]+_0x5cf13c*0x5)),_0xa9eeb5[_0x361e56+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x361e56+0x1]+_0x5378be*0x5)),_0xa9eeb5[_0x361e56+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x361e56+0x2]+_0x3184fb*0x5));}const _0x1f7677=_0x4cc499+_0x3cc006*0x4;_0xa9eeb5[_0x1f7677]=Math['min'](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x1f7677]+_0x5cf13c*0x7)),_0xa9eeb5[_0x1f7677+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x1f7677+0x1]+_0x5378be*0x7)),_0xa9eeb5[_0x1f7677+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x1f7677+0x2]+_0x3184fb*0x7));if(_0x43dc4f+0x1<_0x3cc006){const _0x5e6962=_0x4cc499+_0x3cc006*0x4+0x4;_0xa9eeb5[_0x5e6962]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x5e6962]+_0x5cf13c*0x5)),_0xa9eeb5[_0x5e6962+0x1]=Math[_0x17d000(0x330)](0xff,Math['max'](0x0,_0xa9eeb5[_0x5e6962+0x1]+_0x5378be*0x5)),_0xa9eeb5[_0x5e6962+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x5e6962+0x2]+_0x3184fb*0x5));}if(_0x43dc4f+0x2<_0x3cc006){const _0x55c0a6=_0x4cc499+_0x3cc006*0x4+0x8;_0xa9eeb5[_0x55c0a6]=Math['min'](0xff,Math['max'](0x0,_0xa9eeb5[_0x55c0a6]+_0x5cf13c*0x3)),_0xa9eeb5[_0x55c0a6+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x55c0a6+0x1]+_0x5378be*0x3)),_0xa9eeb5[_0x55c0a6+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x55c0a6+0x2]+_0x3184fb*0x3));}}if(_0x43b5f7+0x2<_0x28c718){if(_0x43dc4f>0x1){const _0x37abc8=_0x4cc499+_0x3cc006*0x4*0x2-0x8;_0xa9eeb5[_0x37abc8]=Math[_0x17d000(0x330)](0xff,Math['max'](0x0,_0xa9eeb5[_0x37abc8]+_0x5cf13c*0x1)),_0xa9eeb5[_0x37abc8+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x37abc8+0x1]+_0x5378be*0x1)),_0xa9eeb5[_0x37abc8+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x37abc8+0x2]+_0x3184fb*0x1));}if(_0x43dc4f>0x0){const _0x4d7839=_0x4cc499+_0x3cc006*0x4*0x2-0x4;_0xa9eeb5[_0x4d7839]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x4d7839]+_0x5cf13c*0x3)),_0xa9eeb5[_0x4d7839+0x1]=Math['min'](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x4d7839+0x1]+_0x5378be*0x3)),_0xa9eeb5[_0x4d7839+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x4d7839+0x2]+_0x3184fb*0x3));}const _0x47f838=_0x4cc499+_0x3cc006*0x4*0x2;_0xa9eeb5[_0x47f838]=Math['min'](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x47f838]+_0x5cf13c*0x5)),_0xa9eeb5[_0x47f838+0x1]=Math[_0x17d000(0x330)](0xff,Math['max'](0x0,_0xa9eeb5[_0x47f838+0x1]+_0x5378be*0x5)),_0xa9eeb5[_0x47f838+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x47f838+0x2]+_0x3184fb*0x5));if(_0x43dc4f+0x1<_0x3cc006){const _0x5b2dcf=_0x4cc499+_0x3cc006*0x4*0x2+0x4;_0xa9eeb5[_0x5b2dcf]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x5b2dcf]+_0x5cf13c*0x3)),_0xa9eeb5[_0x5b2dcf+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x5b2dcf+0x1]+_0x5378be*0x3)),_0xa9eeb5[_0x5b2dcf+0x2]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x5b2dcf+0x2]+_0x3184fb*0x3));}if(_0x43dc4f+0x2<_0x3cc006){const _0x23ce3d=_0x4cc499+_0x3cc006*0x4*0x2+0x8;_0xa9eeb5[_0x23ce3d]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x23ce3d]+_0x5cf13c*0x1)),_0xa9eeb5[_0x23ce3d+0x1]=Math[_0x17d000(0x330)](0xff,Math[_0x17d000(0x203)](0x0,_0xa9eeb5[_0x23ce3d+0x1]+_0x5378be*0x1)),_0xa9eeb5[_0x23ce3d+0x2]=Math[_0x17d000(0x330)](0xff,Math['max'](0x0,_0xa9eeb5[_0x23ce3d+0x2]+_0x3184fb*0x1));}}}}for(let _0x56b794=0x0;_0x56b794<_0x28c718;_0x56b794++){for(let _0x5aaecc=0x0;_0x5aaecc<_0x3cc006;_0x5aaecc++){const _0x2c8a52=(_0x56b794*_0x3cc006+_0x5aaecc)*0x4,_0xc71880=_0xa9eeb5[_0x2c8a52],_0x21bb65=_0xa9eeb5[_0x2c8a52+0x1],_0x577a78=_0xa9eeb5[_0x2c8a52+0x2],_0x32e01d=findClosestColor(_0xc71880,_0x21bb65,_0x577a78,_0x567779);_0x2d2903[_0x2c8a52]=_0x32e01d['r'],_0x2d2903[_0x2c8a52+0x1]=_0x32e01d['g'],_0x2d2903[_0x2c8a52+0x2]=_0x32e01d['b'];}}return _0x53e746;}};function floydSteinbergDither(_0x435ea2,_0x217c0e,_0x1cb35a){const _0x2ddf7a=_0x4a9634,_0x2685de=_0x435ea2[_0x2ddf7a(0x26a)],_0x51bc58=_0x435ea2['height'],_0x734db2=_0x435ea2[_0x2ddf7a(0x218)],_0x12b9f6=new Uint8ClampedArray(_0x734db2);for(let _0x46dc84=0x0;_0x46dc84<_0x51bc58;_0x46dc84++){for(let _0x562c0f=0x0;_0x562c0f<_0x2685de;_0x562c0f++){const _0x1fd83c=(_0x46dc84*_0x2685de+_0x562c0f)*0x4,_0x5defcc=_0x12b9f6[_0x1fd83c],_0x13fc47=_0x12b9f6[_0x1fd83c+0x1],_0x4a96ab=_0x12b9f6[_0x1fd83c+0x2],_0x5ca858=findClosestColor(_0x5defcc,_0x13fc47,_0x4a96ab,_0x1cb35a),_0x50b7a7=(_0x5defcc-_0x5ca858['r'])*_0x217c0e,_0x5120a7=(_0x13fc47-_0x5ca858['g'])*_0x217c0e,_0xa59635=(_0x4a96ab-_0x5ca858['b'])*_0x217c0e;if(_0x562c0f+0x1<_0x2685de){const _0x48f7d6=_0x1fd83c+0x4;_0x12b9f6[_0x48f7d6]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x48f7d6]+_0x50b7a7*0x7/0x10)),_0x12b9f6[_0x48f7d6+0x1]=Math[_0x2ddf7a(0x330)](0xff,Math['max'](0x0,_0x12b9f6[_0x48f7d6+0x1]+_0x5120a7*0x7/0x10)),_0x12b9f6[_0x48f7d6+0x2]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x48f7d6+0x2]+_0xa59635*0x7/0x10));}if(_0x46dc84+0x1<_0x51bc58){if(_0x562c0f>0x0){const _0x447d98=_0x1fd83c+_0x2685de*0x4-0x4;_0x12b9f6[_0x447d98]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x447d98]+_0x50b7a7*0x3/0x10)),_0x12b9f6[_0x447d98+0x1]=Math[_0x2ddf7a(0x330)](0xff,Math['max'](0x0,_0x12b9f6[_0x447d98+0x1]+_0x5120a7*0x3/0x10)),_0x12b9f6[_0x447d98+0x2]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x447d98+0x2]+_0xa59635*0x3/0x10));}const _0xa1fe71=_0x1fd83c+_0x2685de*0x4;_0x12b9f6[_0xa1fe71]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0xa1fe71]+_0x50b7a7*0x5/0x10)),_0x12b9f6[_0xa1fe71+0x1]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0xa1fe71+0x1]+_0x5120a7*0x5/0x10)),_0x12b9f6[_0xa1fe71+0x2]=Math['min'](0xff,Math['max'](0x0,_0x12b9f6[_0xa1fe71+0x2]+_0xa59635*0x5/0x10));if(_0x562c0f+0x1<_0x2685de){const _0x171de4=_0x1fd83c+_0x2685de*0x4+0x4;_0x12b9f6[_0x171de4]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x171de4]+_0x50b7a7*0x1/0x10)),_0x12b9f6[_0x171de4+0x1]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x171de4+0x1]+_0x5120a7*0x1/0x10)),_0x12b9f6[_0x171de4+0x2]=Math[_0x2ddf7a(0x330)](0xff,Math[_0x2ddf7a(0x203)](0x0,_0x12b9f6[_0x171de4+0x2]+_0xa59635*0x1/0x10));}}}}for(let _0x2404d8=0x0;_0x2404d8<_0x51bc58;_0x2404d8++){for(let _0x39b0c7=0x0;_0x39b0c7<_0x2685de;_0x39b0c7++){const _0x59350c=(_0x2404d8*_0x2685de+_0x39b0c7)*0x4,_0x21c091=_0x12b9f6[_0x59350c],_0xef0bae=_0x12b9f6[_0x59350c+0x1],_0x24f82d=_0x12b9f6[_0x59350c+0x2],_0x10dfda=findClosestColor(_0x21c091,_0xef0bae,_0x24f82d,_0x1cb35a);_0x734db2[_0x59350c]=_0x10dfda['r'],_0x734db2[_0x59350c+0x1]=_0x10dfda['g'],_0x734db2[_0x59350c+0x2]=_0x10dfda['b'];}}return _0x435ea2;}function processImage1(_0x4e2478,_0x17e6d8,_0x37a25d,_0x3d41b2,_0x2d9048,_0xa36e1e,_0x5d0555){const _0x50a420=_0x4a9634,_0x4b64fa=new ImageData(new Uint8ClampedArray(_0x4e2478[_0x50a420(0x218)]),_0x4e2478[_0x50a420(0x26a)],_0x4e2478[_0x50a420(0x1f5)]);return adjustBrightness(_0x4b64fa,_0x17e6d8),adjustContrast(_0x4b64fa,_0x37a25d),adjustSaturation(_0x4b64fa,_0x3d41b2),DitherAlgorithms[_0x5d0555]?DitherAlgorithms[_0x5d0555](_0x4b64fa,_0x2d9048,_0xa36e1e):floydSteinbergDither(_0x4b64fa,_0x2d9048,_0xa36e1e),_0x4b64fa;}function imageDataToEpdBytes(_0x182d69,_0x36721f){const _0x1b99dc=_0x4a9634,_0x4ab96a=_0x182d69[_0x1b99dc(0x26a)],_0x2871b1=_0x182d69['height'],_0x3caf66=_0x182d69[_0x1b99dc(0x218)];let _0x287fa6;if(_0x36721f===_0x1b99dc(0x231)){_0x287fa6=new Uint8Array(Math['ceil'](_0x4ab96a*_0x2871b1/0x8)*0x2);let _0x59af2d=0x0,_0xff8e7b=Math[_0x1b99dc(0x204)](_0x4ab96a*_0x2871b1/0x8),_0x5b3fbb=0x0,_0x590d01=0x0,_0x1b5ef5=0x0;for(let _0x31eabd=0x0;_0x31eabd<_0x3caf66[_0x1b99dc(0x29e)];_0x31eabd+=0x4){const _0x502d1e=_0x3caf66[_0x31eabd],_0x429e5d=_0x3caf66[_0x31eabd+0x1],_0x1b224c=_0x3caf66[_0x31eabd+0x2],_0x357326=_0x502d1e>0xc8&&_0x429e5d<0x32&&_0x1b224c<0x32,_0x1bc62b=!_0x357326&&0.299*_0x502d1e+0.587*_0x429e5d+0.114*_0x1b224c<0x80;_0x1bc62b&&(_0x590d01|=0x1<<0x7-_0x5b3fbb),_0x357326&&(_0x1b5ef5|=0x1<<0x7-_0x5b3fbb),_0x5b3fbb++,_0x5b3fbb===0x8&&(_0x287fa6[_0x59af2d++]=_0x590d01,_0x287fa6[_0xff8e7b++]=_0x1b5ef5,_0x5b3fbb=0x0,_0x590d01=0x0,_0x1b5ef5=0x0);}_0x5b3fbb>0x0&&(_0x287fa6[_0x59af2d]=_0x590d01,_0x287fa6[_0xff8e7b]=_0x1b5ef5);}else{_0x287fa6=new Uint8Array(Math[_0x1b99dc(0x204)](_0x4ab96a*_0x2871b1/0x8));let _0x39257d=0x0,_0x44e812=0x0,_0x31c417=0x0;for(let _0x20896a=0x0;_0x20896a<_0x3caf66[_0x1b99dc(0x29e)];_0x20896a+=0x4){const _0x2a97e5=_0x3caf66[_0x20896a],_0x18d0ac=_0x3caf66[_0x20896a+0x1],_0x57a2ce=_0x3caf66[_0x20896a+0x2],_0x575173=0.299*_0x2a97e5+0.587*_0x18d0ac+0.114*_0x57a2ce<0x80;_0x575173&&(_0x31c417|=0x1<<0x7-_0x44e812),_0x44e812++,_0x44e812===0x8&&(_0x287fa6[_0x39257d++]=_0x31c417,_0x44e812=0x0,_0x31c417=0x0);}_0x44e812>0x0&&(_0x287fa6[_0x39257d]=_0x31c417);}return _0x287fa6;}const imageUpload=document[_0x4a9634(0x2d1)](_0x4a9634(0x221)),previewCanvas=document[_0x4a9634(0x2d1)](_0x4a9634(0x297)),floatPreviewCanvas=document[_0x4a9634(0x2d1)]('floatPreviewCanvas'),noImagePlaceholder=document[_0x4a9634(0x2d1)](_0x4a9634(0x245)),processedImageInfo=document[_0x4a9634(0x2d1)](_0x4a9634(0x241)),btnProcess=document['getElementById'](_0x4a9634(0x31f)),btnSend=document[_0x4a9634(0x2d1)](_0x4a9634(0x28f)),btnDownload=document['getElementById']('btnDownload'),btnReset=document[_0x4a9634(0x2d1)](_0x4a9634(0x23c)),btnClearLog=document[_0x4a9634(0x2d1)](_0x4a9634(0x2a3)),btnBlackWhite=document[_0x4a9634(0x2d1)](_0x4a9634(0x286)),btnBlackWhiteRed=document[_0x4a9634(0x2d1)]('btnBlackWhiteRed'),ditherMode=document[_0x4a9634(0x2d1)]('ditherMode'),ditherAlg=document['getElementById'](_0x4a9634(0x280)),logContainer=document['getElementById'](_0x4a9634(0x244)),statusContainer=document[_0x4a9634(0x2d1)](_0x4a9634(0x263)),floatingCanvasContainer=document[_0x4a9634(0x2d1)](_0x4a9634(0x2cb)),toggleCanvasFloat=document[_0x4a9634(0x2d1)](_0x4a9634(0x1f2)),closeCanvas=document[_0x4a9634(0x2d1)](_0x4a9634(0x2d0)),canvasResizeHandle=document[_0x4a9634(0x2d1)](_0x4a9634(0x329)),imageScaleSlider=document['getElementById'](_0x4a9634(0x250)),imageScaleValue=document[_0x4a9634(0x2d1)](_0x4a9634(0x31a)),addTextBtn=document[_0x4a9634(0x2d1)]('addTextBtn'),timeDialog=document[_0x4a9634(0x2d1)]('timeDialog'),datetimeInput=document[_0x4a9634(0x2d1)]('datetimeInput'),closeTimeDialog=document[_0x4a9634(0x2d1)](_0x4a9634(0x2c2)),confirmTimeBtn=document[_0x4a9634(0x2d1)](_0x4a9634(0x1f7)),imageWidthInput=document[_0x4a9634(0x2d1)](_0x4a9634(0x275)),imageHeightInput=document[_0x4a9634(0x2d1)](_0x4a9634(0x20f)),toolPen=document[_0x4a9634(0x2d1)](_0x4a9634(0x207)),toolEraser=document[_0x4a9634(0x2d1)](_0x4a9634(0x2ab)),toolText=document[_0x4a9634(0x2d1)](_0x4a9634(0x327)),toolClear=document['getElementById'](_0x4a9634(0x2d9)),brushSizeSlider=document[_0x4a9634(0x2d1)](_0x4a9634(0x1ff)),fontSizeInput=document[_0x4a9634(0x2d1)](_0x4a9634(0x2b3)),fontFamilySelect=document[_0x4a9634(0x2d1)](_0x4a9634(0x225)),textInput=document[_0x4a9634(0x2d1)](_0x4a9634(0x32a)),drawingStatus=document[_0x4a9634(0x2d1)](_0x4a9634(0x249)),currentToolEl=document[_0x4a9634(0x2d1)]('currentTool'),currentSizeEl=document[_0x4a9634(0x2d1)](_0x4a9634(0x2fd)),drawingModeIndicator=document[_0x4a9634(0x2d1)](_0x4a9634(0x28b)),toggleDrawingModeBtn=document['getElementById'](_0x4a9634(0x2df)),floatToggleDrawingModeBtn=document[_0x4a9634(0x2d1)](_0x4a9634(0x27e)),sliders={'saturation':document['getElementById']('saturation'),'brightness':document[_0x4a9634(0x2d1)](_0x4a9634(0x2e9)),'contrast':document['getElementById'](_0x4a9634(0x20a)),'diffusion':document['getElementById']('diffusion')},ditherSlider=document['getElementById']('dither-strength'),sliderValues={'saturation':document['getElementById'](_0x4a9634(0x2f0)),'brightness':document['getElementById'](_0x4a9634(0x1f4)),'contrast':document[_0x4a9634(0x2d1)]('contrastValue'),'diffusion':document[_0x4a9634(0x2d1)](_0x4a9634(0x31e))};function init(){const _0x2a4e28=_0x4a9634;canvas=previewCanvas,ctx=canvas['getContext']('2d'),floatCanvas=floatPreviewCanvas,floatCtx=floatCanvas[_0x2a4e28(0x2b7)]('2d'),updateCanvasSize();const _0x18d467=new Date(),_0x71d11=new Date(_0x18d467['getTime']()-_0x18d467[_0x2a4e28(0x1e3)]()*0xea60)[_0x2a4e28(0x20e)]()[_0x2a4e28(0x1e0)](0x0,0x10);datetimeInput[_0x2a4e28(0x2a4)]=_0x71d11,canvas[_0x2a4e28(0x2a0)](_0x2a4e28(0x208),startDrawing),canvas[_0x2a4e28(0x2a0)]('mousemove',draw),canvas['addEventListener'](_0x2a4e28(0x1e6),stopDrawing),canvas[_0x2a4e28(0x2a0)]('mouseout',stopDrawing),floatCanvas[_0x2a4e28(0x2a0)](_0x2a4e28(0x208),startDrawingFloat),floatCanvas['addEventListener'](_0x2a4e28(0x278),drawFloat),floatCanvas[_0x2a4e28(0x2a0)]('mouseup',stopDrawing),floatCanvas['addEventListener'](_0x2a4e28(0x20b),stopDrawing),canvas[_0x2a4e28(0x2a0)](_0x2a4e28(0x20c),handleTouchStart,{'passive':![]}),canvas[_0x2a4e28(0x2a0)](_0x2a4e28(0x299),handleTouchMove,{'passive':![]}),canvas[_0x2a4e28(0x2a0)](_0x2a4e28(0x22c),handleTouchEnd),canvas['addEventListener']('touchcancel',handleTouchEnd),floatCanvas['addEventListener'](_0x2a4e28(0x20c),handleFloatTouchStart,{'passive':![]}),floatCanvas[_0x2a4e28(0x2a0)]('touchmove',handleFloatTouchMove,{'passive':![]}),floatCanvas[_0x2a4e28(0x2a0)](_0x2a4e28(0x22c),handleTouchEnd),floatCanvas[_0x2a4e28(0x2a0)]('touchcancel',handleTouchEnd),document[_0x2a4e28(0x2a0)](_0x2a4e28(0x30c),_0x16b9c5=>{const _0x22c018=_0x2a4e28;_0x16b9c5[_0x22c018(0x1e4)]===_0x22c018(0x2da)&&(shiftKeyPressed=!![],sourceImage&&!isDrawingModeActive&&(canvas[_0x22c018(0x2f9)]['cursor']='move',floatCanvas[_0x22c018(0x2f9)][_0x22c018(0x32c)]=_0x22c018(0x237)));}),document[_0x2a4e28(0x2a0)]('keyup',_0x29967e=>{const _0x13a9d4=_0x2a4e28;_0x29967e[_0x13a9d4(0x1e4)]===_0x13a9d4(0x2da)&&(shiftKeyPressed=![],updateCursorStyle());}),toggleDrawingModeBtn[_0x2a4e28(0x2a0)](_0x2a4e28(0x2e4),toggleDrawingMode),floatToggleDrawingModeBtn[_0x2a4e28(0x2a0)](_0x2a4e28(0x2e4),toggleDrawingMode),btnProcess[_0x2a4e28(0x2a0)](_0x2a4e28(0x2e4),processImage),btnSend['addEventListener'](_0x2a4e28(0x2e4),sendimg),btnDownload[_0x2a4e28(0x2a0)](_0x2a4e28(0x2e4),downloadImageFile),btnReset['addEventListener'](_0x2a4e28(0x2e4),resetProcessing),btnClearLog[_0x2a4e28(0x2a0)](_0x2a4e28(0x2e4),clearLog),toggleCanvasFloat['addEventListener'](_0x2a4e28(0x2e4),toggleCanvas),closeCanvas['addEventListener'](_0x2a4e28(0x2e4),hideCanvas),btnSetTime[_0x2a4e28(0x2a0)]('click',showTimeDialog),closeTimeDialog[_0x2a4e28(0x2a0)](_0x2a4e28(0x2e4),hideTimeDialog),confirmTimeBtn['addEventListener'](_0x2a4e28(0x2e4),setTime),brushSizeSlider[_0x2a4e28(0x2a0)](_0x2a4e28(0x2d4),function(){const _0x1cf6a0=_0x2a4e28;brushSize=parseInt(this['value']),currentSizeEl[_0x1cf6a0(0x2b6)]=brushSize;});const _0x33d23c=floatingCanvasContainer[_0x2a4e28(0x23a)](_0x2a4e28(0x26c));_0x33d23c[_0x2a4e28(0x2a0)](_0x2a4e28(0x208),startDrag),document['addEventListener'](_0x2a4e28(0x278),drag),document[_0x2a4e28(0x2a0)](_0x2a4e28(0x1e6),stopDrag),canvasResizeHandle['addEventListener'](_0x2a4e28(0x208),startResize),document[_0x2a4e28(0x2a0)](_0x2a4e28(0x278),resize),document[_0x2a4e28(0x2a0)](_0x2a4e28(0x1e6),stopResize),Object[_0x2a4e28(0x285)](sliders)[_0x2a4e28(0x261)](_0x3da62a=>{const _0x14c745=_0x2a4e28;sliders[_0x3da62a][_0x14c745(0x2a0)](_0x14c745(0x2d4),_0x556b10=>{const _0x1e9fde=_0x14c745;currentParams[_0x3da62a]=parseInt(_0x556b10[_0x1e9fde(0x243)]['value']),sliderValues[_0x3da62a][_0x1e9fde(0x2b6)]=''+currentParams[_0x3da62a];});}),document[_0x2a4e28(0x2d1)](_0x2a4e28(0x23f))[_0x2a4e28(0x2a0)](_0x2a4e28(0x219),function(){const _0x54329b=_0x2a4e28,_0x327404=getSelectedCanvasSize();imageWidthInput[_0x54329b(0x2a4)]=_0x327404[_0x54329b(0x26a)],imageHeightInput['value']=_0x327404[_0x54329b(0x1f5)];}),addLog(_0x2a4e28(0x333)),updateButtonStatus();}function toggleDrawingMode(){const _0x2e83df=_0x4a9634;isDrawingModeActive=!isDrawingModeActive,isDrawingModeActive?(toggleDrawingModeBtn[_0x2e83df(0x25d)]=_0x2e83df(0x2b2),toggleDrawingModeBtn['classList'][_0x2e83df(0x24e)]('bg-primary'),toggleDrawingModeBtn[_0x2e83df(0x2a7)][_0x2e83df(0x282)](_0x2e83df(0x2bc)),floatToggleDrawingModeBtn[_0x2e83df(0x25d)]=_0x2e83df(0x2b2),floatToggleDrawingModeBtn[_0x2e83df(0x2a7)][_0x2e83df(0x282)](_0x2e83df(0x335)),drawingModeIndicator[_0x2e83df(0x2a7)][_0x2e83df(0x24e)](_0x2e83df(0x240)),addLog(_0x2e83df(0x27d))):(toggleDrawingModeBtn[_0x2e83df(0x25d)]='<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画',toggleDrawingModeBtn[_0x2e83df(0x2a7)][_0x2e83df(0x24e)](_0x2e83df(0x2bc)),toggleDrawingModeBtn[_0x2e83df(0x2a7)][_0x2e83df(0x282)]('bg-primary'),floatToggleDrawingModeBtn[_0x2e83df(0x25d)]=_0x2e83df(0x1fb),floatToggleDrawingModeBtn['classList'][_0x2e83df(0x24e)]('text-amber-300'),drawingModeIndicator[_0x2e83df(0x2a7)][_0x2e83df(0x282)]('hidden'),addLog(_0x2e83df(0x2b1))),updateCursorStyle();}function updateCursorStyle(){const _0xc3e8ce=_0x4a9634;if(isDrawingModeActive){if(currentTool==='pen')canvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]='crosshair',floatCanvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x293);else{if(currentTool===_0xc3e8ce(0x291))canvas['style']['cursor']=_0xc3e8ce(0x25b),floatCanvas['style'][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x25b);else currentTool===_0xc3e8ce(0x2d2)&&(canvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x2d2),floatCanvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]='text');}}else{if(shiftKeyPressed&&sourceImage)canvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x237),floatCanvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x237);else{if(currentTool===_0xc3e8ce(0x200))canvas[_0xc3e8ce(0x2f9)]['cursor']=_0xc3e8ce(0x293),floatCanvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x293);else{if(currentTool===_0xc3e8ce(0x291))canvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]='url(\x22data:image/svg+xml,%3Csvg\x20xmlns=\x27http://www.w3.org/2000/svg\x27\x20width=\x2724\x27\x20height=\x2724\x27\x20viewBox=\x270\x200\x2024\x2024\x27\x20fill=\x27none\x27\x20stroke=\x27black\x27\x20stroke-width=\x272\x27\x20stroke-linecap=\x27round\x27\x20stroke-linejoin=\x27round\x27%3E%3Cpath\x20d=\x27M18\x2013L5\x205\x27/%3E%3C/svg%3E\x22)\x200\x2024,\x20auto',floatCanvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]=_0xc3e8ce(0x25b);else currentTool===_0xc3e8ce(0x2d2)&&(canvas[_0xc3e8ce(0x2f9)]['cursor']=_0xc3e8ce(0x2d2),floatCanvas[_0xc3e8ce(0x2f9)][_0xc3e8ce(0x32c)]='text');}}}}function setDrawingTool(_0x41227a){const _0x407e65=_0x4a9634;currentTool=_0x41227a,[toolPen,toolEraser,toolText,toolClear][_0x407e65(0x261)](_0x2655b3=>{const _0x1c6dd1=_0x407e65;_0x2655b3['classList'][_0x1c6dd1(0x24e)](_0x1c6dd1(0x30d));});switch(_0x41227a){case _0x407e65(0x200):toolPen[_0x407e65(0x2a7)][_0x407e65(0x282)](_0x407e65(0x30d)),currentToolEl[_0x407e65(0x2b6)]='画笔';break;case _0x407e65(0x291):toolEraser['classList'][_0x407e65(0x282)](_0x407e65(0x30d)),currentToolEl['textContent']=_0x407e65(0x251);break;case _0x407e65(0x2d2):toolText[_0x407e65(0x2a7)][_0x407e65(0x282)](_0x407e65(0x30d)),currentToolEl[_0x407e65(0x2b6)]='文字';break;}currentSizeEl[_0x407e65(0x2b6)]=brushSize,drawingStatus[_0x407e65(0x2a7)][_0x407e65(0x24e)](_0x407e65(0x240)),updateCursorStyle();}function setBrushColor(_0x1fd574){const _0x37a70f=_0x4a9634;brushColor=_0x1fd574,document[_0x37a70f(0x2d1)]('customColor')[_0x37a70f(0x2a4)]=_0x1fd574,addLog(_0x37a70f(0x2ce)+_0x1fd574);}function getCanvasCoordinates(_0x3467c5,_0x5a4752,_0xde85f1=![]){const _0x5c8fb4=_0x4a9634,_0x3f53d0=_0x3467c5['getBoundingClientRect'](),_0x6766b0=_0x3467c5[_0x5c8fb4(0x26a)]/_0x3f53d0[_0x5c8fb4(0x26a)],_0x4ea5a8=_0x3467c5[_0x5c8fb4(0x1f5)]/_0x3f53d0[_0x5c8fb4(0x1f5)];let _0x5a1cb4,_0x30536f;return _0xde85f1?(_0x5a1cb4=(_0x5a4752['touches'][0x0][_0x5c8fb4(0x247)]-_0x3f53d0[_0x5c8fb4(0x32e)])*_0x6766b0,_0x30536f=(_0x5a4752[_0x5c8fb4(0x2fc)][0x0]['clientY']-_0x3f53d0['top'])*_0x4ea5a8):(_0x5a1cb4=(_0x5a4752[_0x5c8fb4(0x247)]-_0x3f53d0[_0x5c8fb4(0x32e)])*_0x6766b0,_0x30536f=(_0x5a4752[_0x5c8fb4(0x29d)]-_0x3f53d0['top'])*_0x4ea5a8),{'x':_0x5a1cb4,'y':_0x30536f};}function isPointOnImage(_0xf4e55c,_0x1caf12){const _0x369302=_0x4a9634;if(!sourceImage)return![];const _0x332df2=imageScale/0x64;let _0x1a2639=sourceImage[_0x369302(0x26a)]*_0x332df2,_0x1334ad=sourceImage[_0x369302(0x1f5)]*_0x332df2;return imageRotation%0xb4!==0x0&&([_0x1a2639,_0x1334ad]=[_0x1334ad,_0x1a2639]),_0xf4e55c>=imageOffset['x']&&_0xf4e55c<=imageOffset['x']+_0x1a2639&&_0x1caf12>=imageOffset['y']&&_0x1caf12<=imageOffset['y']+_0x1334ad;}function startDrawing(_0x1a29f3){const _0x51f0f5=getCanvasCoordinates(canvas,_0x1a29f3);startDrawingCommon(_0x51f0f5);}function startDrawingFloat(_0x3e9d1b){const _0x27d8bf=getCanvasCoordinates(floatCanvas,_0x3e9d1b);startDrawingCommon(_0x27d8bf);}function handleTouchStart(_0x4540d3){const _0x57551e=_0x4a9634;_0x4540d3['preventDefault']();if(_0x4540d3[_0x57551e(0x2fc)][_0x57551e(0x29e)]!==0x1)return;const _0x965072=getCanvasCoordinates(canvas,_0x4540d3,!![]);startDrawingCommon(_0x965072);}function handleFloatTouchStart(_0x269de9){const _0x1f04ef=_0x4a9634;_0x269de9[_0x1f04ef(0x29c)]();if(_0x269de9[_0x1f04ef(0x2fc)][_0x1f04ef(0x29e)]!==0x1)return;const _0x5cc6d9=getCanvasCoordinates(floatCanvas,_0x269de9,!![]);startDrawingCommon(_0x5cc6d9);}function startDrawingCommon(_0x2f36d1){const _0x2eb43b=_0x4a9634;lastX=_0x2f36d1['x'],lastY=_0x2f36d1['y'],isDrawing=!![];if(!isDrawingModeActive&&sourceImage&&(isPointOnImage(_0x2f36d1['x'],_0x2f36d1['y'])&&currentTool!==_0x2eb43b(0x2d2)))isDraggingImage=!![],dragStartPos={'x':_0x2f36d1['x'],'y':_0x2f36d1['y']},isDrawing=![],canvas['style'][_0x2eb43b(0x32c)]=_0x2eb43b(0x237),floatCanvas[_0x2eb43b(0x2f9)]['cursor']=_0x2eb43b(0x237);else currentTool===_0x2eb43b(0x2d2)&&(addTextToCanvas(_0x2f36d1['x'],_0x2f36d1['y']),isDrawing=![]);}function draw(_0x212ef4){const _0x473dc7=getCanvasCoordinates(canvas,_0x212ef4);drawCommon(_0x473dc7);}function drawFloat(_0x348b02){const _0x119a7d=getCanvasCoordinates(floatCanvas,_0x348b02);drawCommon(_0x119a7d);}function handleTouchMove(_0x4eddae){const _0x1a40aa=_0x4a9634;_0x4eddae[_0x1a40aa(0x29c)]();if(_0x4eddae[_0x1a40aa(0x2fc)]['length']!==0x1)return;const _0x3617aa=getCanvasCoordinates(canvas,_0x4eddae,!![]);drawCommon(_0x3617aa);}function handleFloatTouchMove(_0x102360){const _0x1792b6=_0x4a9634;_0x102360[_0x1792b6(0x29c)]();if(_0x102360[_0x1792b6(0x2fc)][_0x1792b6(0x29e)]!==0x1)return;const _0x1195ae=getCanvasCoordinates(floatCanvas,_0x102360,!![]);drawCommon(_0x1195ae);}function drawCommon(_0x4645c2){if(isDraggingImage&&!isDrawingModeActive){const _0x361002=_0x4645c2['x']-dragStartPos['x'],_0x463b56=_0x4645c2['y']-dragStartPos['y'];imageOffset['x']+=_0x361002,imageOffset['y']+=_0x463b56,dragStartPos=_0x4645c2,redrawImageWithScaleAndOffset();return;}if(!isDrawing)return;drawOnCanvas(lastX,lastY,_0x4645c2['x'],_0x4645c2['y']),lastX=_0x4645c2['x'],lastY=_0x4645c2['y'],syncCanvases();}function stopDrawing(){isDrawing=![],isDraggingImage&&(isDraggingImage=![],updateCursorStyle());}function handleTouchEnd(){stopDrawing();}function drawOnCanvas(_0x176708,_0xbf0e92,_0x489348,_0x55c7bb){const _0x11264e=_0x4a9634;ctx[_0x11264e(0x294)](),ctx[_0x11264e(0x2dc)]=_0x11264e(0x2d7),ctx[_0x11264e(0x2aa)]='round',ctx[_0x11264e(0x302)]=brushSize;if(currentTool==='pen')ctx[_0x11264e(0x262)]=brushColor;else currentTool==='eraser'&&(ctx['strokeStyle']='#FFFFFF',ctx['lineWidth']=brushSize*0x2);ctx['beginPath'](),ctx[_0x11264e(0x227)](_0x176708,_0xbf0e92),ctx['lineTo'](_0x489348,_0x55c7bb),ctx[_0x11264e(0x2ba)](),ctx['restore']();}function addTextToCanvas(_0x18e7ec,_0x52b361){const _0x10e0f8=_0x4a9634,_0x108439=textInput[_0x10e0f8(0x2a4)]||_0x10e0f8(0x305),_0x1ae99c=parseInt(fontSizeInput[_0x10e0f8(0x2a4)]),_0x2d7967=fontFamilySelect[_0x10e0f8(0x2a4)];if(!_0x108439['trim']())return;ctx[_0x10e0f8(0x294)](),ctx[_0x10e0f8(0x26d)]=_0x1ae99c+_0x10e0f8(0x321)+_0x2d7967,ctx[_0x10e0f8(0x22a)]=brushColor,ctx[_0x10e0f8(0x1d9)]=_0x10e0f8(0x2ca),ctx[_0x10e0f8(0x2e7)](_0x108439,_0x18e7ec,_0x52b361),ctx[_0x10e0f8(0x256)](),syncCanvases(),addLog(_0x10e0f8(0x2fb)+_0x108439+'\x22');}function addTextManually(){const _0x2a32ef=_0x4a9634;setDrawingTool('text');if(textInput[_0x2a32ef(0x2a4)][_0x2a32ef(0x222)]()){const _0x209d78=getSelectedCanvasSize(),_0x316441=_0x209d78[_0x2a32ef(0x26a)]/0x2,_0x5a6e2b=_0x209d78['height']/0x2;addTextToCanvas(_0x316441,_0x5a6e2b);}else addLog(_0x2a32ef(0x306));}function clearCanvas(){const _0x2e4f9b=_0x4a9634;confirm(_0x2e4f9b(0x22b))&&(ctx['save'](),ctx['fillStyle']=_0x2e4f9b(0x272),ctx[_0x2e4f9b(0x2c3)](0x0,0x0,canvas['width'],canvas[_0x2e4f9b(0x1f5)]),ctx[_0x2e4f9b(0x256)](),syncCanvases(),addLog(_0x2e4f9b(0x27f)));}function syncCanvases(){const _0x2ae861=_0x4a9634;floatCtx['clearRect'](0x0,0x0,floatCanvas['width'],floatCanvas[_0x2ae861(0x1f5)]),floatCtx[_0x2ae861(0x1da)](canvas,0x0,0x0);}function changeImageScale(_0x201d21){const _0x1736b9=_0x4a9634;if(!sourceImage)return;imageScale=Math[_0x1736b9(0x203)](0x0,Math[_0x1736b9(0x330)](0x3e8,imageScale+_0x201d21)),imageScaleSlider[_0x1736b9(0x2a4)]=imageScale,updateImageScale();}function updateImageScale(){if(!sourceImage)return;imageScale=parseInt(imageScaleSlider['value']),imageScaleValue['textContent']=imageScale+'%',redrawImageWithScaleAndOffset();}function redrawImageWithScaleAndOffset(){const _0x96b5fb=_0x4a9634;if(!sourceImage)return;ctx[_0x96b5fb(0x22a)]=_0x96b5fb(0x272),ctx['fillRect'](0x0,0x0,canvas[_0x96b5fb(0x26a)],canvas[_0x96b5fb(0x1f5)]);const _0x171e53=imageScale/0x64;let _0x2669b1=sourceImage[_0x96b5fb(0x26a)]*_0x171e53,_0x1314a9=sourceImage['height']*_0x171e53;ctx[_0x96b5fb(0x294)](),ctx[_0x96b5fb(0x296)](imageOffset['x']+_0x2669b1/0x2,imageOffset['y']+_0x1314a9/0x2),ctx[_0x96b5fb(0x295)](imageRotation*Math['PI']/0xb4),imageRotation%0xb4!==0x0&&([_0x2669b1,_0x1314a9]=[_0x1314a9,_0x2669b1]),ctx[_0x96b5fb(0x1da)](sourceImage,-_0x2669b1/0x2,-_0x1314a9/0x2,_0x2669b1,_0x1314a9),ctx['restore'](),syncCanvases();}function fitImageToCanvas(){const _0x5e546e=_0x4a9634;if(!sourceImage)return;const _0x4b643d=getSelectedCanvasSize();let _0x168898=_0x4b643d[_0x5e546e(0x26a)],_0x4b919a=_0x4b643d[_0x5e546e(0x1f5)];const _0x152553=_0x168898/sourceImage[_0x5e546e(0x26a)],_0x259f79=_0x4b919a/sourceImage[_0x5e546e(0x1f5)],_0x407ed3=Math['min'](_0x152553,_0x259f79);imageScale=_0x407ed3*0x64,imageScaleSlider['value']=imageScale,imageScaleValue['textContent']=imageScale[_0x5e546e(0x21c)](0x0)+'%',imageOffset['x']=(_0x168898-sourceImage['width']*_0x407ed3)/0x2,imageOffset['y']=(_0x4b919a-sourceImage[_0x5e546e(0x1f5)]*_0x407ed3)/0x2,redrawImageWithScaleAndOffset(),addLog(_0x5e546e(0x205));}function fillCanvas(){const _0x3d5d93=_0x4a9634;if(!sourceImage)return;const _0x7a176a=getSelectedCanvasSize();let _0x7019fc=_0x7a176a['width'],_0x4fd96b=_0x7a176a[_0x3d5d93(0x1f5)];const _0x4345cf=_0x7019fc/sourceImage[_0x3d5d93(0x26a)],_0x1b1308=_0x4fd96b/sourceImage[_0x3d5d93(0x1f5)];imageScale=Math[_0x3d5d93(0x203)](_0x4345cf,_0x1b1308)*0x64,imageScaleSlider[_0x3d5d93(0x2a4)]=imageScale,imageScaleValue[_0x3d5d93(0x2b6)]=imageScale['toFixed'](0x0)+'%',imageOffset['x']=0x0,imageOffset['y']=0x0,redrawImageWithScaleAndOffset(),addLog(_0x3d5d93(0x283));}function centerImageOnCanvas(){const _0x487c10=_0x4a9634;if(!sourceImage)return;const _0x497204=getSelectedCanvasSize();let _0x49d84c=_0x497204[_0x487c10(0x26a)],_0x1da2b8=_0x497204[_0x487c10(0x1f5)];const _0x3a0cc1=imageScale/0x64;let _0x1c8325=sourceImage['width']*_0x3a0cc1,_0x519b65=sourceImage['height']*_0x3a0cc1;imageRotation%0xb4!==0x0&&([_0x1c8325,_0x519b65]=[_0x519b65,_0x1c8325]),imageOffset['x']=(_0x49d84c-_0x1c8325)/0x2,imageOffset['y']=(_0x1da2b8-_0x519b65)/0x2,redrawImageWithScaleAndOffset(),addLog(_0x487c10(0x326));}function rotateImage(_0x19fe3d){const _0x265417=_0x4a9634;if(!sourceImage){addLog(_0x265417(0x2f8));return;}imageRotation=(imageRotation+_0x19fe3d)%0x168,redrawImageWithScaleAndOffset(),addLog(_0x265417(0x25f)+imageRotation+'°');}function resizeImage(_0x14551b,_0x3ce818){const _0x215011=_0x4a9634;if(!sourceImage||!originalImage)return;const _0x5978e4=originalImage[_0x215011(0x26a)]/originalImage[_0x215011(0x1f5)];let _0x5972a9=sourceImage[_0x215011(0x26a)]+_0x14551b,_0x21ea7d=sourceImage['height']+_0x3ce818;_0x5972a9=Math[_0x215011(0x203)](0x32,_0x5972a9),_0x21ea7d=Math[_0x215011(0x203)](0x32,_0x21ea7d),imageWidthInput['value']=Math[_0x215011(0x2d7)](_0x5972a9),imageHeightInput[_0x215011(0x2a4)]=Math[_0x215011(0x2d7)](_0x21ea7d);const _0x1d7331=new Image();_0x1d7331[_0x215011(0x292)]=function(){const _0x10170a=_0x215011;sourceImage=_0x1d7331,redrawImageWithScaleAndOffset(),addLog(_0x10170a(0x310)+_0x5972a9+'\x20×\x20'+_0x21ea7d);};const _0x240686=document['createElement'](_0x215011(0x2ef));_0x240686['width']=_0x5972a9,_0x240686[_0x215011(0x1f5)]=_0x21ea7d;const _0x1f3ada=_0x240686[_0x215011(0x2b7)]('2d');_0x1f3ada[_0x215011(0x1da)](originalImage,0x0,0x0,_0x5972a9,_0x21ea7d),_0x1d7331[_0x215011(0x28a)]=_0x240686[_0x215011(0x210)]();}function applyImageDimensions(){const _0x42a5ea=_0x4a9634,_0x492fe9=parseInt(imageWidthInput[_0x42a5ea(0x2a4)]),_0x2f3b29=parseInt(imageHeightInput[_0x42a5ea(0x2a4)]);if(isNaN(_0x492fe9)||isNaN(_0x2f3b29)||_0x492fe9<0x32||_0x2f3b29<0x32){addLog(_0x42a5ea(0x236));return;}if(originalImage){const _0x65de6f=new Image();_0x65de6f[_0x42a5ea(0x292)]=function(){const _0x38f137=_0x42a5ea;sourceImage=_0x65de6f,fitImageToCanvas(),addLog(_0x38f137(0x32d)+_0x492fe9+_0x38f137(0x254)+_0x2f3b29);};const _0x56692b=document['createElement'](_0x42a5ea(0x2ef));_0x56692b['width']=_0x492fe9,_0x56692b[_0x42a5ea(0x1f5)]=_0x2f3b29;const _0x1e070e=_0x56692b['getContext']('2d');_0x1e070e['drawImage'](originalImage,0x0,0x0,_0x492fe9,_0x2f3b29),_0x65de6f[_0x42a5ea(0x28a)]=_0x56692b[_0x42a5ea(0x210)]();}else addLog(_0x42a5ea(0x32d)+_0x492fe9+_0x42a5ea(0x254)+_0x2f3b29);}function handleImageUpload(_0x26bff8){const _0x472121=_0x4a9634,_0x1bb507=_0x26bff8['target'][_0x472121(0x26e)][0x0];if(!_0x1bb507)return;document[_0x472121(0x2d1)](_0x472121(0x228))[_0x472121(0x2b6)]=_0x472121(0x2e2)+_0x1bb507[_0x472121(0x265)]+'\x20('+formatFileSize(_0x1bb507['size'])+')',document[_0x472121(0x2d1)](_0x472121(0x228))['classList'][_0x472121(0x24e)](_0x472121(0x240));const _0x5aad28=new FileReader();_0x5aad28[_0x472121(0x292)]=function(_0x4ebb33){const _0x2e173d=_0x472121,_0x35e579=new Image();_0x35e579[_0x2e173d(0x292)]=function(){const _0x2a7071=_0x2e173d;originalImage=new Image(),originalImage[_0x2a7071(0x28a)]=_0x35e579[_0x2a7071(0x28a)],sourceImage=new Image(),sourceImage['src']=_0x35e579[_0x2a7071(0x28a)],imageRotation=0x0,imageWidthInput[_0x2a7071(0x2a4)]=_0x35e579[_0x2a7071(0x26a)],imageHeightInput[_0x2a7071(0x2a4)]=_0x35e579[_0x2a7071(0x1f5)],fitImageToCanvas(),saveOriginalCanvasState(),addLog(_0x2a7071(0x2bf)+_0x1bb507[_0x2a7071(0x265)]),addLog(_0x2a7071(0x1d8)+_0x35e579['width']+'\x20×\x20'+_0x35e579[_0x2a7071(0x1f5)]),addLog(_0x2a7071(0x24f)),updateCanvasVisibility();},_0x35e579['src']=_0x4ebb33['target']['result'];},_0x5aad28['readAsDataURL'](_0x1bb507);}function saveOriginalCanvasState(){const _0x3495a4=_0x4a9634,_0x1cedf5=getSelectedCanvasSize();originalCanvasData=ctx[_0x3495a4(0x324)](0x0,0x0,_0x1cedf5[_0x3495a4(0x26a)],_0x1cedf5[_0x3495a4(0x1f5)]);}function clearLog(){const _0x3a8d78=_0x4a9634;logContainer[_0x3a8d78(0x25d)]='<div\x20class=\x22text-gray-500\x20italic\x22>操作日志将显示在这里...</div>',addLog(_0x3a8d78(0x298));}function _0x4d40(){const _0x1f6352=['NotFoundError','div:first-child','font','files','蓝牙操作异常:\x20','包:\x20','已清空画布，保留设置和图片','#FFFFFF','开始处理图片，使用','floor','imageWidth','e-paper-image-','putImageData','mousemove','D_S_start','1839310ekebjp','D_S_min','fanxian1','已进入绘画模式，图片已锁定无法移动','floatToggleDrawingMode','已清除画布内容','ditherAlg','\x20像素\x20(','add','图片已铺满画布','6363212NRQfQT','keys','btnBlackWhite','text/plain','offsetWidth','scrollHeight','src','drawingModeIndicator','NRF设备(未知名称)','EPD_CMD_J_H','图像文本文件已下载\x20-\x20数据量:\x20','btnSend','12965008YPhkcd','eraser','onload','crosshair','save','rotate','translate','previewCanvas','日志已清除','touchmove','wendu_color','cursor-not-allowed','preventDefault','clientY','length','时间戳:\x20','addEventListener','\x20KB','mb-1\x20border-b\x20border-gray-100\x20pb-1\x20last:border-0\x20last:mb-0\x20last:pb-0','btnClearLog','value','SET_TIME','image','classList','scrollTop','\x20KB)，像素:\x20','lineJoin','toolEraser','push','抖动算法','gattserverdisconnected','IMAGE','653134KysRFr','已退出绘画模式，图片可以移动','<i\x20class=\x22fa\x20fa-stop\x20mr-1\x22></i>退出绘画','fontSize','REFRESH','\x20字节\x20(','textContent','getContext','请先连接蓝牙设备！','calendar','stroke','innerWidth','bg-amber-500','requestDevice','\x20(0x','已加载图片:\x20','正在切换到时钟模式...','href','closeTimeDialog','fillRect','body','.txt',']</span>\x20<span\x20class=\x22text-gray-800\x22>','Atkinson','color_11','ditherMode','top','floatingCanvasContainer','sixColor','map','已选择画笔颜色:\x20','SET_MODE','closeCanvas','getElementById','text','substr','input','原始画布数据传输成功！耗时\x20','3TEfSee','round','then','toolClear','Shift','message','lineCap','EPD_CMD_4_LED','block','toggleDrawingMode','#000000','图片处理完成','文件名:\x20','Stucki','click','\x20MB','startNotifications','fillText','J_S_hour','brightness','jushua_time','已清空墨水屏显示内容','请选择日期和时间','getCharacteristic','22763619zjLYfM','canvas','saturationValue','N_Z_hour','writeValueWithoutResponse','清空屏幕失败:\x20','已经连接到设备，无需重复连接','blackWhiteColor','INIT','蓝牙设备选择失败:\x20','请先上传图片','style','EPD_CMD_D_S','已添加文字:\x20\x22','touches','currentSize','time_color','saturation','getPrimaryService','atkinson','lineWidth','N_Z_start','7.5_800_480','请输入文字','请先输入要添加的文字','已断开连接','EPD_CMD_MY','EPD_CMD_J_S','div','selectedIndex','keydown','active','<i\x20class=\x22fa\x20fa-compress\x20mr-1\x22></i>隐藏画布','pow','图片尺寸已调整为:\x20','display','<i\x20class=\x22fa\x20fa-plug\x20mr-1\x22></i>连接','J_S_start','连接失败:\x20未选择蓝牙设备','r_jushua_time','options','epdpins','toLocaleTimeString','getTime','imageScaleValue','liang_time','catch','createImageData','diffusionValue','btnProcess','32120002-0bf6-448a-9608-1b01a1a8f75c','px\x20','from','32120001-0bf6-448a-9608-1b01a1a8f75c','getImageData','none','图片已居中显示','toolText','6638471TSgOhq','canvasResizeHandle','textInput','传输失败:\x20','cursor','图像尺寸已设置为:\x20','left','appendChild','min','jushua_time1','gongli_color','欢迎使用墨水屏蓝牙图片工具！','已切换到时钟模式','text-amber-300','图片原始尺寸:\x20','textBaseline','drawImage','主机已同步时间！','设置时间失败:\x20','D_S_hour','status','disabled','slice','WRITE_IMG','CLOCK','getTimezoneOffset','key','gatt','mouseup','尝试重新连接设备...','\x20像素','xuanzhuan','writeValueWithResponse','正在传输图片...','算法...','发送失败:\x20','正在清空屏幕...','color_1','正在切换到日历模式...','EPD_CMD_4_ZF','toggleCanvasFloat','getAttribute','brightnessValue','height','NRF_','confirmTimeBtn','opacity-50','传输失败','characteristicvaluechanged','<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画','已设置时间:\x20','padStart','4.2_400_300','brushSize','pen','removeChild','Jarvis-Judice-Ninke','max','ceil','图片已适应画布大小','J_S_min','toolPen','mousedown','connected','contrast','mouseout','touchstart','bluetooth','toISOString','imageHeight','toDataURL','color_led','disconnect','innerHeight','floydSteinberg','download','diffusion','已隐藏浮动画布','data','change','epddriver','已选择设备:\x20','toFixed','createElement','4MLdtgW','请先上传或绘制图像并处理后再下载','toUpperCase','imageFile','trim','moshi_id','已切换到日历模式','fontFamily','liangdu','moveTo','fileInfo','toString','fillStyle','确定要清除画布内容吗？','touchend','toLocaleString','N_Z_min','<i\x20class=\x22fa\x20fa-unplug\x20mr-1\x22></i>断开','EPD_CMD_4_MS','threeColor','connect','contains','fanxian','set','请输入有效的尺寸（最小50x50像素）','move','clock','Bayer','querySelector','join','btnReset','className','2.13_122_250','canvasSize','hidden','processedImageInfo','CALENDAR','target','logContainer','noImagePlaceholder','EPD_CMD_LED','clientX','connectbutton','drawingStatus','连接过程出错:\x20','interleavedcount','CLEAR','data-color','remove','提示：按住Shift键拖动图片，或直接点击图片拖动','imageScale','橡皮擦','shichen_color','切换模式失败:\x20','\x20×\x20','9265992gdCmJq','restore','getBoundingClientRect','未连接蓝牙设备','未知设备','.italic','url(\x22data:image/svg+xml,%3Csvg\x20xmlns=\x27http://www.w3.org/2000/svg\x27\x20width=\x2724\x27\x20height=\x2724\x27\x20viewBox=\x270\x200\x2024\x2024\x27\x20fill=\x27none\x27\x20stroke=\x27black\x27\x20stroke-width=\x272\x27\x20stroke-linecap=\x27round\x27\x20stroke-linejoin=\x27round\x27%3E%3Cpath\x20d=\x27M18\x2013L5\x205\x27/%3E%3C/svg%3E\x22)\x200\x2024,\x20auto','已选择','innerHTML','当前设备不支持此颜色模式','图片已旋转至\x20','liang_add','forEach','strokeStyle','statusContainer','liang_s','name','log','收到通知:',',\x20用时:\x20','未找到NRF前缀的蓝牙设备，请确认设备已开启','width'];_0x4d40=function(){return _0x1f6352;};return _0x4d40();}function preConnect(){const _0x400cc2=_0x4a9634;if(gattServer!=null&&gattServer[_0x400cc2(0x209)])bleDevice!=null&&bleDevice[_0x400cc2(0x1e5)][_0x400cc2(0x209)]&&(addLog('正在断开与\x20'+(bleDevice[_0x400cc2(0x265)]||_0x400cc2(0x259))+'\x20的连接...'),bleDevice[_0x400cc2(0x1e5)][_0x400cc2(0x212)]());else{resetBluetoothVariables();try{navigator[_0x400cc2(0x20d)][_0x400cc2(0x2bd)]({'filters':[{'namePrefix':_0x400cc2(0x1f6)}],'optionalServices':['32120001-0bf6-448a-9608-1b01a1a8f75c']})[_0x400cc2(0x2d8)](_0x10c421=>{const _0x37663e=_0x400cc2;addLog(_0x37663e(0x21b)+(_0x10c421[_0x37663e(0x265)]||_0x37663e(0x28c))),bleDevice=_0x10c421,bleDevice['addEventListener'](_0x37663e(0x2ae),disconnect),setTimeout(()=>connect(),0x12c);})[_0x400cc2(0x31c)](_0x43145d=>{const _0x5649f2=_0x400cc2;addLog(_0x5649f2(0x2f7)+_0x43145d[_0x5649f2(0x2db)]),_0x43145d[_0x5649f2(0x265)]===_0x5649f2(0x26b)&&addLog(_0x5649f2(0x269));});}catch(_0x2b05c3){addLog(_0x400cc2(0x26f)+_0x2b05c3[_0x400cc2(0x2db)]),addLog('请检查蓝牙是否已开启并授予权限');}}}async function connect(){const _0x3b281e=_0x4a9634;if(!bleDevice){addLog(_0x3b281e(0x314));return;}if(epdCharacteristic){addLog(_0x3b281e(0x2f4));return;}try{addLog('正在连接:\x20'+(bleDevice[_0x3b281e(0x265)]||_0x3b281e(0x28c))),gattServer=await bleDevice[_0x3b281e(0x1e5)][_0x3b281e(0x232)](),epdService=await gattServer[_0x3b281e(0x300)](_0x3b281e(0x323)),epdCharacteristic=await epdService[_0x3b281e(0x2ed)](_0x3b281e(0x320)),addLog('已成功连接到设备！'),await epdCharacteristic[_0x3b281e(0x2e6)](),epdCharacteristic[_0x3b281e(0x2a0)](_0x3b281e(0x1fa),_0x55302d=>{handleNotify(_0x55302d['target']['value']);}),await write(EpdCmd[_0x3b281e(0x2f6)]),document['getElementById'](_0x3b281e(0x248))['innerHTML']=_0x3b281e(0x22f),updateButtonStatus();}catch(_0x49bfe3){addLog(_0x3b281e(0x24a)+_0x49bfe3[_0x3b281e(0x2db)]),disconnect();}}function disconnect(){const _0x56413f=_0x4a9634;bleDevice&&bleDevice[_0x56413f(0x1e5)][_0x56413f(0x209)]&&bleDevice[_0x56413f(0x1e5)]['disconnect'](),resetBluetoothVariables(),addLog(_0x56413f(0x307)),document[_0x56413f(0x2d1)]('connectbutton')[_0x56413f(0x25d)]=_0x56413f(0x312),updateButtonStatus();}function resetBluetoothVariables(){gattServer=null,epdService=null,epdCharacteristic=null,msgIndex=0x0;}async function write(_0x2f0036,_0x3a7de2,_0x1c9419=!![]){const _0x2e6e61=_0x4a9634;if(!epdCharacteristic)return addLog(_0x2e6e61(0x258)),![];let _0x23d3c8=[_0x2f0036];if(_0x3a7de2){if(typeof _0x3a7de2=='string')_0x3a7de2=hex2bytes(_0x3a7de2);if(_0x3a7de2 instanceof Uint8Array)_0x3a7de2=Array[_0x2e6e61(0x322)](_0x3a7de2);_0x23d3c8[_0x2e6e61(0x2ac)](..._0x3a7de2);}try{if(_0x1c9419)await epdCharacteristic[_0x2e6e61(0x1ea)](Uint8Array[_0x2e6e61(0x322)](_0x23d3c8));else await epdCharacteristic[_0x2e6e61(0x2f2)](Uint8Array['from'](_0x23d3c8));}catch(_0x3261f7){return addLog(_0x2e6e61(0x1ed)+_0x3261f7[_0x2e6e61(0x2db)]),![];}return!![];}async function writeImage(_0x3a49cc,_0x8e533c='bw'){const _0x5e9a0e=_0x4a9634,_0x4c05e9=document['getElementById']('mtusize')[_0x5e9a0e(0x2a4)]-0x2,_0x43c48d=document[_0x5e9a0e(0x2d1)](_0x5e9a0e(0x24b))[_0x5e9a0e(0x2a4)],_0x3a56f0=Math[_0x5e9a0e(0x204)](_0x3a49cc[_0x5e9a0e(0x29e)]/_0x4c05e9);let _0x221d03=0x0,_0x74023f=_0x43c48d;const _0x2b7f38=getSelectedCanvasSize();for(let _0x26b278=0x0;_0x26b278<_0x3a49cc['length'];_0x26b278+=_0x4c05e9){let _0x58c5b6=(new Date()['getTime']()-startTime)/0x3e8;addLog((_0x8e533c=='bw'?'黑白':'红色')+_0x5e9a0e(0x270)+(_0x221d03+0x1)+'/'+_0x3a56f0+_0x5e9a0e(0x268)+_0x58c5b6['toFixed'](0x1)+'s');const _0x2578ed=[(_0x8e533c=='bw'?0xf:0x0)|(_0x26b278==0x0?0x0:0xf0),..._0x3a49cc['slice'](_0x26b278,_0x26b278+_0x4c05e9)];_0x74023f>0x0?(await write(EpdCmd['WRITE_IMG'],_0x2578ed,![]),_0x74023f--):(await write(EpdCmd[_0x5e9a0e(0x1e1)],_0x2578ed,!![]),_0x74023f=_0x43c48d),_0x221d03++;}}function downloadImageFile(){const _0x63bbe9=_0x4a9634;if(!checkCanvasHasContent(canvas)){addLog(_0x63bbe9(0x21f));return;}const _0x1ae7b4=getSelectedCanvasSize(),{width:_0x135075,height:_0x4b37e9}=getEffectiveCanvasSize(_0x1ae7b4),_0x2cebd1=getRotatedImageData(canvas,_0x1ae7b4,imageRotation),_0x21261e=ditherMode['value'],_0xcef806=processImageData(_0x2cebd1,_0x21261e,_0x135075,_0x4b37e9),_0x53e5dc=_0xcef806['length'],_0x3d1ac8=(_0x53e5dc/0x400)[_0x63bbe9(0x21c)](0x2),_0x162f28=_0x135075*_0x4b37e9,_0x1d49a0=_0xcef806[_0x63bbe9(0x2cd)](_0xb7d1f3=>_0xb7d1f3[_0x63bbe9(0x229)](0x10)[_0x63bbe9(0x1fd)](0x2,'0'))[_0x63bbe9(0x23b)]('\x20'),_0x263a55=new Blob([_0x1d49a0],{'type':_0x63bbe9(0x287)}),_0x5e699c=URL['createObjectURL'](_0x263a55),_0x56902d=document[_0x63bbe9(0x21d)]('a');_0x56902d[_0x63bbe9(0x2c1)]=_0x5e699c,_0x56902d[_0x63bbe9(0x215)]=_0x63bbe9(0x276)+new Date()[_0x63bbe9(0x319)]()+_0x63bbe9(0x2c5),document[_0x63bbe9(0x2c4)][_0x63bbe9(0x32f)](_0x56902d),_0x56902d[_0x63bbe9(0x2e4)](),setTimeout(()=>{const _0x3e560c=_0x63bbe9;document[_0x3e560c(0x2c4)][_0x3e560c(0x201)](_0x56902d),URL['revokeObjectURL'](_0x5e699c);},0x0),addLog(_0x63bbe9(0x28e)+_0x53e5dc+_0x63bbe9(0x2b5)+_0x3d1ac8+_0x63bbe9(0x2a9)+_0x162f28);}function showTimeDialog(){const _0xd7e488=_0x4a9634;if(!epdCharacteristic){addLog(_0xd7e488(0x2b8));return;}const _0x18b3cf=new Date(),_0x514fcf=new Date(_0x18b3cf['getTime']()-_0x18b3cf[_0xd7e488(0x1e3)]()*0xea60)[_0xd7e488(0x20e)]()['slice'](0x0,0x10);datetimeInput[_0xd7e488(0x2a4)]=_0x514fcf,timeDialog[_0xd7e488(0x2a7)][_0xd7e488(0x24e)](_0xd7e488(0x240));}function hideTimeDialog(){const _0x6156d7=_0x4a9634;timeDialog[_0x6156d7(0x2a7)]['add']('hidden');}async function setTime(){const _0x2cd68b=_0x4a9634;if(!epdCharacteristic){addLog(_0x2cd68b(0x2b8)),hideTimeDialog();return;}const _0x7ff6d1=datetimeInput[_0x2cd68b(0x2a4)];if(!_0x7ff6d1){addLog(_0x2cd68b(0x2ec));return;}const _0x2f4df2=new Date(_0x7ff6d1),_0x5b89f5=Math[_0x2cd68b(0x274)](_0x2f4df2[_0x2cd68b(0x319)]()/0x3e8),_0x3fa46f=[_0x5b89f5>>0x18&0xff,_0x5b89f5>>0x10&0xff,_0x5b89f5>>0x8&0xff,_0x5b89f5&0xff];try{setStatus('正在设置时间...'),statusContainer[_0x2cd68b(0x2f9)][_0x2cd68b(0x311)]='block',await write(EpdCmd['SET_TIME'],_0x3fa46f),addLog(_0x2cd68b(0x1fc)+_0x2f4df2[_0x2cd68b(0x22d)]()),addLog(_0x2cd68b(0x29f)+_0x5b89f5+_0x2cd68b(0x2be)+_0x5b89f5['toString'](0x10)[_0x2cd68b(0x220)]()+')'),setTimeout(()=>{const _0x5b2cb0=_0x2cd68b;statusContainer['style'][_0x5b2cb0(0x311)]=_0x5b2cb0(0x325);},0x7d0);}catch(_0x560202){addLog(_0x2cd68b(0x1dc)+_0x560202[_0x2cd68b(0x2db)]);}finally{hideTimeDialog();}}async function setClockMode(){const _0x1bbfc7=_0x4a9634;if(!epdCharacteristic){addLog(_0x1bbfc7(0x2b8));return;}try{setStatus(_0x1bbfc7(0x2c0)),statusContainer[_0x1bbfc7(0x2f9)][_0x1bbfc7(0x311)]='block',await write(EpdCmd[_0x1bbfc7(0x2cf)],[DisplayMode[_0x1bbfc7(0x1e2)]]),currentMode=_0x1bbfc7(0x238),addLog(_0x1bbfc7(0x334)),setTimeout(()=>{const _0x5873b3=_0x1bbfc7;statusContainer['style'][_0x5873b3(0x311)]=_0x5873b3(0x325);},0x7d0);}catch(_0x19d623){addLog(_0x1bbfc7(0x253)+_0x19d623[_0x1bbfc7(0x2db)]);}}async function setCalendarMode(){const _0x2a4da0=_0x4a9634;if(!epdCharacteristic){addLog(_0x2a4da0(0x2b8));return;}try{setStatus(_0x2a4da0(0x1f0)),statusContainer[_0x2a4da0(0x2f9)][_0x2a4da0(0x311)]=_0x2a4da0(0x2de),await write(EpdCmd[_0x2a4da0(0x2cf)],[DisplayMode[_0x2a4da0(0x242)]]),currentMode=_0x2a4da0(0x2b9),addLog(_0x2a4da0(0x224)),setTimeout(()=>{const _0x4b5f21=_0x2a4da0;statusContainer[_0x4b5f21(0x2f9)][_0x4b5f21(0x311)]=_0x4b5f21(0x325);},0x7d0);}catch(_0x28655d){addLog('切换模式失败:\x20'+_0x28655d[_0x2a4da0(0x2db)]);}}async function clearScreen(){const _0x130a05=_0x4a9634;if(!epdCharacteristic){addLog(_0x130a05(0x2b8));return;}if(!confirm('确定要清空墨水屏显示内容吗？'))return;try{setStatus(_0x130a05(0x1ee)),statusContainer['style'][_0x130a05(0x311)]='block',await write(EpdCmd[_0x130a05(0x24c)]),await write(EpdCmd[_0x130a05(0x2b4)]),addLog(_0x130a05(0x2eb)),setTimeout(()=>{const _0x133c5f=_0x130a05;statusContainer[_0x133c5f(0x2f9)][_0x133c5f(0x311)]=_0x133c5f(0x325);},0x7d0);}catch(_0x40ee2a){addLog(_0x130a05(0x2f3)+_0x40ee2a[_0x130a05(0x2db)]);}}function getEffectiveCanvasSize(_0x252933){const _0x59cb89=_0x4a9634;let _0x847d18=_0x252933['width'],_0x4abc78=_0x252933[_0x59cb89(0x1f5)];return imageRotation%0xb4!==0x0&&([_0x847d18,_0x4abc78]=[_0x4abc78,_0x847d18]),{'width':_0x847d18,'height':_0x4abc78};}function getRotatedImageData(_0x4f2fcb,_0x12786a,_0x53ef2c){const _0x7b9a4c=_0x4a9634,_0x4ad15e=document['createElement'](_0x7b9a4c(0x2ef)),_0xd5ce5a=_0x4ad15e[_0x7b9a4c(0x2b7)]('2d'),{width:_0x1dac7c,height:_0x290f03}=getEffectiveCanvasSize(_0x12786a);_0x4ad15e[_0x7b9a4c(0x26a)]=_0x1dac7c,_0x4ad15e[_0x7b9a4c(0x1f5)]=_0x290f03,_0xd5ce5a[_0x7b9a4c(0x294)]();if(_0x53ef2c===0x5a)_0xd5ce5a[_0x7b9a4c(0x296)](_0x1dac7c,0x0),_0xd5ce5a[_0x7b9a4c(0x295)](Math['PI']/0x2);else{if(_0x53ef2c===0xb4)_0xd5ce5a[_0x7b9a4c(0x296)](_0x1dac7c,_0x290f03),_0xd5ce5a[_0x7b9a4c(0x295)](Math['PI']);else _0x53ef2c===0x10e&&(_0xd5ce5a[_0x7b9a4c(0x296)](0x0,_0x290f03),_0xd5ce5a[_0x7b9a4c(0x295)](0x3*Math['PI']/0x2));}return _0xd5ce5a[_0x7b9a4c(0x1da)](_0x4f2fcb,0x0,0x0),_0xd5ce5a['restore'](),_0xd5ce5a[_0x7b9a4c(0x324)](0x0,0x0,_0x1dac7c,_0x290f03);}function _0x1140(_0x422c17,_0x1a9ab0){const _0x4d401b=_0x4d40();return _0x1140=function(_0x1140ca,_0x218c23){_0x1140ca=_0x1140ca-0x1d8;let _0x549120=_0x4d401b[_0x1140ca];return _0x549120;},_0x1140(_0x422c17,_0x1a9ab0);}function getDitherAlgorithmName(_0x458c77){const _0x116753=_0x4a9634,_0x1df10b={'floydSteinberg':'Floyd-Steinberg','atkinson':_0x116753(0x2c7),'bayer':_0x116753(0x239),'stucki':_0x116753(0x2e3),'jarvis':_0x116753(0x202)};return _0x1df10b[_0x458c77]||_0x458c77;}function setDitherMode(_0x3fd4c2){const _0x211ac8=_0x4a9634;ditherMode[_0x211ac8(0x2a4)]=_0x3fd4c2,addLog(_0x211ac8(0x25c)+(_0x3fd4c2===_0x211ac8(0x2f5)?'黑白':'黑白红')+'模式');}function onDitherAlgChange(_0x1b27b5){const _0x5da67e=_0x4a9634;currentParams[_0x5da67e(0x280)]=_0x1b27b5[_0x5da67e(0x243)]['value'],addLog('已选择'+getDitherAlgorithmName(currentParams[_0x5da67e(0x280)])+_0x5da67e(0x2ad));}function getSelectedCanvasSize(){const _0x1406dc=_0x4a9634,_0x240b53=document[_0x1406dc(0x2d1)](_0x1406dc(0x23f))[_0x1406dc(0x2a4)];return canvasSizes['find'](_0x527815=>_0x527815[_0x1406dc(0x265)]===_0x240b53)||canvasSizes[0x1];}let originalImageData=null;function updateCanvasSize(_0x24360e=![]){const _0xbb6873=_0x4a9634,_0x2bdaf3=getSelectedCanvasSize(),_0xd04476=checkCanvasHasContent(canvas);imageWidthInput['value']=_0x2bdaf3[_0xbb6873(0x26a)],imageHeightInput[_0xbb6873(0x2a4)]=_0x2bdaf3[_0xbb6873(0x1f5)],canvas[_0xbb6873(0x26a)]=_0x2bdaf3['width'],canvas['height']=_0x2bdaf3[_0xbb6873(0x1f5)],floatCanvas[_0xbb6873(0x26a)]=_0x2bdaf3['width'],floatCanvas['height']=_0x2bdaf3['height'],_0x24360e&&_0xd04476?originalCanvasData&&ctx['putImageData'](originalCanvasData,0x0,0x0):(ctx[_0xbb6873(0x22a)]=_0xbb6873(0x272),ctx[_0xbb6873(0x2c3)](0x0,0x0,_0x2bdaf3[_0xbb6873(0x26a)],_0x2bdaf3[_0xbb6873(0x1f5)])),syncCanvases(),processedImageInfo[_0xbb6873(0x2b6)]=_0x2bdaf3[_0xbb6873(0x26a)]+'\x20×\x20'+_0x2bdaf3['height']+_0xbb6873(0x1e8),updateCanvasVisibility();}function updateDitcherOptions(){const _0x2720ac=_0x4a9634,_0x17c9a6=document[_0x2720ac(0x2d1)](_0x2720ac(0x21a)),_0x580781=_0x17c9a6['options'][_0x17c9a6[_0x2720ac(0x30b)]],_0x218b82=_0x580781[_0x2720ac(0x1f3)](_0x2720ac(0x24d)),_0x409aed=_0x580781['getAttribute']('data-size');if(_0x218b82)ditherMode[_0x2720ac(0x2a4)]=_0x218b82;if(_0x409aed){const _0x312a0b=canvasSizes['some'](_0x590ee9=>_0x590ee9[_0x2720ac(0x265)]===_0x409aed);_0x312a0b&&(document['getElementById'](_0x2720ac(0x23f))['value']=_0x409aed);}updateCanvasSize(!![]);}function processImage(){const _0x13df2b=_0x4a9634;saveOriginalCanvasState(),addLog(_0x13df2b(0x273)+getDitherAlgorithmName(currentParams[_0x13df2b(0x280)])+_0x13df2b(0x1ec));const _0x425b09=getSelectedCanvasSize();let _0x4801fc=ctx[_0x13df2b(0x324)](0x0,0x0,_0x425b09[_0x13df2b(0x26a)],_0x425b09[_0x13df2b(0x1f5)]);_0x4801fc=adjustImageParameters(_0x4801fc,currentParams);const _0x5a93e5=ditherMode[_0x13df2b(0x2a4)];let _0x47604c;const _0x184097=window['processImage1'](_0x4801fc,document[_0x13df2b(0x2d1)]('brightness')[_0x13df2b(0x2a4)],document[_0x13df2b(0x2d1)](_0x13df2b(0x20a))[_0x13df2b(0x2a4)],document[_0x13df2b(0x2d1)](_0x13df2b(0x2ff))[_0x13df2b(0x2a4)],document['getElementById'](_0x13df2b(0x216))['value']/0xa,_0x5a93e5,document[_0x13df2b(0x2d1)](_0x13df2b(0x280))[_0x13df2b(0x2a4)]);ctx[_0x13df2b(0x277)](_0x184097,0x0,0x0),syncCanvases(),processedImageInfo[_0x13df2b(0x2b6)]=_0x425b09['width']+_0x13df2b(0x254)+_0x425b09[_0x13df2b(0x1f5)]+_0x13df2b(0x281)+(_0x5a93e5===_0x13df2b(0x2f5)?'黑白':'黑白红')+')',addLog(_0x13df2b(0x2e1)),updateCanvasVisibility();}async function sendimg(){const _0x4c62f2=_0x4a9634;if(!epdCharacteristic){addLog(_0x4c62f2(0x2b8));return;}const _0x197644=document['getElementById'](_0x4c62f2(0x23f))[_0x4c62f2(0x2a4)],_0x27013e=document[_0x4c62f2(0x2d1)](_0x4c62f2(0x2c9))[_0x4c62f2(0x2a4)],_0x221850=document[_0x4c62f2(0x2d1)](_0x4c62f2(0x21a)),_0x18645b=_0x221850[_0x4c62f2(0x316)][_0x221850[_0x4c62f2(0x30b)]];startTime=new Date()['getTime'](),setStatus(_0x4c62f2(0x1eb)),statusContainer[_0x4c62f2(0x2f9)]['display']='block',addLog('开始传输原始画布数据到墨水屏...');const _0x2215e6=getSelectedCanvasSize(),{width:_0x3f72e0,height:_0x26f96e}=getEffectiveCanvasSize(_0x2215e6),_0x1af26e=getRotatedImageData(canvas,_0x2215e6,imageRotation),_0x12488f=processImageData(_0x1af26e,_0x27013e,_0x3f72e0,_0x26f96e);updateButtonStatus(!![]);try{await write(EpdCmd[_0x4c62f2(0x2cf)],[DisplayMode[_0x4c62f2(0x2af)]]),currentMode='image';if(_0x27013e===_0x4c62f2(0x231)){const _0x9a4e8a=Math['floor'](_0x12488f[_0x4c62f2(0x29e)]/0x2);await writeImage(_0x12488f[_0x4c62f2(0x1e0)](0x0,_0x9a4e8a),'bw'),await writeImage(_0x12488f['slice'](_0x9a4e8a),'red');}else{if(_0x27013e===_0x4c62f2(0x2f5))await writeImage(_0x12488f,'bw');else{addLog(_0x4c62f2(0x25e)),updateButtonStatus();return;}}await write(EpdCmd[_0x4c62f2(0x2b4)]);const _0x53db86=new Date()[_0x4c62f2(0x319)](),_0x378165=((_0x53db86-startTime)/0x3e8)[_0x4c62f2(0x21c)](0x2);setStatus('传输成功！耗时\x20'+_0x378165+'\x20秒'),addLog(_0x4c62f2(0x2d5)+_0x378165+'\x20秒'),addLog('请等待屏幕刷新完成');}catch(_0x1013ee){setStatus(_0x4c62f2(0x1f9)),addLog(_0x4c62f2(0x32b)+_0x1013ee[_0x4c62f2(0x2db)]);}finally{updateButtonStatus(![]),setTimeout(()=>{const _0x33bb17=_0x4c62f2;statusContainer[_0x33bb17(0x2f9)][_0x33bb17(0x311)]=_0x33bb17(0x325);},0x1388);}}function adjustImageParameters(_0x2b8508,_0x184839){const _0x371926=_0x4a9634,_0x11db6c=_0x2b8508[_0x371926(0x218)],_0x43d75a=_0x184839['saturation']/0x64,_0x4e75e4=_0x184839[_0x371926(0x2e9)]/0x64,_0x51c687=_0x184839[_0x371926(0x20a)]/0x64,_0x3ceb9b=_0x184839[_0x371926(0x216)]/0x64,_0x83ae1f=_0x51c687!==0x0?0x103*(_0x51c687+0xff)/(0xff*(0x103-_0x51c687)):0x1,_0x58a17e=new Uint8ClampedArray(_0x11db6c);for(let _0x5dde15=0x0;_0x5dde15<_0x11db6c[_0x371926(0x29e)];_0x5dde15+=0x4){let _0x97b031=Math[_0x371926(0x330)](0xff,Math['max'](0x0,_0x58a17e[_0x5dde15]*_0x4e75e4)),_0x27193a=Math[_0x371926(0x330)](0xff,Math[_0x371926(0x203)](0x0,_0x58a17e[_0x5dde15+0x1]*_0x4e75e4)),_0x1a5175=Math[_0x371926(0x330)](0xff,Math[_0x371926(0x203)](0x0,_0x58a17e[_0x5dde15+0x2]*_0x4e75e4));_0x97b031=Math[_0x371926(0x330)](0xff,Math[_0x371926(0x203)](0x0,_0x83ae1f*(_0x97b031-0x80)+0x80)),_0x27193a=Math[_0x371926(0x330)](0xff,Math[_0x371926(0x203)](0x0,_0x83ae1f*(_0x27193a-0x80)+0x80)),_0x1a5175=Math[_0x371926(0x330)](0xff,Math['max'](0x0,_0x83ae1f*(_0x1a5175-0x80)+0x80));const _0x221f03=0.299*_0x97b031+0.587*_0x27193a+0.114*_0x1a5175;_0x97b031=Math['min'](0xff,Math[_0x371926(0x203)](0x0,_0x221f03+_0x43d75a*(_0x97b031-_0x221f03))),_0x27193a=Math[_0x371926(0x330)](0xff,Math['max'](0x0,_0x221f03+_0x43d75a*(_0x27193a-_0x221f03))),_0x1a5175=Math[_0x371926(0x330)](0xff,Math[_0x371926(0x203)](0x0,_0x221f03+_0x43d75a*(_0x1a5175-_0x221f03)));if(_0x3ceb9b>0x0){const _0x14aaa8=_0x2b8508[_0x371926(0x26a)],_0xf8c22f=_0x5dde15/0x4%_0x14aaa8,_0x105dd7=Math[_0x371926(0x274)](_0x5dde15/0x4/_0x14aaa8);if(_0xf8c22f>0x0&&_0x105dd7>0x0){const _0x19a22d=_0x5dde15-0x4*(_0x14aaa8+0x1);_0x97b031=Math['floor'](_0x97b031*(0x1-_0x3ceb9b)+_0x58a17e[_0x19a22d]*_0x3ceb9b),_0x27193a=Math[_0x371926(0x274)](_0x27193a*(0x1-_0x3ceb9b)+_0x58a17e[_0x19a22d+0x1]*_0x3ceb9b),_0x1a5175=Math[_0x371926(0x274)](_0x1a5175*(0x1-_0x3ceb9b)+_0x58a17e[_0x19a22d+0x2]*_0x3ceb9b);}}_0x11db6c[_0x5dde15]=_0x97b031,_0x11db6c[_0x5dde15+0x1]=_0x27193a,_0x11db6c[_0x5dde15+0x2]=_0x1a5175;}return _0x2b8508;}function convertToBlackWhite(_0x276351,_0x3a9406){const _0x4305fa=_0x4a9634,_0x1ab8b2=_0x276351[_0x4305fa(0x26a)],_0x5ac184=_0x276351['height'],_0x1c6bb3=ctx[_0x4305fa(0x31d)](_0x1ab8b2,_0x5ac184);return _0x1c6bb3[_0x4305fa(0x218)][_0x4305fa(0x235)](_0x276351[_0x4305fa(0x218)]),applyDitheringAlgorithm(_0x1c6bb3,0x80,_0x3a9406),{'imageData':_0x1c6bb3};}function convertToBlackWhiteRed(_0x1dbff1,_0x4a36ec){const _0x306e4c=_0x4a9634,_0x50589b=_0x1dbff1[_0x306e4c(0x26a)],_0x5d9557=_0x1dbff1[_0x306e4c(0x1f5)],_0x5a19d6=ctx[_0x306e4c(0x31d)](_0x50589b,_0x5d9557);_0x5a19d6[_0x306e4c(0x218)][_0x306e4c(0x235)](_0x1dbff1[_0x306e4c(0x218)]);const _0x5daa1e=_0x5a19d6[_0x306e4c(0x218)];for(let _0x5d735b=0x0;_0x5d735b<_0x5daa1e[_0x306e4c(0x29e)];_0x5d735b+=0x4){const _0x315de8=_0x5daa1e[_0x5d735b],_0x221ef8=_0x5daa1e[_0x5d735b+0x1],_0x51da3a=_0x5daa1e[_0x5d735b+0x2];if(_0x315de8>0xb4&&_0x221ef8<_0x315de8*0.6&&_0x51da3a<_0x315de8*0.6)_0x5daa1e[_0x5d735b+0x3]=0x1;else{const _0x9bf810=0.299*_0x315de8+0.587*_0x221ef8+0.114*_0x51da3a;_0x5daa1e[_0x5d735b]=_0x9bf810,_0x5daa1e[_0x5d735b+0x1]=_0x9bf810,_0x5daa1e[_0x5d735b+0x2]=_0x9bf810,_0x5daa1e[_0x5d735b+0x3]=0x0;}}applyDitheringAlgorithm(_0x5a19d6,0x64,_0x4a36ec,!![]);for(let _0x4dab62=0x0;_0x4dab62<_0x5daa1e[_0x306e4c(0x29e)];_0x4dab62+=0x4){if(_0x5daa1e[_0x4dab62+0x3]===0x1)_0x5daa1e[_0x4dab62]=0xff,_0x5daa1e[_0x4dab62+0x1]=0x0,_0x5daa1e[_0x4dab62+0x2]=0x0;else{const _0x5049cc=_0x5daa1e[_0x4dab62]>0x64?0xff:0x0;_0x5daa1e[_0x4dab62]=_0x5daa1e[_0x4dab62+0x1]=_0x5daa1e[_0x4dab62+0x2]=_0x5049cc;}_0x5daa1e[_0x4dab62+0x3]=0xff;}return{'imageData':_0x5a19d6};}function applyDitheringAlgorithm(_0x2a626e,_0x50e299,_0x1361f1,_0x1ac4a8=![]){const _0x1535fb=_0x4a9634,_0x285073=_0x2a626e[_0x1535fb(0x218)],_0xeb6a4=_0x2a626e[_0x1535fb(0x26a)],_0xa9dc33=_0x2a626e[_0x1535fb(0x1f5)],_0x12a036=_0x1361f1[_0x1535fb(0x280)],_0x507193=_0x1361f1[_0x1535fb(0x216)]/0x64,_0x36a0bc=new Uint8ClampedArray(_0x285073);for(let _0x2053fb=0x0;_0x2053fb<_0xa9dc33;_0x2053fb++){for(let _0x3333bd=0x0;_0x3333bd<_0xeb6a4;_0x3333bd++){const _0x1a6abd=(_0x2053fb*_0xeb6a4+_0x3333bd)*0x4;if(_0x1ac4a8&&_0x36a0bc[_0x1a6abd+0x3]===0x1)continue;const _0x544c7f=_0x36a0bc[_0x1a6abd],_0x5aac73=_0x544c7f<_0x50e299?0x0:0xff,_0x4cc9d5=_0x544c7f-_0x5aac73,_0x2202ee=0x1+_0x507193;switch(_0x12a036){case'floydSteinberg':propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x7/0x10,0x1,0x0),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x3/0x10,-0x1,0x1),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x5/0x10,0x0,0x1),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x10,0x1,0x1);break;case _0x1535fb(0x301):propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x8,0x1,0x0),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x8,0x2,0x0),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x8,-0x1,0x1),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x8,0x0,0x1),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x8,0x1,0x1),propagateError(_0x36a0bc,_0x3333bd,_0x2053fb,_0xeb6a4,_0xa9dc33,_0x4cc9d5*_0x2202ee,0x1/0x8,0x0,0x2);break;default:break;}_0x285073[_0x1a6abd]=_0x5aac73,_0x285073[_0x1a6abd+0x1]=_0x5aac73,_0x285073[_0x1a6abd+0x2]=_0x5aac73;}}}function propagateError(_0x344ae8,_0x576e5f,_0x7cdbc4,_0x2f26d9,_0x425d7d,_0x378038,_0x255e3f,_0x36b488,_0x20a84e){const _0x2b1eaf=_0x4a9634,_0x4181d3=_0x576e5f+_0x36b488,_0x3a41b3=_0x7cdbc4+_0x20a84e;if(_0x4181d3>=0x0&&_0x4181d3<_0x2f26d9&&_0x3a41b3>=0x0&&_0x3a41b3<_0x425d7d){const _0x27314b=(_0x3a41b3*_0x2f26d9+_0x4181d3)*0x4;_0x344ae8[_0x27314b]=Math[_0x2b1eaf(0x203)](0x0,Math[_0x2b1eaf(0x330)](0xff,_0x344ae8[_0x27314b]+_0x378038*_0x255e3f));}}function processImageData(_0x4ece95,_0x53eb58){const _0x43422e=_0x4a9634,_0x5ed3dd=_0x4ece95[_0x43422e(0x26a)],_0x484128=_0x4ece95[_0x43422e(0x1f5)],_0x262bed=_0x4ece95[_0x43422e(0x218)];let _0x2bdff7;if(_0x53eb58===_0x43422e(0x2cc)){_0x2bdff7=new Uint8Array(_0x5ed3dd*_0x484128);for(let _0x470ff6=0x0;_0x470ff6<_0x484128;_0x470ff6++){for(let _0x5ba73b=0x0;_0x5ba73b<_0x5ed3dd;_0x5ba73b++){const _0x11b3c3=(_0x470ff6*_0x5ed3dd+_0x5ba73b)*0x4,_0x342b46=_0x262bed[_0x11b3c3],_0x1f636b=_0x262bed[_0x11b3c3+0x1],_0x510ab0=_0x262bed[_0x11b3c3+0x2],_0x414b53=findClosestColor(_0x342b46,_0x1f636b,_0x510ab0,_0x53eb58),_0x5c8c3d=_0x5ba73b*_0x484128+(_0x484128-0x1-_0x470ff6);_0x2bdff7[_0x5c8c3d]=_0x414b53[_0x43422e(0x2a4)];}}}else{if(_0x53eb58==='fourColor'){_0x2bdff7=new Uint8Array(Math['ceil'](_0x5ed3dd*_0x484128/0x4));for(let _0x235362=0x0;_0x235362<_0x484128;_0x235362++){for(let _0x5c524f=0x0;_0x5c524f<_0x5ed3dd;_0x5c524f++){const _0x28d858=(_0x235362*_0x5ed3dd+_0x5c524f)*0x4,_0x55a13f=_0x262bed[_0x28d858],_0x5418ed=_0x262bed[_0x28d858+0x1],_0x13b8af=_0x262bed[_0x28d858+0x2],_0x43f9ca=findClosestColor(_0x55a13f,_0x5418ed,_0x13b8af,_0x53eb58),_0x2a1ba0=_0x43f9ca[_0x43422e(0x2a4)],_0x32289b=(_0x235362*_0x5ed3dd+_0x5c524f)/0x4|0x0,_0x3d9965=0x6-_0x5c524f%0x4*0x2;_0x2bdff7[_0x32289b]|=_0x2a1ba0<<_0x3d9965;}}}else{if(_0x53eb58==='blackWhiteColor'){const _0xba850f=Math[_0x43422e(0x204)](_0x5ed3dd/0x8);_0x2bdff7=new Uint8Array(_0xba850f*_0x484128);const _0x5d06e6=0x8c;for(let _0x4d8806=0x0;_0x4d8806<_0x484128;_0x4d8806++){for(let _0xda450b=0x0;_0xda450b<_0x5ed3dd;_0xda450b++){const _0x14de7b=(_0x4d8806*_0x5ed3dd+_0xda450b)*0x4,_0x1209ec=_0x262bed[_0x14de7b],_0x50a5eb=_0x262bed[_0x14de7b+0x1],_0x419a36=_0x262bed[_0x14de7b+0x2],_0xe28534=Math[_0x43422e(0x2d7)](0.299*_0x1209ec+0.587*_0x50a5eb+0.114*_0x419a36),_0x2cdbe2=_0xe28534>=_0x5d06e6?0x1:0x0,_0x13187e=_0x4d8806*_0xba850f+Math[_0x43422e(0x274)](_0xda450b/0x8),_0x5622e5=0x7-_0xda450b%0x8;_0x2bdff7[_0x13187e]|=_0x2cdbe2<<_0x5622e5;}}}else{if(_0x53eb58===_0x43422e(0x231)){const _0x5d114f=Math[_0x43422e(0x204)](_0x5ed3dd/0x8),_0x165a68=0x8c,_0x270b1e=0xa0,_0x180f87=new Uint8Array(_0x484128*_0x5d114f),_0x2c445d=new Uint8Array(_0x484128*_0x5d114f);for(let _0x396444=0x0;_0x396444<_0x484128;_0x396444++){for(let _0x571d22=0x0;_0x571d22<_0x5ed3dd;_0x571d22++){const _0xccf4ab=(_0x396444*_0x5ed3dd+_0x571d22)*0x4,_0x4c27cf=_0x262bed[_0xccf4ab],_0x233f7e=_0x262bed[_0xccf4ab+0x1],_0x48aa64=_0x262bed[_0xccf4ab+0x2],_0xc5cb7f=Math[_0x43422e(0x2d7)](0.299*_0x4c27cf+0.587*_0x233f7e+0.114*_0x48aa64),_0x33df1a=_0xc5cb7f>=_0x165a68?0x1:0x0,_0x5d49a7=_0x396444*_0x5d114f+Math[_0x43422e(0x274)](_0x571d22/0x8),_0x19c0ff=0x7-_0x571d22%0x8;_0x33df1a?_0x180f87[_0x5d49a7]|=0x1<<_0x19c0ff:_0x180f87[_0x5d49a7]&=~(0x1<<_0x19c0ff);const _0x20cff8=_0x4c27cf>_0x270b1e&&_0x4c27cf>_0x233f7e&&_0x4c27cf>_0x48aa64?0x0:0x1,_0x5d21f6=_0x396444*_0x5d114f+Math['floor'](_0x571d22/0x8),_0xda2cf2=0x7-_0x571d22%0x8;_0x20cff8?_0x2c445d[_0x5d21f6]|=0x1<<_0xda2cf2:_0x2c445d[_0x5d21f6]&=~(0x1<<_0xda2cf2);}}_0x2bdff7=new Uint8Array(_0x180f87['length']+_0x2c445d[_0x43422e(0x29e)]),_0x2bdff7['set'](_0x180f87,0x0),_0x2bdff7['set'](_0x2c445d,_0x180f87['length']);}}}}return _0x2bdff7;}function toggleCanvas(){const _0x216c3e=_0x4a9634;floatingCanvasContainer[_0x216c3e(0x2a7)][_0x216c3e(0x233)](_0x216c3e(0x240))?(floatingCanvasContainer['classList'][_0x216c3e(0x24e)]('hidden'),toggleCanvasFloat['innerHTML']=_0x216c3e(0x30e),addLog('已显示浮动画布')):hideCanvas();}function hideCanvas(){const _0x4603ff=_0x4a9634;floatingCanvasContainer[_0x4603ff(0x2a7)]['add'](_0x4603ff(0x240)),toggleCanvasFloat[_0x4603ff(0x25d)]='<i\x20class=\x22fa\x20fa-arrows-alt\x20mr-1\x22></i>浮动画布',addLog(_0x4603ff(0x217));}function updateCanvasVisibility(){const _0x2a6308=_0x4a9634,_0x584484=checkCanvasHasContent(canvas);_0x584484?(noImagePlaceholder['classList'][_0x2a6308(0x282)](_0x2a6308(0x240)),canvas['classList']['remove'](_0x2a6308(0x240)),floatPreviewCanvas[_0x2a6308(0x2a7)]['remove'](_0x2a6308(0x240))):(noImagePlaceholder[_0x2a6308(0x2a7)][_0x2a6308(0x24e)](_0x2a6308(0x240)),canvas['classList'][_0x2a6308(0x282)]('hidden'),floatPreviewCanvas[_0x2a6308(0x2a7)][_0x2a6308(0x282)](_0x2a6308(0x240)));}function checkCanvasHasContent(_0x3f3f3f){const _0x2f8490=_0x4a9634,_0x16c30f=_0x3f3f3f[_0x2f8490(0x2b7)]('2d'),_0x483926=_0x16c30f[_0x2f8490(0x324)](0x0,0x0,_0x3f3f3f[_0x2f8490(0x26a)],_0x3f3f3f[_0x2f8490(0x1f5)]),_0x1a6926=_0x483926[_0x2f8490(0x218)];for(let _0x158280=0x0;_0x158280<_0x1a6926[_0x2f8490(0x29e)];_0x158280+=0x4){if(_0x1a6926[_0x158280]!==0xff||_0x1a6926[_0x158280+0x1]!==0xff||_0x1a6926[_0x158280+0x2]!==0xff)return!![];}return![];}function startDrag(_0x5a8bfd){const _0x1c09be=_0x4a9634;isDragging=!![];const _0x1f07c7=floatingCanvasContainer[_0x1c09be(0x257)]();dragOffset['x']=_0x5a8bfd['clientX']-_0x1f07c7[_0x1c09be(0x32e)],dragOffset['y']=_0x5a8bfd[_0x1c09be(0x29d)]-_0x1f07c7['top'];}function drag(_0x1cabdb){const _0x456f79=_0x4a9634;if(!isDragging)return;_0x1cabdb[_0x456f79(0x29c)]();const _0x21a08b=_0x1cabdb[_0x456f79(0x247)]-dragOffset['x'],_0x3f5f9f=_0x1cabdb[_0x456f79(0x29d)]-dragOffset['y'],_0x4cf134=window[_0x456f79(0x2bb)],_0x2a637f=window[_0x456f79(0x213)],_0x5bff58=floatingCanvasContainer[_0x456f79(0x288)],_0x8a12e5=floatingCanvasContainer['offsetHeight'],_0x59da33=Math[_0x456f79(0x203)](0x0,Math[_0x456f79(0x330)](_0x21a08b,_0x4cf134-_0x5bff58)),_0x397c48=Math[_0x456f79(0x203)](0x0,Math[_0x456f79(0x330)](_0x3f5f9f,_0x2a637f-_0x8a12e5));floatingCanvasContainer[_0x456f79(0x2f9)][_0x456f79(0x32e)]=_0x59da33+'px',floatingCanvasContainer[_0x456f79(0x2f9)]['top']=_0x397c48+'px';}function stopDrag(){isDragging=![];}function startResize(_0x2aaf20){isResizing=!![],_0x2aaf20['preventDefault']();}function resize(_0x40d47b){const _0xa0a233=_0x4a9634;if(!isResizing)return;_0x40d47b[_0xa0a233(0x29c)]();const _0x4862a5=floatingCanvasContainer[_0xa0a233(0x257)](),_0x58bb82=_0x40d47b[_0xa0a233(0x247)]-_0x4862a5['left'],_0x1c893e=_0x40d47b[_0xa0a233(0x29d)]-_0x4862a5[_0xa0a233(0x2ca)];_0x58bb82>0xc8&&_0x1c893e>0x96&&(floatingCanvasContainer['style'][_0xa0a233(0x26a)]=_0x58bb82+'px',floatingCanvasContainer[_0xa0a233(0x2f9)][_0xa0a233(0x1f5)]=_0x1c893e+'px');}function stopResize(){isResizing=![];}function resetProcessing(){const _0x4fc1a0=_0x4a9634;if(0x1){ctx['putImageData'](originalCanvasData,0x0,0x0),syncCanvases();const _0x448c77=getSelectedCanvasSize();processedImageInfo[_0x4fc1a0(0x2b6)]=_0x448c77['width']+_0x4fc1a0(0x254)+_0x448c77['height']+_0x4fc1a0(0x1e8),addLog('已重置处理效果，保留原始图片和设置');}else ctx['fillStyle']='#FFFFFF',ctx[_0x4fc1a0(0x2c3)](0x0,0x0,canvas[_0x4fc1a0(0x26a)],canvas['height']),syncCanvases(),addLog(_0x4fc1a0(0x271));}function addLog(_0x3acc03){const _0x4a4d22=_0x4a9634,_0x102994=new Date()[_0x4a4d22(0x318)](),_0xb629d6=document[_0x4a4d22(0x21d)](_0x4a4d22(0x30a));_0xb629d6[_0x4a4d22(0x23d)]=_0x4a4d22(0x2a2),_0xb629d6[_0x4a4d22(0x25d)]='<span\x20class=\x22text-gray-500\x22>['+_0x102994+_0x4a4d22(0x2c6)+_0x3acc03+'</span>';logContainer[_0x4a4d22(0x23a)](_0x4a4d22(0x25a))&&(logContainer[_0x4a4d22(0x25d)]='');logContainer[_0x4a4d22(0x32f)](_0xb629d6),logContainer[_0x4a4d22(0x2a8)]=logContainer[_0x4a4d22(0x289)];while(logContainer['childNodes']['length']>0x1e){logContainer[_0x4a4d22(0x201)](logContainer['firstChild']);}}function setStatus(_0x4d90b5){const _0x5afce5=_0x4a9634;document[_0x5afce5(0x2d1)](_0x5afce5(0x1de))[_0x5afce5(0x2b6)]=_0x4d90b5;}function updateButtonStatus(_0x453522=![]){const _0x4cfdb5=_0x4a9634,_0x250f3d=gattServer!=null&&gattServer[_0x4cfdb5(0x209)],_0x1fcf11=_0x453522||!_0x250f3d;btnSend[_0x4cfdb5(0x1df)]=_0x1fcf11,btnSetTime['disabled']=_0x1fcf11,_0x1fcf11?(btnSend['classList'][_0x4cfdb5(0x282)](_0x4cfdb5(0x1f8),_0x4cfdb5(0x29b)),btnSetTime['classList'][_0x4cfdb5(0x282)](_0x4cfdb5(0x1f8),_0x4cfdb5(0x29b))):(btnSend['classList'][_0x4cfdb5(0x24e)](_0x4cfdb5(0x1f8),_0x4cfdb5(0x29b)),btnSetTime[_0x4cfdb5(0x2a7)]['remove'](_0x4cfdb5(0x1f8),'cursor-not-allowed'));}function reConnect(){const _0x448d0d=_0x4a9634;addLog(_0x448d0d(0x1e7)),preConnect();}function handleNotify(_0x337266){const _0x2f50a7=_0x4a9634;console[_0x2f50a7(0x266)](_0x2f50a7(0x267),_0x337266);}function hex2bytes(_0xa34c32){const _0x2b7583=_0x4a9634,_0x7c2adf=[];for(let _0x1579c0=0x0;_0x1579c0<_0xa34c32[_0x2b7583(0x29e)];_0x1579c0+=0x2){_0x7c2adf['push'](parseInt(_0xa34c32[_0x2b7583(0x2d3)](_0x1579c0,0x2),0x10));}return _0x7c2adf;}function formatFileSize(_0x6365b2){const _0x26f2ef=_0x4a9634;if(_0x6365b2<0x400)return _0x6365b2+'\x20B';else{if(_0x6365b2<0x100000)return(_0x6365b2/0x400)[_0x26f2ef(0x21c)](0x2)+_0x26f2ef(0x2a1);else return(_0x6365b2/0x100000)['toFixed'](0x2)+_0x26f2ef(0x2e5);}}async function set_EPD_CMD_J_H(){const _0x213e31=_0x4a9634;await write(EpdCmd[_0x213e31(0x28d)],document[_0x213e31(0x2d1)](_0x213e31(0x317))[_0x213e31(0x2a4)]);}async function set_EPD_CMD_N_Z(){const _0x5c09aa=_0x4a9634,_0x304737=document['getElementById'](_0x5c09aa(0x2f1))[_0x5c09aa(0x2a4)],_0x5681b9=document[_0x5c09aa(0x2d1)](_0x5c09aa(0x22e))['value'],_0x54fbcb=document[_0x5c09aa(0x2d1)](_0x5c09aa(0x303))[_0x5c09aa(0x2a4)],_0x56f2d3=[0x4];_0x56f2d3[0x0]=0x0,_0x56f2d3[0x1]=0x0,_0x56f2d3[0x2]=_0x304737,_0x56f2d3[0x3]=_0x5681b9,_0x56f2d3[0x4]=_0x54fbcb,await write(EpdCmd['EPD_CMD_N_Z'],_0x56f2d3);}async function set_EPD_CMD_D_S(){const _0x236a44=_0x4a9634,_0x3d3c0f=document['getElementById'](_0x236a44(0x1dd))[_0x236a44(0x2a4)],_0x20398b=document['getElementById'](_0x236a44(0x27b))[_0x236a44(0x2a4)],_0x5cdfd1=document['getElementById'](_0x236a44(0x279))['value'],_0x2a3b9b=[0x4];_0x2a3b9b[0x0]=0x0,_0x2a3b9b[0x1]=0x0,_0x2a3b9b[0x2]=_0x3d3c0f,_0x2a3b9b[0x3]=_0x20398b,_0x2a3b9b[0x4]=_0x5cdfd1,await write(EpdCmd[_0x236a44(0x2fa)],_0x2a3b9b);}async function set_EPD_CMD_J_S(){const _0x46259f=_0x4a9634,_0x21f3a4=document[_0x46259f(0x2d1)](_0x46259f(0x2e8))[_0x46259f(0x2a4)],_0x2a9a2a=document[_0x46259f(0x2d1)](_0x46259f(0x206))[_0x46259f(0x2a4)],_0x1b97a0=document[_0x46259f(0x2d1)](_0x46259f(0x313))[_0x46259f(0x2a4)],_0xb5943a=[0x4];_0xb5943a[0x0]=0x0,_0xb5943a[0x1]=0x0,_0xb5943a[0x2]=_0x21f3a4,_0xb5943a[0x3]=_0x2a9a2a,_0xb5943a[0x4]=_0x1b97a0,await write(EpdCmd[_0x46259f(0x309)],_0xb5943a);}async function set_EPD_CMD_LED(){const _0x5b5b1a=_0x4a9634,_0x1ccd72=document['getElementById'](_0x5b5b1a(0x211))[_0x5b5b1a(0x2a4)],_0x2a598e=document[_0x5b5b1a(0x2d1)]('liang_time')[_0x5b5b1a(0x2a4)],_0x277abc=document[_0x5b5b1a(0x2d1)]('liang_add')['value'],_0xb8d32d=document['getElementById']('liangdu')[_0x5b5b1a(0x2a4)],_0x4468d0=document[_0x5b5b1a(0x2d1)](_0x5b5b1a(0x264))[_0x5b5b1a(0x2a4)],_0x301c2d=[0x5];_0x301c2d[0x0]=_0x1ccd72,_0x301c2d[0x1]=_0x2a598e,_0x301c2d[0x2]=_0x277abc,_0x301c2d[0x3]=_0xb8d32d,_0x301c2d[0x4]=_0x4468d0,await write(EpdCmd[_0x5b5b1a(0x246)],_0x301c2d);}async function set_EPD_CMD_LED1(){const _0x53954b=_0x4a9634,_0x368db9=document[_0x53954b(0x2d1)](_0x53954b(0x211))['value'],_0x16f55e=document[_0x53954b(0x2d1)](_0x53954b(0x31b))[_0x53954b(0x2a4)],_0x38b27c=document[_0x53954b(0x2d1)](_0x53954b(0x260))[_0x53954b(0x2a4)],_0x4988e0=document[_0x53954b(0x2d1)](_0x53954b(0x226))[_0x53954b(0x2a4)],_0x30abc9=document[_0x53954b(0x2d1)]('liang_s')[_0x53954b(0x2a4)],_0x3ab75c=[0x5];_0x3ab75c[0x0]=_0x368db9,_0x3ab75c[0x1]=_0x16f55e,_0x3ab75c[0x2]=_0x38b27c,_0x3ab75c[0x3]=_0x4988e0,_0x3ab75c[0x4]=_0x30abc9,await write(EpdCmd[_0x53954b(0x2dd)],_0x3ab75c);}async function set_EPD_CMD_MY(){const _0x573764=_0x4a9634,_0x351d9e=document[_0x573764(0x2d1)](_0x573764(0x234))[_0x573764(0x2a4)],_0x5d2217=document['getElementById'](_0x573764(0x1e9))[_0x573764(0x2a4)],_0x3afd35=document[_0x573764(0x2d1)]('qiangzhi_shuaxing')[_0x573764(0x2a4)],_0x4c7a48=document[_0x573764(0x2d1)](_0x573764(0x2ea))[_0x573764(0x2a4)],_0x4ea1a0=[0x4];_0x4ea1a0[0x0]=_0x351d9e,_0x4ea1a0[0x1]=_0x5d2217,_0x4ea1a0[0x2]=_0x3afd35,_0x4ea1a0[0x3]=_0x4c7a48,await write(EpdCmd[_0x573764(0x308)],_0x4ea1a0);}async function set_EPD_CMD_COLOR(){const _0x164380=_0x4a9634,_0x2e338a=document[_0x164380(0x2d1)](_0x164380(0x1ef))[_0x164380(0x2a4)],_0x136512=document[_0x164380(0x2d1)](_0x164380(0x2fe))[_0x164380(0x2a4)],_0x1a2a75=document[_0x164380(0x2d1)](_0x164380(0x29a))[_0x164380(0x2a4)],_0x1ee04a=document[_0x164380(0x2d1)](_0x164380(0x332))[_0x164380(0x2a4)],_0x3efbb9=document['getElementById'](_0x164380(0x252))['value'],_0x129a04=document[_0x164380(0x2d1)]('jieqi_color')[_0x164380(0x2a4)],_0x29f4e1=document[_0x164380(0x2d1)](_0x164380(0x315))[_0x164380(0x2a4)],_0x188503=[0x7];_0x188503[0x0]=_0x2e338a,_0x188503[0x1]=_0x136512,_0x188503[0x2]=_0x1a2a75,_0x188503[0x3]=_0x1ee04a,_0x188503[0x4]=_0x3efbb9,_0x188503[0x5]=_0x129a04,_0x188503[0x6]=_0x29f4e1,await write(EpdCmd['EPD_CMD_COLOR'],_0x188503);}async function set_EPD_CMD_4_MS(){const _0x240f00=_0x4a9634,_0x55e5aa=document['getElementById'](_0x240f00(0x27c))['value'],_0x1208fa=document['getElementById']('xuanzhuan1')[_0x240f00(0x2a4)],_0x118fb1=document[_0x240f00(0x2d1)](_0x240f00(0x331))[_0x240f00(0x2a4)],_0x49abf3=document['getElementById']('xianshi_peizhi')[_0x240f00(0x2a4)],_0xd0ba98=document['getElementById'](_0x240f00(0x223))[_0x240f00(0x2a4)],_0x5f5c3a=document['getElementById'](_0x240f00(0x2c8))[_0x240f00(0x2a4)],_0x9e093=document['getElementById']('silian_ziti')[_0x240f00(0x2a4)],_0x1da489=[0x7];_0x1da489[0x0]=_0x55e5aa,_0x1da489[0x1]=_0x1208fa,_0x1da489[0x2]=_0x118fb1,_0x1da489[0x3]=_0x49abf3,_0x1da489[0x4]=_0xd0ba98,_0x1da489[0x5]=_0x5f5c3a,_0x1da489[0x6]=_0x9e093,await write(EpdCmd[_0x240f00(0x230)],_0x1da489);}async function syncTime(_0x247d79){const _0x5c9060=_0x4a9634,_0x2134bd=new Date()['getTime']()/0x3e8,_0x8ab1d5=new Uint8Array([_0x2134bd>>0x18&0xff,_0x2134bd>>0x10&0xff,_0x2134bd>>0x8&0xff,_0x2134bd&0xff,-(new Date()[_0x5c9060(0x1e3)]()/0x3c),_0x247d79]);await write(EpdCmd[_0x5c9060(0x2a5)],_0x8ab1d5)&&addLog('已同步时间！');}async function set_EPD_CMD_4_ZF(_0x1ab9df){const _0x3172e7=_0x4a9634,_0x2c1a1c=[0x1];_0x2c1a1c[0x0]=_0x1ab9df,await write(EpdCmd[_0x3172e7(0x1f1)],_0x2c1a1c),_0x1ab9df==0x0&&(syncTime(0x2),addLog(_0x3172e7(0x1db)));}window[_0x4a9634(0x292)]=init;
