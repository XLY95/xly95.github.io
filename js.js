const _0x357eb9=_0x3d65;(function(_0x43c0ba,_0x5b4d2d){const _0x36dba5=_0x3d65,_0x18d9c6=_0x43c0ba();while(!![]){try{const _0x3ff600=parseInt(_0x36dba5(0x20c))/0x1+-parseInt(_0x36dba5(0x19b))/0x2*(parseInt(_0x36dba5(0x174))/0x3)+-parseInt(_0x36dba5(0x1d6))/0x4+parseInt(_0x36dba5(0x172))/0x5+parseInt(_0x36dba5(0x10e))/0x6*(-parseInt(_0x36dba5(0x14e))/0x7)+parseInt(_0x36dba5(0xf9))/0x8*(parseInt(_0x36dba5(0x190))/0x9)+-parseInt(_0x36dba5(0x17d))/0xa*(-parseInt(_0x36dba5(0x1b9))/0xb);if(_0x3ff600===_0x5b4d2d)break;else _0x18d9c6['push'](_0x18d9c6['shift']());}catch(_0x7a99fb){_0x18d9c6['push'](_0x18d9c6['shift']());}}}(_0x147c,0x6c5ba));let sourceImage=null,originalImage=null,canvas,ctx,floatCanvas,floatCtx,originalCanvasData=null,startTime,currentParams={'saturation':0x64,'brightness':0x64,'contrast':0x64,'diffusion':0x32,'ditherAlg':'floydSteinberg'},currentMode=_0x357eb9(0xe2),canvasRotation=0x0,isDrawing=![],lastX=0x0,lastY=0x0,currentTool=_0x357eb9(0x148),brushSize=0x3,brushColor=_0x357eb9(0xd6),imageScale=0x64,imageOffset={'x':0x0,'y':0x0},isDraggingImage=![],dragStartPos={'x':0x0,'y':0x0},shiftKeyPressed=![],imageRotation=0x0,isDrawingModeActive=![],isDragging=![],dragOffset={'x':0x0,'y':0x0},isResizing=![],bleDevice,gattServer,epdService,epdCharacteristic,msgIndex,appVersion,textDecoder;const canvasSizes=[{'name':'2.13_122_250','width':0x7a,'height':0xfa},{'name':_0x357eb9(0x1f7),'width':0x190,'height':0x12c},{'name':_0x357eb9(0x142),'width':0x320,'height':0x1e0}],threeColorPalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1},{'name':'红色','r':0xff,'g':0x0,'b':0x0,'value':0x2}],blackWhitePalette=[{'name':'黑色','r':0x0,'g':0x0,'b':0x0,'value':0x0},{'name':'白色','r':0xff,'g':0xff,'b':0xff,'value':0x1}];function adjustContrast(_0x4b802e,_0x15c3b1){const _0x54dd83=_0x357eb9,_0x22e466=_0x4b802e[_0x54dd83(0xdf)];for(let _0x5b389c=0x0;_0x5b389c<_0x22e466[_0x54dd83(0x18a)];_0x5b389c+=0x4){_0x22e466[_0x5b389c]=Math[_0x54dd83(0x10d)](0xff,Math[_0x54dd83(0x175)](0x0,(_0x22e466[_0x5b389c]-0x80)*_0x15c3b1+0x80)),_0x22e466[_0x5b389c+0x1]=Math[_0x54dd83(0x10d)](0xff,Math[_0x54dd83(0x175)](0x0,(_0x22e466[_0x5b389c+0x1]-0x80)*_0x15c3b1+0x80)),_0x22e466[_0x5b389c+0x2]=Math['min'](0xff,Math['max'](0x0,(_0x22e466[_0x5b389c+0x2]-0x80)*_0x15c3b1+0x80));}return _0x4b802e;}function adjustBrightness(_0x1d24db,_0x31428b){const _0x165dc2=_0x357eb9,_0x33005c=_0x31428b/0x64,_0x49f94f=_0x1d24db[_0x165dc2(0xdf)];for(let _0x11ce9d=0x0;_0x11ce9d<_0x49f94f[_0x165dc2(0x18a)];_0x11ce9d+=0x4){_0x49f94f[_0x11ce9d]=Math[_0x165dc2(0x10d)](0xff,Math['max'](0x0,_0x49f94f[_0x11ce9d]*_0x33005c)),_0x49f94f[_0x11ce9d+0x1]=Math[_0x165dc2(0x10d)](0xff,Math[_0x165dc2(0x175)](0x0,_0x49f94f[_0x11ce9d+0x1]*_0x33005c)),_0x49f94f[_0x11ce9d+0x2]=Math[_0x165dc2(0x10d)](0xff,Math[_0x165dc2(0x175)](0x0,_0x49f94f[_0x11ce9d+0x2]*_0x33005c));}return _0x1d24db;}function adjustSaturation(_0x10be7c,_0x2cce03){const _0x363ae7=_0x357eb9,_0x3d666a=_0x10be7c[_0x363ae7(0xdf)];for(let _0x5be8b8=0x0;_0x5be8b8<_0x3d666a['length'];_0x5be8b8+=0x4){const _0x428388=0.299*_0x3d666a[_0x5be8b8]+0.587*_0x3d666a[_0x5be8b8+0x1]+0.114*_0x3d666a[_0x5be8b8+0x2];_0x3d666a[_0x5be8b8]=Math[_0x363ae7(0x10d)](0xff,Math[_0x363ae7(0x175)](0x0,_0x428388+(_0x3d666a[_0x5be8b8]-_0x428388)*_0x2cce03)),_0x3d666a[_0x5be8b8+0x1]=Math[_0x363ae7(0x10d)](0xff,Math[_0x363ae7(0x175)](0x0,_0x428388+(_0x3d666a[_0x5be8b8+0x1]-_0x428388)*_0x2cce03)),_0x3d666a[_0x5be8b8+0x2]=Math['min'](0xff,Math[_0x363ae7(0x175)](0x0,_0x428388+(_0x3d666a[_0x5be8b8+0x2]-_0x428388)*_0x2cce03));}return _0x10be7c;}function rgbToLab(_0xea108b,_0x2429fb,_0x5123d4){const _0x50dc21=_0x357eb9;_0xea108b=_0xea108b/0xff,_0x2429fb=_0x2429fb/0xff,_0x5123d4=_0x5123d4/0xff,_0xea108b=_0xea108b>0.04045?Math[_0x50dc21(0x1cd)]((_0xea108b+0.055)/1.055,2.4):_0xea108b/12.92,_0x2429fb=_0x2429fb>0.04045?Math[_0x50dc21(0x1cd)]((_0x2429fb+0.055)/1.055,2.4):_0x2429fb/12.92,_0x5123d4=_0x5123d4>0.04045?Math[_0x50dc21(0x1cd)]((_0x5123d4+0.055)/1.055,2.4):_0x5123d4/12.92,_0xea108b*=0x64,_0x2429fb*=0x64,_0x5123d4*=0x64;let _0x28f029=_0xea108b*0.4124+_0x2429fb*0.3576+_0x5123d4*0.1805,_0x424ca9=_0xea108b*0.2126+_0x2429fb*0.7152+_0x5123d4*0.0722,_0x4dd51b=_0xea108b*0.0193+_0x2429fb*0.1192+_0x5123d4*0.9505;_0x28f029/=95.047,_0x424ca9/=0x64,_0x4dd51b/=108.883,_0x28f029=_0x28f029>0.008856?Math[_0x50dc21(0x1cd)](_0x28f029,0x1/0x3):7.787*_0x28f029+0x10/0x74,_0x424ca9=_0x424ca9>0.008856?Math[_0x50dc21(0x1cd)](_0x424ca9,0x1/0x3):7.787*_0x424ca9+0x10/0x74,_0x4dd51b=_0x4dd51b>0.008856?Math[_0x50dc21(0x1cd)](_0x4dd51b,0x1/0x3):7.787*_0x4dd51b+0x10/0x74;const _0x2ad6a5=0x74*_0x424ca9-0x10,_0x9a6e16=0x1f4*(_0x28f029-_0x424ca9),_0x340007=0xc8*(_0x424ca9-_0x4dd51b);return{'l':_0x2ad6a5,'a':_0x9a6e16,'b':_0x340007};}function _0x3d65(_0x30ccd8,_0x2ccea2){const _0x147c14=_0x147c();return _0x3d65=function(_0x3d651f,_0x530c78){_0x3d651f=_0x3d651f-0xce;let _0x3e8996=_0x147c14[_0x3d651f];return _0x3e8996;},_0x3d65(_0x30ccd8,_0x2ccea2);}function labDistance(_0x1acd59,_0x4c9fd0){const _0x253d60=_0x357eb9,_0x2f175e=_0x1acd59['l']-_0x4c9fd0['l'],_0x254627=_0x1acd59['a']-_0x4c9fd0['a'],_0x809d66=_0x1acd59['b']-_0x4c9fd0['b'];return Math[_0x253d60(0x108)](0.2*_0x2f175e*_0x2f175e+0x3*_0x254627*_0x254627+0x3*_0x809d66*_0x809d66);}function findClosestColor(_0x1bc186,_0x314913,_0x5a8bbc,_0x4096cf){const _0x3c9f41=_0x357eb9;let _0xf04d59;if(_0x4096cf===_0x3c9f41(0x115)){_0xf04d59=threeColorPalette;if(_0x1bc186>0x78&&_0x1bc186>_0x314913*1.5&&_0x1bc186>_0x5a8bbc*1.5)return threeColorPalette[0x2];const _0x4f55f6=0.299*_0x1bc186+0.587*_0x314913+0.114*_0x5a8bbc;return _0x4f55f6<0x80?threeColorPalette[0x0]:threeColorPalette[0x1];}else{_0xf04d59=blackWhitePalette;const _0x3c18c6=0.299*_0x1bc186+0.587*_0x314913+0.114*_0x5a8bbc;return _0x3c18c6<0x80?blackWhitePalette[0x0]:blackWhitePalette[0x1];}}const DitherAlgorithms={'floydSteinberg':function(_0x26de33,_0x5ac06a,_0x249646){const _0x19e588=_0x357eb9,_0x306a7e=_0x26de33['width'],_0x587ed0=_0x26de33[_0x19e588(0x1e1)],_0x5d23c1=_0x26de33[_0x19e588(0xdf)],_0x4596ee=new Uint8ClampedArray(_0x5d23c1);for(let _0x41e5ab=0x0;_0x41e5ab<_0x587ed0;_0x41e5ab++){for(let _0x56d225=0x0;_0x56d225<_0x306a7e;_0x56d225++){const _0xb65416=(_0x41e5ab*_0x306a7e+_0x56d225)*0x4,_0x5798b4=_0x4596ee[_0xb65416],_0x289c9b=_0x4596ee[_0xb65416+0x1],_0x1d94fd=_0x4596ee[_0xb65416+0x2],_0x327a4e=findClosestColor(_0x5798b4,_0x289c9b,_0x1d94fd,_0x249646),_0xb5f35c=(_0x5798b4-_0x327a4e['r'])*_0x5ac06a,_0x4707f2=(_0x289c9b-_0x327a4e['g'])*_0x5ac06a,_0x4f5ec3=(_0x1d94fd-_0x327a4e['b'])*_0x5ac06a;if(_0x56d225+0x1<_0x306a7e){const _0x236c15=_0xb65416+0x4;_0x4596ee[_0x236c15]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x236c15]+_0xb5f35c*0x7/0x10)),_0x4596ee[_0x236c15+0x1]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x236c15+0x1]+_0x4707f2*0x7/0x10)),_0x4596ee[_0x236c15+0x2]=Math[_0x19e588(0x10d)](0xff,Math['max'](0x0,_0x4596ee[_0x236c15+0x2]+_0x4f5ec3*0x7/0x10));}if(_0x41e5ab+0x1<_0x587ed0){if(_0x56d225>0x0){const _0x48dee8=_0xb65416+_0x306a7e*0x4-0x4;_0x4596ee[_0x48dee8]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x48dee8]+_0xb5f35c*0x3/0x10)),_0x4596ee[_0x48dee8+0x1]=Math[_0x19e588(0x10d)](0xff,Math['max'](0x0,_0x4596ee[_0x48dee8+0x1]+_0x4707f2*0x3/0x10)),_0x4596ee[_0x48dee8+0x2]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x48dee8+0x2]+_0x4f5ec3*0x3/0x10));}const _0x36e7d6=_0xb65416+_0x306a7e*0x4;_0x4596ee[_0x36e7d6]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x36e7d6]+_0xb5f35c*0x5/0x10)),_0x4596ee[_0x36e7d6+0x1]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x36e7d6+0x1]+_0x4707f2*0x5/0x10)),_0x4596ee[_0x36e7d6+0x2]=Math['min'](0xff,Math['max'](0x0,_0x4596ee[_0x36e7d6+0x2]+_0x4f5ec3*0x5/0x10));if(_0x56d225+0x1<_0x306a7e){const _0x2cc72b=_0xb65416+_0x306a7e*0x4+0x4;_0x4596ee[_0x2cc72b]=Math[_0x19e588(0x10d)](0xff,Math[_0x19e588(0x175)](0x0,_0x4596ee[_0x2cc72b]+_0xb5f35c*0x1/0x10)),_0x4596ee[_0x2cc72b+0x1]=Math['min'](0xff,Math['max'](0x0,_0x4596ee[_0x2cc72b+0x1]+_0x4707f2*0x1/0x10)),_0x4596ee[_0x2cc72b+0x2]=Math[_0x19e588(0x10d)](0xff,Math['max'](0x0,_0x4596ee[_0x2cc72b+0x2]+_0x4f5ec3*0x1/0x10));}}}}for(let _0x31959d=0x0;_0x31959d<_0x587ed0;_0x31959d++){for(let _0x44a498=0x0;_0x44a498<_0x306a7e;_0x44a498++){const _0x4a3ee7=(_0x31959d*_0x306a7e+_0x44a498)*0x4,_0x4cf548=_0x4596ee[_0x4a3ee7],_0x4e6ff8=_0x4596ee[_0x4a3ee7+0x1],_0x537e63=_0x4596ee[_0x4a3ee7+0x2],_0x39e819=findClosestColor(_0x4cf548,_0x4e6ff8,_0x537e63,_0x249646);_0x5d23c1[_0x4a3ee7]=_0x39e819['r'],_0x5d23c1[_0x4a3ee7+0x1]=_0x39e819['g'],_0x5d23c1[_0x4a3ee7+0x2]=_0x39e819['b'];}}return _0x26de33;},'atkinson':function(_0x4968b8,_0x59aeca,_0x5130a2){const _0x3f3fbf=_0x357eb9,_0x2d1271=_0x4968b8[_0x3f3fbf(0x20a)],_0x2d8c89=_0x4968b8[_0x3f3fbf(0x1e1)],_0x16f335=_0x4968b8[_0x3f3fbf(0xdf)],_0x1f2dbf=new Uint8ClampedArray(_0x16f335),_0x1ceb57=_0x59aeca*0x1/0x8;for(let _0x5aa014=0x0;_0x5aa014<_0x2d8c89;_0x5aa014++){for(let _0x588d9d=0x0;_0x588d9d<_0x2d1271;_0x588d9d++){const _0x17e75b=(_0x5aa014*_0x2d1271+_0x588d9d)*0x4,_0x385267=_0x1f2dbf[_0x17e75b],_0x9f8a70=_0x1f2dbf[_0x17e75b+0x1],_0x2cb8e0=_0x1f2dbf[_0x17e75b+0x2],_0x25521c=findClosestColor(_0x385267,_0x9f8a70,_0x2cb8e0,_0x5130a2),_0x1dd0e5=(_0x385267-_0x25521c['r'])*_0x1ceb57,_0x5ad067=(_0x9f8a70-_0x25521c['g'])*_0x1ceb57,_0x50bf03=(_0x2cb8e0-_0x25521c['b'])*_0x1ceb57;if(_0x588d9d+0x1<_0x2d1271){const _0xa79390=_0x17e75b+0x4;_0x1f2dbf[_0xa79390]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0xa79390]+_0x1dd0e5)),_0x1f2dbf[_0xa79390+0x1]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0xa79390+0x1]+_0x5ad067)),_0x1f2dbf[_0xa79390+0x2]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0xa79390+0x2]+_0x50bf03));}if(_0x588d9d+0x2<_0x2d1271){const _0x2f95b1=_0x17e75b+0x8;_0x1f2dbf[_0x2f95b1]=Math[_0x3f3fbf(0x10d)](0xff,Math['max'](0x0,_0x1f2dbf[_0x2f95b1]+_0x1dd0e5)),_0x1f2dbf[_0x2f95b1+0x1]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x2f95b1+0x1]+_0x5ad067)),_0x1f2dbf[_0x2f95b1+0x2]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x2f95b1+0x2]+_0x50bf03));}if(_0x5aa014+0x1<_0x2d8c89){if(_0x588d9d>0x0){const _0x490c3a=_0x17e75b+_0x2d1271*0x4-0x4;_0x1f2dbf[_0x490c3a]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x490c3a]+_0x1dd0e5)),_0x1f2dbf[_0x490c3a+0x1]=Math['min'](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x490c3a+0x1]+_0x5ad067)),_0x1f2dbf[_0x490c3a+0x2]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x490c3a+0x2]+_0x50bf03));}const _0x5ba913=_0x17e75b+_0x2d1271*0x4;_0x1f2dbf[_0x5ba913]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x5ba913]+_0x1dd0e5)),_0x1f2dbf[_0x5ba913+0x1]=Math['min'](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x5ba913+0x1]+_0x5ad067)),_0x1f2dbf[_0x5ba913+0x2]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x5ba913+0x2]+_0x50bf03));if(_0x588d9d+0x1<_0x2d1271){const _0x462f19=_0x17e75b+_0x2d1271*0x4+0x4;_0x1f2dbf[_0x462f19]=Math['min'](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x462f19]+_0x1dd0e5)),_0x1f2dbf[_0x462f19+0x1]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x462f19+0x1]+_0x5ad067)),_0x1f2dbf[_0x462f19+0x2]=Math[_0x3f3fbf(0x10d)](0xff,Math[_0x3f3fbf(0x175)](0x0,_0x1f2dbf[_0x462f19+0x2]+_0x50bf03));}}}}for(let _0x22e63d=0x0;_0x22e63d<_0x2d8c89;_0x22e63d++){for(let _0x37f3aa=0x0;_0x37f3aa<_0x2d1271;_0x37f3aa++){const _0x55e69b=(_0x22e63d*_0x2d1271+_0x37f3aa)*0x4,_0x40b2b4=_0x1f2dbf[_0x55e69b],_0x20e4e7=_0x1f2dbf[_0x55e69b+0x1],_0x55e1c5=_0x1f2dbf[_0x55e69b+0x2],_0x484b42=findClosestColor(_0x40b2b4,_0x20e4e7,_0x55e1c5,_0x5130a2);_0x16f335[_0x55e69b]=_0x484b42['r'],_0x16f335[_0x55e69b+0x1]=_0x484b42['g'],_0x16f335[_0x55e69b+0x2]=_0x484b42['b'];}}return _0x4968b8;},'bayer':function(_0x24ce9f,_0x1565bc,_0x5a3ddd){const _0x2c1b4b=_0x357eb9,_0x4ea5d5=_0x24ce9f[_0x2c1b4b(0x20a)],_0x1b9fe4=_0x24ce9f[_0x2c1b4b(0x1e1)],_0x4f1e64=_0x24ce9f[_0x2c1b4b(0xdf)],_0x49a0d6=[[0x0,0x8,0x2,0xa],[0xc,0x4,0xe,0x6],[0x3,0xb,0x1,0x9],[0xf,0x7,0xd,0x5]],_0xf0af0a=0x4,_0x334bc6=0x10;for(let _0x1af522=0x0;_0x1af522<_0x1b9fe4;_0x1af522++){for(let _0x575ec3=0x0;_0x575ec3<_0x4ea5d5;_0x575ec3++){const _0x16266d=(_0x1af522*_0x4ea5d5+_0x575ec3)*0x4,_0x79cab5=_0x4f1e64[_0x16266d],_0x2c50e4=_0x4f1e64[_0x16266d+0x1],_0x1b00a8=_0x4f1e64[_0x16266d+0x2],_0x399352=0.299*_0x79cab5+0.587*_0x2c50e4+0.114*_0x1b00a8,_0x32f9f2=_0x575ec3%_0xf0af0a,_0xac30bf=_0x1af522%_0xf0af0a,_0x1e9b8c=_0x49a0d6[_0xac30bf][_0x32f9f2];let _0x25ba03=_0x399352;if(_0x5a3ddd===_0x2c1b4b(0x115)&&_0x79cab5>0x78&&_0x79cab5>_0x2c50e4*1.5&&_0x79cab5>_0x1b00a8*1.5)_0x4f1e64[_0x16266d]=0xff,_0x4f1e64[_0x16266d+0x1]=0x0,_0x4f1e64[_0x16266d+0x2]=0x0;else{const _0x2f5e29=_0x1e9b8c/_0x334bc6*0xff*_0x1565bc;_0x399352<0x80+(_0x2f5e29-0x80)?(_0x4f1e64[_0x16266d]=0x0,_0x4f1e64[_0x16266d+0x1]=0x0,_0x4f1e64[_0x16266d+0x2]=0x0):(_0x4f1e64[_0x16266d]=0xff,_0x4f1e64[_0x16266d+0x1]=0xff,_0x4f1e64[_0x16266d+0x2]=0xff);}}}return _0x24ce9f;},'stucki':function(_0x45c3b4,_0xb8dd37,_0x4d70ea){const _0x173173=_0x357eb9,_0x2480e3=_0x45c3b4[_0x173173(0x20a)],_0x576616=_0x45c3b4['height'],_0x29ccd5=_0x45c3b4[_0x173173(0xdf)],_0x51b8d0=new Uint8ClampedArray(_0x29ccd5),_0x3fe3c3=_0xb8dd37*0x1/0x2a;for(let _0x5a393b=0x0;_0x5a393b<_0x576616;_0x5a393b++){for(let _0x1adb4d=0x0;_0x1adb4d<_0x2480e3;_0x1adb4d++){const _0x598a78=(_0x5a393b*_0x2480e3+_0x1adb4d)*0x4,_0x3b725c=_0x51b8d0[_0x598a78],_0x5bce73=_0x51b8d0[_0x598a78+0x1],_0x16f459=_0x51b8d0[_0x598a78+0x2],_0x237da8=findClosestColor(_0x3b725c,_0x5bce73,_0x16f459,_0x4d70ea),_0x2b2553=(_0x3b725c-_0x237da8['r'])*_0x3fe3c3,_0x45cd97=(_0x5bce73-_0x237da8['g'])*_0x3fe3c3,_0xcb7139=(_0x16f459-_0x237da8['b'])*_0x3fe3c3;if(_0x1adb4d+0x1<_0x2480e3){const _0x1c31b5=_0x598a78+0x4;_0x51b8d0[_0x1c31b5]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x1c31b5]+_0x2b2553*0x8)),_0x51b8d0[_0x1c31b5+0x1]=Math[_0x173173(0x10d)](0xff,Math['max'](0x0,_0x51b8d0[_0x1c31b5+0x1]+_0x45cd97*0x8)),_0x51b8d0[_0x1c31b5+0x2]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x1c31b5+0x2]+_0xcb7139*0x8));}if(_0x1adb4d+0x2<_0x2480e3){const _0x586cc4=_0x598a78+0x8;_0x51b8d0[_0x586cc4]=Math['min'](0xff,Math['max'](0x0,_0x51b8d0[_0x586cc4]+_0x2b2553*0x4)),_0x51b8d0[_0x586cc4+0x1]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x586cc4+0x1]+_0x45cd97*0x4)),_0x51b8d0[_0x586cc4+0x2]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x586cc4+0x2]+_0xcb7139*0x4));}if(_0x5a393b+0x1<_0x576616){if(_0x1adb4d>0x1){const _0xf99fcd=_0x598a78+_0x2480e3*0x4-0x8;_0x51b8d0[_0xf99fcd]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0xf99fcd]+_0x2b2553*0x2)),_0x51b8d0[_0xf99fcd+0x1]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0xf99fcd+0x1]+_0x45cd97*0x2)),_0x51b8d0[_0xf99fcd+0x2]=Math[_0x173173(0x10d)](0xff,Math['max'](0x0,_0x51b8d0[_0xf99fcd+0x2]+_0xcb7139*0x2));}if(_0x1adb4d>0x0){const _0x5c9709=_0x598a78+_0x2480e3*0x4-0x4;_0x51b8d0[_0x5c9709]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x5c9709]+_0x2b2553*0x4)),_0x51b8d0[_0x5c9709+0x1]=Math['min'](0xff,Math['max'](0x0,_0x51b8d0[_0x5c9709+0x1]+_0x45cd97*0x4)),_0x51b8d0[_0x5c9709+0x2]=Math[_0x173173(0x10d)](0xff,Math['max'](0x0,_0x51b8d0[_0x5c9709+0x2]+_0xcb7139*0x4));}const _0xa3e5ae=_0x598a78+_0x2480e3*0x4;_0x51b8d0[_0xa3e5ae]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0xa3e5ae]+_0x2b2553*0x8)),_0x51b8d0[_0xa3e5ae+0x1]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0xa3e5ae+0x1]+_0x45cd97*0x8)),_0x51b8d0[_0xa3e5ae+0x2]=Math['min'](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0xa3e5ae+0x2]+_0xcb7139*0x8));if(_0x1adb4d+0x1<_0x2480e3){const _0x386b5e=_0x598a78+_0x2480e3*0x4+0x4;_0x51b8d0[_0x386b5e]=Math[_0x173173(0x10d)](0xff,Math['max'](0x0,_0x51b8d0[_0x386b5e]+_0x2b2553*0x4)),_0x51b8d0[_0x386b5e+0x1]=Math['min'](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x386b5e+0x1]+_0x45cd97*0x4)),_0x51b8d0[_0x386b5e+0x2]=Math['min'](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x386b5e+0x2]+_0xcb7139*0x4));}if(_0x1adb4d+0x2<_0x2480e3){const _0x31ee10=_0x598a78+_0x2480e3*0x4+0x8;_0x51b8d0[_0x31ee10]=Math['min'](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x31ee10]+_0x2b2553*0x2)),_0x51b8d0[_0x31ee10+0x1]=Math[_0x173173(0x10d)](0xff,Math[_0x173173(0x175)](0x0,_0x51b8d0[_0x31ee10+0x1]+_0x45cd97*0x2)),_0x51b8d0[_0x31ee10+0x2]=Math[_0x173173(0x10d)](0xff,Math['max'](0x0,_0x51b8d0[_0x31ee10+0x2]+_0xcb7139*0x2));}}}}for(let _0x1d2087=0x0;_0x1d2087<_0x576616;_0x1d2087++){for(let _0x266b9c=0x0;_0x266b9c<_0x2480e3;_0x266b9c++){const _0x5d95ca=(_0x1d2087*_0x2480e3+_0x266b9c)*0x4,_0x16064e=_0x51b8d0[_0x5d95ca],_0x121fde=_0x51b8d0[_0x5d95ca+0x1],_0x37e3b8=_0x51b8d0[_0x5d95ca+0x2],_0x31e12b=findClosestColor(_0x16064e,_0x121fde,_0x37e3b8,_0x4d70ea);_0x29ccd5[_0x5d95ca]=_0x31e12b['r'],_0x29ccd5[_0x5d95ca+0x1]=_0x31e12b['g'],_0x29ccd5[_0x5d95ca+0x2]=_0x31e12b['b'];}}return _0x45c3b4;},'jarvis':function(_0x40e369,_0x1675df,_0x3b9022){const _0x2f20dd=_0x357eb9,_0x42de35=_0x40e369[_0x2f20dd(0x20a)],_0x273b89=_0x40e369[_0x2f20dd(0x1e1)],_0x1be8dc=_0x40e369[_0x2f20dd(0xdf)],_0x25dfcd=new Uint8ClampedArray(_0x1be8dc),_0xa83ae9=_0x1675df*0x1/0x30;for(let _0x7657ef=0x0;_0x7657ef<_0x273b89;_0x7657ef++){for(let _0x26c45e=0x0;_0x26c45e<_0x42de35;_0x26c45e++){const _0x2735ad=(_0x7657ef*_0x42de35+_0x26c45e)*0x4,_0xc3bf8b=_0x25dfcd[_0x2735ad],_0x2f4bcc=_0x25dfcd[_0x2735ad+0x1],_0x2bd70a=_0x25dfcd[_0x2735ad+0x2],_0x5fa2fa=findClosestColor(_0xc3bf8b,_0x2f4bcc,_0x2bd70a,_0x3b9022),_0x3f14b8=(_0xc3bf8b-_0x5fa2fa['r'])*_0xa83ae9,_0x62b069=(_0x2f4bcc-_0x5fa2fa['g'])*_0xa83ae9,_0x13f8ac=(_0x2bd70a-_0x5fa2fa['b'])*_0xa83ae9;if(_0x26c45e+0x1<_0x42de35){const _0x2a9b16=_0x2735ad+0x4;_0x25dfcd[_0x2a9b16]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2a9b16]+_0x3f14b8*0x7)),_0x25dfcd[_0x2a9b16+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2a9b16+0x1]+_0x62b069*0x7)),_0x25dfcd[_0x2a9b16+0x2]=Math['min'](0xff,Math['max'](0x0,_0x25dfcd[_0x2a9b16+0x2]+_0x13f8ac*0x7));}if(_0x26c45e+0x2<_0x42de35){const _0x2bfd1e=_0x2735ad+0x8;_0x25dfcd[_0x2bfd1e]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x2bfd1e]+_0x3f14b8*0x5)),_0x25dfcd[_0x2bfd1e+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2bfd1e+0x1]+_0x62b069*0x5)),_0x25dfcd[_0x2bfd1e+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2bfd1e+0x2]+_0x13f8ac*0x5));}if(_0x7657ef+0x1<_0x273b89){if(_0x26c45e>0x1){const _0xc543f7=_0x2735ad+_0x42de35*0x4-0x8;_0x25dfcd[_0xc543f7]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0xc543f7]+_0x3f14b8*0x3)),_0x25dfcd[_0xc543f7+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0xc543f7+0x1]+_0x62b069*0x3)),_0x25dfcd[_0xc543f7+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0xc543f7+0x2]+_0x13f8ac*0x3));}if(_0x26c45e>0x0){const _0x2e4509=_0x2735ad+_0x42de35*0x4-0x4;_0x25dfcd[_0x2e4509]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2e4509]+_0x3f14b8*0x5)),_0x25dfcd[_0x2e4509+0x1]=Math['min'](0xff,Math['max'](0x0,_0x25dfcd[_0x2e4509+0x1]+_0x62b069*0x5)),_0x25dfcd[_0x2e4509+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2e4509+0x2]+_0x13f8ac*0x5));}const _0x4ea7bf=_0x2735ad+_0x42de35*0x4;_0x25dfcd[_0x4ea7bf]=Math['min'](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x4ea7bf]+_0x3f14b8*0x7)),_0x25dfcd[_0x4ea7bf+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x4ea7bf+0x1]+_0x62b069*0x7)),_0x25dfcd[_0x4ea7bf+0x2]=Math['min'](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x4ea7bf+0x2]+_0x13f8ac*0x7));if(_0x26c45e+0x1<_0x42de35){const _0x44c01f=_0x2735ad+_0x42de35*0x4+0x4;_0x25dfcd[_0x44c01f]=Math['min'](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x44c01f]+_0x3f14b8*0x5)),_0x25dfcd[_0x44c01f+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x44c01f+0x1]+_0x62b069*0x5)),_0x25dfcd[_0x44c01f+0x2]=Math['min'](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x44c01f+0x2]+_0x13f8ac*0x5));}if(_0x26c45e+0x2<_0x42de35){const _0x2fd931=_0x2735ad+_0x42de35*0x4+0x8;_0x25dfcd[_0x2fd931]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x2fd931]+_0x3f14b8*0x3)),_0x25dfcd[_0x2fd931+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x2fd931+0x1]+_0x62b069*0x3)),_0x25dfcd[_0x2fd931+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2fd931+0x2]+_0x13f8ac*0x3));}}if(_0x7657ef+0x2<_0x273b89){if(_0x26c45e>0x1){const _0x424ab9=_0x2735ad+_0x42de35*0x4*0x2-0x8;_0x25dfcd[_0x424ab9]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x424ab9]+_0x3f14b8*0x1)),_0x25dfcd[_0x424ab9+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x424ab9+0x1]+_0x62b069*0x1)),_0x25dfcd[_0x424ab9+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x424ab9+0x2]+_0x13f8ac*0x1));}if(_0x26c45e>0x0){const _0x495469=_0x2735ad+_0x42de35*0x4*0x2-0x4;_0x25dfcd[_0x495469]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x495469]+_0x3f14b8*0x3)),_0x25dfcd[_0x495469+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x495469+0x1]+_0x62b069*0x3)),_0x25dfcd[_0x495469+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x495469+0x2]+_0x13f8ac*0x3));}const _0x109ce6=_0x2735ad+_0x42de35*0x4*0x2;_0x25dfcd[_0x109ce6]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x109ce6]+_0x3f14b8*0x5)),_0x25dfcd[_0x109ce6+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x109ce6+0x1]+_0x62b069*0x5)),_0x25dfcd[_0x109ce6+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x109ce6+0x2]+_0x13f8ac*0x5));if(_0x26c45e+0x1<_0x42de35){const _0x2c7ca1=_0x2735ad+_0x42de35*0x4*0x2+0x4;_0x25dfcd[_0x2c7ca1]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2c7ca1]+_0x3f14b8*0x3)),_0x25dfcd[_0x2c7ca1+0x1]=Math['min'](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2c7ca1+0x1]+_0x62b069*0x3)),_0x25dfcd[_0x2c7ca1+0x2]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x2c7ca1+0x2]+_0x13f8ac*0x3));}if(_0x26c45e+0x2<_0x42de35){const _0x2ce0eb=_0x2735ad+_0x42de35*0x4*0x2+0x8;_0x25dfcd[_0x2ce0eb]=Math[_0x2f20dd(0x10d)](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2ce0eb]+_0x3f14b8*0x1)),_0x25dfcd[_0x2ce0eb+0x1]=Math[_0x2f20dd(0x10d)](0xff,Math['max'](0x0,_0x25dfcd[_0x2ce0eb+0x1]+_0x62b069*0x1)),_0x25dfcd[_0x2ce0eb+0x2]=Math['min'](0xff,Math[_0x2f20dd(0x175)](0x0,_0x25dfcd[_0x2ce0eb+0x2]+_0x13f8ac*0x1));}}}}for(let _0x53214b=0x0;_0x53214b<_0x273b89;_0x53214b++){for(let _0x10129d=0x0;_0x10129d<_0x42de35;_0x10129d++){const _0x5d8257=(_0x53214b*_0x42de35+_0x10129d)*0x4,_0x1642b6=_0x25dfcd[_0x5d8257],_0x9c1007=_0x25dfcd[_0x5d8257+0x1],_0x1a0b29=_0x25dfcd[_0x5d8257+0x2],_0x2644cb=findClosestColor(_0x1642b6,_0x9c1007,_0x1a0b29,_0x3b9022);_0x1be8dc[_0x5d8257]=_0x2644cb['r'],_0x1be8dc[_0x5d8257+0x1]=_0x2644cb['g'],_0x1be8dc[_0x5d8257+0x2]=_0x2644cb['b'];}}return _0x40e369;}};function floydSteinbergDither(_0x8bffb1,_0x425dc8,_0xa27478){const _0x356b42=_0x357eb9,_0x504134=_0x8bffb1['width'],_0x246b8e=_0x8bffb1[_0x356b42(0x1e1)],_0x1bfc7a=_0x8bffb1['data'],_0x4a171a=new Uint8ClampedArray(_0x1bfc7a);for(let _0x3a2ca8=0x0;_0x3a2ca8<_0x246b8e;_0x3a2ca8++){for(let _0x38b548=0x0;_0x38b548<_0x504134;_0x38b548++){const _0x3b54be=(_0x3a2ca8*_0x504134+_0x38b548)*0x4,_0x326555=_0x4a171a[_0x3b54be],_0x56aeb4=_0x4a171a[_0x3b54be+0x1],_0x4a88c1=_0x4a171a[_0x3b54be+0x2],_0x400bde=findClosestColor(_0x326555,_0x56aeb4,_0x4a88c1,_0xa27478),_0x5e32f3=(_0x326555-_0x400bde['r'])*_0x425dc8,_0x54079c=(_0x56aeb4-_0x400bde['g'])*_0x425dc8,_0x2583d4=(_0x4a88c1-_0x400bde['b'])*_0x425dc8;if(_0x38b548+0x1<_0x504134){const _0x591e23=_0x3b54be+0x4;_0x4a171a[_0x591e23]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x591e23]+_0x5e32f3*0x7/0x10)),_0x4a171a[_0x591e23+0x1]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x591e23+0x1]+_0x54079c*0x7/0x10)),_0x4a171a[_0x591e23+0x2]=Math['min'](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x591e23+0x2]+_0x2583d4*0x7/0x10));}if(_0x3a2ca8+0x1<_0x246b8e){if(_0x38b548>0x0){const _0x20969c=_0x3b54be+_0x504134*0x4-0x4;_0x4a171a[_0x20969c]=Math[_0x356b42(0x10d)](0xff,Math['max'](0x0,_0x4a171a[_0x20969c]+_0x5e32f3*0x3/0x10)),_0x4a171a[_0x20969c+0x1]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x20969c+0x1]+_0x54079c*0x3/0x10)),_0x4a171a[_0x20969c+0x2]=Math[_0x356b42(0x10d)](0xff,Math['max'](0x0,_0x4a171a[_0x20969c+0x2]+_0x2583d4*0x3/0x10));}const _0x4db23e=_0x3b54be+_0x504134*0x4;_0x4a171a[_0x4db23e]=Math[_0x356b42(0x10d)](0xff,Math['max'](0x0,_0x4a171a[_0x4db23e]+_0x5e32f3*0x5/0x10)),_0x4a171a[_0x4db23e+0x1]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x4db23e+0x1]+_0x54079c*0x5/0x10)),_0x4a171a[_0x4db23e+0x2]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x4db23e+0x2]+_0x2583d4*0x5/0x10));if(_0x38b548+0x1<_0x504134){const _0x520be2=_0x3b54be+_0x504134*0x4+0x4;_0x4a171a[_0x520be2]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x520be2]+_0x5e32f3*0x1/0x10)),_0x4a171a[_0x520be2+0x1]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x520be2+0x1]+_0x54079c*0x1/0x10)),_0x4a171a[_0x520be2+0x2]=Math[_0x356b42(0x10d)](0xff,Math[_0x356b42(0x175)](0x0,_0x4a171a[_0x520be2+0x2]+_0x2583d4*0x1/0x10));}}}}for(let _0x3a6cc=0x0;_0x3a6cc<_0x246b8e;_0x3a6cc++){for(let _0x352c40=0x0;_0x352c40<_0x504134;_0x352c40++){const _0x354870=(_0x3a6cc*_0x504134+_0x352c40)*0x4,_0x35a214=_0x4a171a[_0x354870],_0x2eb305=_0x4a171a[_0x354870+0x1],_0x48200e=_0x4a171a[_0x354870+0x2],_0x43a993=findClosestColor(_0x35a214,_0x2eb305,_0x48200e,_0xa27478);_0x1bfc7a[_0x354870]=_0x43a993['r'],_0x1bfc7a[_0x354870+0x1]=_0x43a993['g'],_0x1bfc7a[_0x354870+0x2]=_0x43a993['b'];}}return _0x8bffb1;}function processImage1(_0x3957d1,_0x60bb78,_0x155dee,_0x5d6137,_0x641242,_0x47d9dd,_0x5aea23){const _0x32d666=_0x357eb9,_0x1d2371=new ImageData(new Uint8ClampedArray(_0x3957d1[_0x32d666(0xdf)]),_0x3957d1[_0x32d666(0x20a)],_0x3957d1[_0x32d666(0x1e1)]);return adjustBrightness(_0x1d2371,_0x60bb78),adjustContrast(_0x1d2371,_0x155dee),adjustSaturation(_0x1d2371,_0x5d6137),DitherAlgorithms[_0x5aea23]?DitherAlgorithms[_0x5aea23](_0x1d2371,_0x641242,_0x47d9dd):floydSteinbergDither(_0x1d2371,_0x641242,_0x47d9dd),_0x1d2371;}function imageDataToEpdBytes(_0x3a84af,_0x42069c){const _0x3a1399=_0x357eb9,_0x4d9ba8=_0x3a84af[_0x3a1399(0x20a)],_0x22ec85=_0x3a84af[_0x3a1399(0x1e1)],_0x7a97b=_0x3a84af[_0x3a1399(0xdf)];let _0x1a3f88;if(_0x42069c===_0x3a1399(0x115)){_0x1a3f88=new Uint8Array(Math[_0x3a1399(0x1a7)](_0x4d9ba8*_0x22ec85/0x8)*0x2);let _0x383af4=0x0,_0x11e3e3=Math[_0x3a1399(0x1a7)](_0x4d9ba8*_0x22ec85/0x8),_0x3ba6c4=0x0,_0x344fec=0x0,_0x30ad8e=0x0;for(let _0x3cbc8e=0x0;_0x3cbc8e<_0x7a97b[_0x3a1399(0x18a)];_0x3cbc8e+=0x4){const _0x4bc87e=_0x7a97b[_0x3cbc8e],_0x5c12ff=_0x7a97b[_0x3cbc8e+0x1],_0x3cb2d7=_0x7a97b[_0x3cbc8e+0x2],_0x2dbb20=_0x4bc87e>0xc8&&_0x5c12ff<0x32&&_0x3cb2d7<0x32,_0x4de506=!_0x2dbb20&&0.299*_0x4bc87e+0.587*_0x5c12ff+0.114*_0x3cb2d7<0x80;_0x4de506&&(_0x344fec|=0x1<<0x7-_0x3ba6c4),_0x2dbb20&&(_0x30ad8e|=0x1<<0x7-_0x3ba6c4),_0x3ba6c4++,_0x3ba6c4===0x8&&(_0x1a3f88[_0x383af4++]=_0x344fec,_0x1a3f88[_0x11e3e3++]=_0x30ad8e,_0x3ba6c4=0x0,_0x344fec=0x0,_0x30ad8e=0x0);}_0x3ba6c4>0x0&&(_0x1a3f88[_0x383af4]=_0x344fec,_0x1a3f88[_0x11e3e3]=_0x30ad8e);}else{_0x1a3f88=new Uint8Array(Math[_0x3a1399(0x1a7)](_0x4d9ba8*_0x22ec85/0x8));let _0x354d3d=0x0,_0x3ed166=0x0,_0x35e154=0x0;for(let _0x5b041e=0x0;_0x5b041e<_0x7a97b[_0x3a1399(0x18a)];_0x5b041e+=0x4){const _0x2f4e6e=_0x7a97b[_0x5b041e],_0x46c179=_0x7a97b[_0x5b041e+0x1],_0x3cfa3c=_0x7a97b[_0x5b041e+0x2],_0x4366e8=0.299*_0x2f4e6e+0.587*_0x46c179+0.114*_0x3cfa3c<0x80;_0x4366e8&&(_0x35e154|=0x1<<0x7-_0x3ed166),_0x3ed166++,_0x3ed166===0x8&&(_0x1a3f88[_0x354d3d++]=_0x35e154,_0x3ed166=0x0,_0x35e154=0x0);}_0x3ed166>0x0&&(_0x1a3f88[_0x354d3d]=_0x35e154);}return _0x1a3f88;}const imageUpload=document['getElementById'](_0x357eb9(0x13a)),previewCanvas=document[_0x357eb9(0x1de)]('previewCanvas'),floatPreviewCanvas=document[_0x357eb9(0x1de)](_0x357eb9(0x1a8)),noImagePlaceholder=document[_0x357eb9(0x1de)](_0x357eb9(0x1eb)),processedImageInfo=document[_0x357eb9(0x1de)](_0x357eb9(0x12c)),btnProcess=document[_0x357eb9(0x1de)]('btnProcess'),btnSend=document[_0x357eb9(0x1de)]('btnSend'),btnDownload=document[_0x357eb9(0x1de)](_0x357eb9(0xed)),btnReset=document['getElementById'](_0x357eb9(0x1d4)),btnClearLog=document['getElementById'](_0x357eb9(0x1af)),btnBlackWhite=document[_0x357eb9(0x1de)](_0x357eb9(0x18e)),btnBlackWhiteRed=document[_0x357eb9(0x1de)](_0x357eb9(0x151)),ditherMode=document[_0x357eb9(0x1de)]('ditherMode'),ditherAlg=document[_0x357eb9(0x1de)](_0x357eb9(0x1a3)),logContainer=document['getElementById'](_0x357eb9(0x120)),statusContainer=document['getElementById'](_0x357eb9(0xf4)),floatingCanvasContainer=document[_0x357eb9(0x1de)](_0x357eb9(0x105)),toggleCanvasFloat=document[_0x357eb9(0x1de)](_0x357eb9(0xda)),closeCanvas=document[_0x357eb9(0x1de)](_0x357eb9(0x1fe)),canvasResizeHandle=document[_0x357eb9(0x1de)](_0x357eb9(0x163)),imageScaleSlider=document[_0x357eb9(0x1de)](_0x357eb9(0x1b6)),imageScaleValue=document['getElementById']('imageScaleValue'),addTextBtn=document[_0x357eb9(0x1de)](_0x357eb9(0x1f3)),timeDialog=document[_0x357eb9(0x1de)]('timeDialog'),datetimeInput=document[_0x357eb9(0x1de)]('datetimeInput'),closeTimeDialog=document[_0x357eb9(0x1de)]('closeTimeDialog'),confirmTimeBtn=document[_0x357eb9(0x1de)](_0x357eb9(0x10a)),imageWidthInput=document['getElementById'](_0x357eb9(0x18f)),imageHeightInput=document['getElementById'](_0x357eb9(0xf6)),toolPen=document['getElementById'](_0x357eb9(0x11f)),toolEraser=document['getElementById']('toolEraser'),toolText=document[_0x357eb9(0x1de)]('toolText'),toolClear=document[_0x357eb9(0x1de)](_0x357eb9(0xfd)),brushSizeSlider=document[_0x357eb9(0x1de)](_0x357eb9(0x1c6)),fontSizeInput=document[_0x357eb9(0x1de)](_0x357eb9(0xde)),fontFamilySelect=document[_0x357eb9(0x1de)](_0x357eb9(0x19e)),textInput=document[_0x357eb9(0x1de)](_0x357eb9(0x13e)),drawingStatus=document[_0x357eb9(0x1de)](_0x357eb9(0x184)),currentToolEl=document[_0x357eb9(0x1de)]('currentTool'),currentSizeEl=document[_0x357eb9(0x1de)](_0x357eb9(0x171)),drawingModeIndicator=document[_0x357eb9(0x1de)](_0x357eb9(0x1ac)),toggleDrawingModeBtn=document['getElementById'](_0x357eb9(0xe6)),floatToggleDrawingModeBtn=document[_0x357eb9(0x1de)](_0x357eb9(0x14f)),sliders={'saturation':document[_0x357eb9(0x1de)](_0x357eb9(0x177)),'brightness':document[_0x357eb9(0x1de)](_0x357eb9(0x160)),'contrast':document[_0x357eb9(0x1de)](_0x357eb9(0x1c7)),'diffusion':document[_0x357eb9(0x1de)](_0x357eb9(0x176))},ditherSlider=document[_0x357eb9(0x1de)](_0x357eb9(0x210)),sliderValues={'saturation':document[_0x357eb9(0x1de)]('saturationValue'),'brightness':document[_0x357eb9(0x1de)](_0x357eb9(0x199)),'contrast':document[_0x357eb9(0x1de)](_0x357eb9(0x118)),'diffusion':document[_0x357eb9(0x1de)](_0x357eb9(0x102))};function init(){const _0x8ef89f=_0x357eb9;canvas=previewCanvas,ctx=canvas['getContext']('2d'),floatCanvas=floatPreviewCanvas,floatCtx=floatCanvas[_0x8ef89f(0x1b1)]('2d'),updateCanvasSize();const _0x42762b=new Date(),_0x2ca517=new Date(_0x42762b[_0x8ef89f(0x200)]()-_0x42762b[_0x8ef89f(0x187)]()*0xea60)[_0x8ef89f(0xee)]()[_0x8ef89f(0x1a0)](0x0,0x10);datetimeInput[_0x8ef89f(0x1dd)]=_0x2ca517,canvas[_0x8ef89f(0xef)](_0x8ef89f(0x1ea),startDrawing),canvas[_0x8ef89f(0xef)](_0x8ef89f(0x208),draw),canvas[_0x8ef89f(0xef)](_0x8ef89f(0xdd),stopDrawing),canvas[_0x8ef89f(0xef)](_0x8ef89f(0x10f),stopDrawing),floatCanvas[_0x8ef89f(0xef)](_0x8ef89f(0x1ea),startDrawingFloat),floatCanvas[_0x8ef89f(0xef)](_0x8ef89f(0x208),drawFloat),floatCanvas['addEventListener']('mouseup',stopDrawing),floatCanvas['addEventListener'](_0x8ef89f(0x10f),stopDrawing),canvas[_0x8ef89f(0xef)]('touchstart',handleTouchStart,{'passive':![]}),canvas[_0x8ef89f(0xef)]('touchmove',handleTouchMove,{'passive':![]}),canvas[_0x8ef89f(0xef)](_0x8ef89f(0x1e8),handleTouchEnd),canvas[_0x8ef89f(0xef)](_0x8ef89f(0x135),handleTouchEnd),floatCanvas[_0x8ef89f(0xef)](_0x8ef89f(0x12d),handleFloatTouchStart,{'passive':![]}),floatCanvas[_0x8ef89f(0xef)](_0x8ef89f(0x165),handleFloatTouchMove,{'passive':![]}),floatCanvas[_0x8ef89f(0xef)](_0x8ef89f(0x1e8),handleTouchEnd),floatCanvas[_0x8ef89f(0xef)]('touchcancel',handleTouchEnd),document[_0x8ef89f(0xef)]('keydown',_0x3f222a=>{const _0x2587f0=_0x8ef89f;_0x3f222a[_0x2587f0(0x1c3)]===_0x2587f0(0x205)&&(shiftKeyPressed=!![],sourceImage&&!isDrawingModeActive&&(canvas[_0x2587f0(0xeb)]['cursor']=_0x2587f0(0x139),floatCanvas[_0x2587f0(0xeb)][_0x2587f0(0x124)]=_0x2587f0(0x139)));}),document[_0x8ef89f(0xef)](_0x8ef89f(0x134),_0x304409=>{const _0x1c7094=_0x8ef89f;_0x304409[_0x1c7094(0x1c3)]===_0x1c7094(0x205)&&(shiftKeyPressed=![],updateCursorStyle());}),toggleDrawingModeBtn[_0x8ef89f(0xef)]('click',toggleDrawingMode),floatToggleDrawingModeBtn['addEventListener'](_0x8ef89f(0x18c),toggleDrawingMode),btnProcess[_0x8ef89f(0xef)](_0x8ef89f(0x18c),processImage),btnSend[_0x8ef89f(0xef)](_0x8ef89f(0x18c),sendimg),btnDownload[_0x8ef89f(0xef)]('click',downloadImageFile),btnReset['addEventListener'](_0x8ef89f(0x18c),resetProcessing),btnClearLog[_0x8ef89f(0xef)]('click',clearLog),toggleCanvasFloat['addEventListener'](_0x8ef89f(0x18c),toggleCanvas),closeCanvas['addEventListener'](_0x8ef89f(0x18c),hideCanvas),btnSetTime[_0x8ef89f(0xef)](_0x8ef89f(0x18c),showTimeDialog),closeTimeDialog[_0x8ef89f(0xef)](_0x8ef89f(0x18c),hideTimeDialog),confirmTimeBtn['addEventListener'](_0x8ef89f(0x18c),setTime),brushSizeSlider[_0x8ef89f(0xef)]('input',function(){const _0x55c29a=_0x8ef89f;brushSize=parseInt(this['value']),currentSizeEl[_0x55c29a(0x1fb)]=brushSize;});const _0x4fe68c=floatingCanvasContainer[_0x8ef89f(0xcf)](_0x8ef89f(0x207));_0x4fe68c['addEventListener'](_0x8ef89f(0x1ea),startDrag),document['addEventListener']('mousemove',drag),document[_0x8ef89f(0xef)](_0x8ef89f(0xdd),stopDrag),canvasResizeHandle[_0x8ef89f(0xef)](_0x8ef89f(0x1ea),startResize),document[_0x8ef89f(0xef)](_0x8ef89f(0x208),resize),document['addEventListener'](_0x8ef89f(0xdd),stopResize),Object['keys'](sliders)['forEach'](_0x2841b8=>{const _0x3d11ab=_0x8ef89f;sliders[_0x2841b8]['addEventListener'](_0x3d11ab(0x1a5),_0x2b9499=>{const _0x5043a9=_0x3d11ab;currentParams[_0x2841b8]=parseInt(_0x2b9499['target'][_0x5043a9(0x1dd)]),sliderValues[_0x2841b8][_0x5043a9(0x1fb)]=''+currentParams[_0x2841b8];});}),document[_0x8ef89f(0x1de)](_0x8ef89f(0x153))[_0x8ef89f(0xef)]('change',function(){const _0x184eba=_0x8ef89f,_0x1d8f55=getSelectedCanvasSize();imageWidthInput[_0x184eba(0x1dd)]=_0x1d8f55[_0x184eba(0x20a)],imageHeightInput['value']=_0x1d8f55['height'];}),addLog(_0x8ef89f(0x167)),updateButtonStatus();}function toggleDrawingMode(){const _0x2557b7=_0x357eb9;isDrawingModeActive=!isDrawingModeActive,isDrawingModeActive?(toggleDrawingModeBtn['innerHTML']=_0x2557b7(0x209),toggleDrawingModeBtn[_0x2557b7(0x140)]['remove'](_0x2557b7(0x11a)),toggleDrawingModeBtn[_0x2557b7(0x140)]['add'](_0x2557b7(0x15c)),floatToggleDrawingModeBtn[_0x2557b7(0x193)]='<i\x20class=\x22fa\x20fa-stop\x20mr-1\x22></i>退出绘画',floatToggleDrawingModeBtn[_0x2557b7(0x140)][_0x2557b7(0x1e6)](_0x2557b7(0x1b5)),drawingModeIndicator['classList'][_0x2557b7(0x166)]('hidden'),addLog(_0x2557b7(0x155))):(toggleDrawingModeBtn[_0x2557b7(0x193)]=_0x2557b7(0x202),toggleDrawingModeBtn['classList']['remove'](_0x2557b7(0x15c)),toggleDrawingModeBtn['classList'][_0x2557b7(0x1e6)]('bg-primary'),floatToggleDrawingModeBtn['innerHTML']='<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画',floatToggleDrawingModeBtn[_0x2557b7(0x140)][_0x2557b7(0x166)]('text-amber-300'),drawingModeIndicator['classList']['add'](_0x2557b7(0x20e)),addLog(_0x2557b7(0x1f1))),updateCursorStyle();}function updateCursorStyle(){const _0x2dfbb7=_0x357eb9;if(isDrawingModeActive){if(currentTool===_0x2dfbb7(0x148))canvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x15f),floatCanvas['style']['cursor']=_0x2dfbb7(0x15f);else{if(currentTool===_0x2dfbb7(0x109))canvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x106),floatCanvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x106);else currentTool===_0x2dfbb7(0x1ad)&&(canvas[_0x2dfbb7(0xeb)]['cursor']=_0x2dfbb7(0x1ad),floatCanvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x1ad));}}else{if(shiftKeyPressed&&sourceImage)canvas[_0x2dfbb7(0xeb)]['cursor']='move',floatCanvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]='move';else{if(currentTool===_0x2dfbb7(0x148))canvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]='crosshair',floatCanvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]='crosshair';else{if(currentTool===_0x2dfbb7(0x109))canvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x106),floatCanvas[_0x2dfbb7(0xeb)]['cursor']=_0x2dfbb7(0x106);else currentTool==='text'&&(canvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x1ad),floatCanvas[_0x2dfbb7(0xeb)][_0x2dfbb7(0x124)]=_0x2dfbb7(0x1ad));}}}}function setDrawingTool(_0x4bf88b){const _0x38a2aa=_0x357eb9;currentTool=_0x4bf88b,[toolPen,toolEraser,toolText,toolClear][_0x38a2aa(0xf2)](_0x5ebf95=>{const _0x1adbfe=_0x38a2aa;_0x5ebf95[_0x1adbfe(0x140)]['remove'](_0x1adbfe(0xff));});switch(_0x4bf88b){case _0x38a2aa(0x148):toolPen[_0x38a2aa(0x140)][_0x38a2aa(0x1e6)](_0x38a2aa(0xff)),currentToolEl[_0x38a2aa(0x1fb)]='画笔';break;case _0x38a2aa(0x109):toolEraser['classList'][_0x38a2aa(0x1e6)]('active'),currentToolEl[_0x38a2aa(0x1fb)]='橡皮擦';break;case _0x38a2aa(0x1ad):toolText[_0x38a2aa(0x140)][_0x38a2aa(0x1e6)](_0x38a2aa(0xff)),currentToolEl[_0x38a2aa(0x1fb)]='文字';break;}currentSizeEl['textContent']=brushSize,drawingStatus[_0x38a2aa(0x140)][_0x38a2aa(0x166)](_0x38a2aa(0x20e)),updateCursorStyle();}function setBrushColor(_0x2d7248){const _0x328745=_0x357eb9;brushColor=_0x2d7248,document[_0x328745(0x1de)](_0x328745(0xdc))['value']=_0x2d7248,addLog('已选择画笔颜色:\x20'+_0x2d7248);}function getCanvasCoordinates(_0x1b6656,_0x5aa8c3,_0x31d970=![]){const _0x58739a=_0x357eb9,_0x4d1e12=_0x1b6656[_0x58739a(0x150)](),_0x4ea964=_0x1b6656['width']/_0x4d1e12[_0x58739a(0x20a)],_0x540f85=_0x1b6656['height']/_0x4d1e12[_0x58739a(0x1e1)];let _0x56d3e5,_0x5aff8a;return _0x31d970?(_0x56d3e5=(_0x5aa8c3[_0x58739a(0x145)][0x0][_0x58739a(0x14b)]-_0x4d1e12[_0x58739a(0xf5)])*_0x4ea964,_0x5aff8a=(_0x5aa8c3[_0x58739a(0x145)][0x0][_0x58739a(0x143)]-_0x4d1e12['top'])*_0x540f85):(_0x56d3e5=(_0x5aa8c3[_0x58739a(0x14b)]-_0x4d1e12['left'])*_0x4ea964,_0x5aff8a=(_0x5aa8c3[_0x58739a(0x143)]-_0x4d1e12['top'])*_0x540f85),{'x':_0x56d3e5,'y':_0x5aff8a};}function isPointOnImage(_0x4e2a84,_0xfce258){const _0x19e803=_0x357eb9;if(!sourceImage)return![];const _0x17b8aa=imageScale/0x64;let _0x11dbe0=sourceImage[_0x19e803(0x20a)]*_0x17b8aa,_0x18f995=sourceImage[_0x19e803(0x1e1)]*_0x17b8aa;return imageRotation%0xb4!==0x0&&([_0x11dbe0,_0x18f995]=[_0x18f995,_0x11dbe0]),_0x4e2a84>=imageOffset['x']&&_0x4e2a84<=imageOffset['x']+_0x11dbe0&&_0xfce258>=imageOffset['y']&&_0xfce258<=imageOffset['y']+_0x18f995;}function startDrawing(_0x5bbcf2){const _0x43227c=getCanvasCoordinates(canvas,_0x5bbcf2);startDrawingCommon(_0x43227c);}function startDrawingFloat(_0x2593b0){const _0x68fd12=getCanvasCoordinates(floatCanvas,_0x2593b0);startDrawingCommon(_0x68fd12);}function handleTouchStart(_0x5432e1){const _0x4643ba=_0x357eb9;_0x5432e1[_0x4643ba(0x1b8)]();if(_0x5432e1['touches'][_0x4643ba(0x18a)]!==0x1)return;const _0x3cf296=getCanvasCoordinates(canvas,_0x5432e1,!![]);startDrawingCommon(_0x3cf296);}function handleFloatTouchStart(_0x32bd27){const _0x2c2bd2=_0x357eb9;_0x32bd27['preventDefault']();if(_0x32bd27[_0x2c2bd2(0x145)][_0x2c2bd2(0x18a)]!==0x1)return;const _0x448792=getCanvasCoordinates(floatCanvas,_0x32bd27,!![]);startDrawingCommon(_0x448792);}function startDrawingCommon(_0x22dd88){const _0x51814a=_0x357eb9;lastX=_0x22dd88['x'],lastY=_0x22dd88['y'],isDrawing=!![];if(!isDrawingModeActive&&sourceImage&&(isPointOnImage(_0x22dd88['x'],_0x22dd88['y'])&&currentTool!==_0x51814a(0x1ad)))isDraggingImage=!![],dragStartPos={'x':_0x22dd88['x'],'y':_0x22dd88['y']},isDrawing=![],canvas[_0x51814a(0xeb)][_0x51814a(0x124)]=_0x51814a(0x139),floatCanvas[_0x51814a(0xeb)][_0x51814a(0x124)]=_0x51814a(0x139);else currentTool===_0x51814a(0x1ad)&&(addTextToCanvas(_0x22dd88['x'],_0x22dd88['y']),isDrawing=![]);}function draw(_0xdfc44e){const _0x1e96c4=getCanvasCoordinates(canvas,_0xdfc44e);drawCommon(_0x1e96c4);}function drawFloat(_0x19838e){const _0x52b635=getCanvasCoordinates(floatCanvas,_0x19838e);drawCommon(_0x52b635);}function handleTouchMove(_0x29eedb){const _0x406acc=_0x357eb9;_0x29eedb[_0x406acc(0x1b8)]();if(_0x29eedb[_0x406acc(0x145)]['length']!==0x1)return;const _0x31e8a3=getCanvasCoordinates(canvas,_0x29eedb,!![]);drawCommon(_0x31e8a3);}function handleFloatTouchMove(_0x177f64){const _0x6cd5aa=_0x357eb9;_0x177f64['preventDefault']();if(_0x177f64['touches'][_0x6cd5aa(0x18a)]!==0x1)return;const _0x1ac21b=getCanvasCoordinates(floatCanvas,_0x177f64,!![]);drawCommon(_0x1ac21b);}function drawCommon(_0x4f8d1c){if(isDraggingImage&&!isDrawingModeActive){const _0x594619=_0x4f8d1c['x']-dragStartPos['x'],_0x279abc=_0x4f8d1c['y']-dragStartPos['y'];imageOffset['x']+=_0x594619,imageOffset['y']+=_0x279abc,dragStartPos=_0x4f8d1c,redrawImageWithScaleAndOffset();return;}if(!isDrawing)return;drawOnCanvas(lastX,lastY,_0x4f8d1c['x'],_0x4f8d1c['y']),lastX=_0x4f8d1c['x'],lastY=_0x4f8d1c['y'],syncCanvases();}function stopDrawing(){isDrawing=![],isDraggingImage&&(isDraggingImage=![],updateCursorStyle());}function handleTouchEnd(){stopDrawing();}function drawOnCanvas(_0x45ae81,_0x5ef6df,_0xbec644,_0x574ac3){const _0x5556a0=_0x357eb9;ctx[_0x5556a0(0x16a)](),ctx[_0x5556a0(0x1f9)]=_0x5556a0(0x204),ctx[_0x5556a0(0x12f)]='round',ctx['lineWidth']=brushSize;if(currentTool==='pen')ctx[_0x5556a0(0x138)]=brushColor;else currentTool===_0x5556a0(0x109)&&(ctx[_0x5556a0(0x138)]=_0x5556a0(0x1ba),ctx['lineWidth']=brushSize*0x2);ctx[_0x5556a0(0x1c9)](),ctx['moveTo'](_0x45ae81,_0x5ef6df),ctx[_0x5556a0(0x173)](_0xbec644,_0x574ac3),ctx[_0x5556a0(0x13f)](),ctx[_0x5556a0(0x16c)]();}function addTextToCanvas(_0x1af82f,_0x26e0d1){const _0x207091=_0x357eb9,_0x1080f7=textInput[_0x207091(0x1dd)]||_0x207091(0x17a),_0x3c73d1=parseInt(fontSizeInput['value']),_0x55c6bf=fontFamilySelect[_0x207091(0x1dd)];if(!_0x1080f7[_0x207091(0x147)]())return;ctx['save'](),ctx[_0x207091(0x14a)]=_0x3c73d1+'px\x20'+_0x55c6bf,ctx[_0x207091(0x1e0)]=brushColor,ctx['textBaseline']='top',ctx[_0x207091(0x196)](_0x1080f7,_0x1af82f,_0x26e0d1),ctx['restore'](),syncCanvases(),addLog(_0x207091(0xd3)+_0x1080f7+'\x22');}function addTextManually(){const _0x84e19e=_0x357eb9;setDrawingTool(_0x84e19e(0x1ad));if(textInput[_0x84e19e(0x1dd)][_0x84e19e(0x147)]()){const _0x35b6d1=getSelectedCanvasSize(),_0x4868db=_0x35b6d1[_0x84e19e(0x20a)]/0x2,_0x1a83fb=_0x35b6d1['height']/0x2;addTextToCanvas(_0x4868db,_0x1a83fb);}else addLog('请先输入要添加的文字');}function clearCanvas(){const _0x58324b=_0x357eb9;confirm(_0x58324b(0x1f8))&&(ctx[_0x58324b(0x16a)](),ctx[_0x58324b(0x1e0)]=_0x58324b(0x1ba),ctx[_0x58324b(0x1e5)](0x0,0x0,canvas[_0x58324b(0x20a)],canvas['height']),ctx[_0x58324b(0x16c)](),syncCanvases(),addLog(_0x58324b(0x1a4)));}function syncCanvases(){const _0x2605e3=_0x357eb9;floatCtx[_0x2605e3(0x1fc)](0x0,0x0,floatCanvas['width'],floatCanvas[_0x2605e3(0x1e1)]),floatCtx['drawImage'](canvas,0x0,0x0);}function changeImageScale(_0x337f73){const _0x34ef43=_0x357eb9;if(!sourceImage)return;imageScale=Math['max'](0x0,Math[_0x34ef43(0x10d)](0x3e8,imageScale+_0x337f73)),imageScaleSlider['value']=imageScale,updateImageScale();}function updateImageScale(){const _0x27872c=_0x357eb9;if(!sourceImage)return;imageScale=parseInt(imageScaleSlider[_0x27872c(0x1dd)]),imageScaleValue['textContent']=imageScale+'%',redrawImageWithScaleAndOffset();}function redrawImageWithScaleAndOffset(){const _0x51aefd=_0x357eb9;if(!sourceImage)return;ctx[_0x51aefd(0x1e0)]=_0x51aefd(0x1ba),ctx[_0x51aefd(0x1e5)](0x0,0x0,canvas[_0x51aefd(0x20a)],canvas[_0x51aefd(0x1e1)]);const _0x226b6a=imageScale/0x64;let _0x4e197b=sourceImage[_0x51aefd(0x20a)]*_0x226b6a,_0x555564=sourceImage[_0x51aefd(0x1e1)]*_0x226b6a;ctx['save'](),ctx[_0x51aefd(0x15e)](imageOffset['x']+_0x4e197b/0x2,imageOffset['y']+_0x555564/0x2),ctx[_0x51aefd(0x213)](imageRotation*Math['PI']/0xb4),ctx[_0x51aefd(0x1d1)](sourceImage,-_0x4e197b/0x2,-_0x555564/0x2,_0x4e197b,_0x555564),ctx[_0x51aefd(0x16c)](),syncCanvases();}function fitImageToCanvas(){const _0x53b367=_0x357eb9;if(!sourceImage)return;const _0x5734e6=getSelectedCanvasSize();let _0x1edf9c=_0x5734e6[_0x53b367(0x20a)],_0x2030c0=_0x5734e6['height'];const _0x230b21=_0x1edf9c/sourceImage[_0x53b367(0x20a)],_0x194ab2=_0x2030c0/sourceImage[_0x53b367(0x1e1)],_0x2d6e54=Math['min'](_0x230b21,_0x194ab2);imageScale=_0x2d6e54*0x64,imageScaleSlider['value']=imageScale,imageScaleValue[_0x53b367(0x1fb)]=imageScale[_0x53b367(0x201)](0x0)+'%',imageOffset['x']=_0x1edf9c-sourceImage[_0x53b367(0x20a)]*_0x2d6e54,imageOffset['y']=_0x2030c0-sourceImage['height']*_0x2d6e54,redrawImageWithScaleAndOffset(),addLog(_0x53b367(0x17c));}function fillCanvas(){const _0x350609=_0x357eb9;if(!sourceImage)return;const _0x3038ff=getSelectedCanvasSize();let _0x3b3a6b=_0x3038ff[_0x350609(0x20a)],_0x21eb49=_0x3038ff['height'];const _0x52f985=_0x3b3a6b/sourceImage[_0x350609(0x20a)],_0x8e76bf=_0x21eb49/sourceImage[_0x350609(0x1e1)];imageScale=Math[_0x350609(0x175)](_0x52f985,_0x8e76bf)*0x64,imageScaleSlider[_0x350609(0x1dd)]=imageScale,imageScaleValue[_0x350609(0x1fb)]=imageScale['toFixed'](0x0)+'%',imageOffset['x']=0x0,imageOffset['y']=0x0,redrawImageWithScaleAndOffset(),addLog(_0x350609(0xfe));}function centerImageOnCanvas(){const _0x429f51=_0x357eb9;if(!sourceImage)return;const _0x1792f2=getSelectedCanvasSize();let _0x3a4509=_0x1792f2[_0x429f51(0x20a)],_0xd44597=_0x1792f2[_0x429f51(0x1e1)];const _0xbfe5ab=imageScale/0x64;let _0x110692=sourceImage['width']*_0xbfe5ab,_0x490afb=sourceImage[_0x429f51(0x1e1)]*_0xbfe5ab;imageOffset['x']=(_0x3a4509-_0x110692)/0x2,imageOffset['y']=(_0xd44597-_0x490afb)/0x2,redrawImageWithScaleAndOffset(),addLog(_0x429f51(0x1f6));}function rotateImage(_0x317f79){const _0x57be1e=_0x357eb9;if(!sourceImage){addLog(_0x57be1e(0x11b));return;}imageRotation=(imageRotation+_0x317f79)%0x168,redrawImageWithScaleAndOffset(),addLog(_0x57be1e(0x211)+imageRotation+'°');}function resizeImage(_0x274ca5,_0x43a0a4){const _0x2379c0=_0x357eb9;if(!sourceImage||!originalImage)return;const _0x44a209=originalImage[_0x2379c0(0x20a)]/originalImage[_0x2379c0(0x1e1)];let _0x3c836b=sourceImage[_0x2379c0(0x20a)]+_0x274ca5,_0x45eca8=sourceImage[_0x2379c0(0x1e1)]+_0x43a0a4;_0x3c836b=Math[_0x2379c0(0x175)](0x32,_0x3c836b),_0x45eca8=Math['max'](0x32,_0x45eca8),imageWidthInput[_0x2379c0(0x1dd)]=Math[_0x2379c0(0x204)](_0x3c836b),imageHeightInput[_0x2379c0(0x1dd)]=Math['round'](_0x45eca8);const _0x4bb6c1=new Image();_0x4bb6c1['onload']=function(){const _0x3e5bad=_0x2379c0;sourceImage=_0x4bb6c1,redrawImageWithScaleAndOffset(),addLog('图片尺寸已调整为:\x20'+_0x3c836b+_0x3e5bad(0x1a6)+_0x45eca8);};const _0x389a4f=document[_0x2379c0(0x1ee)](_0x2379c0(0x194));_0x389a4f[_0x2379c0(0x20a)]=_0x3c836b,_0x389a4f[_0x2379c0(0x1e1)]=_0x45eca8;const _0x503bfd=_0x389a4f[_0x2379c0(0x1b1)]('2d');_0x503bfd[_0x2379c0(0x1d1)](originalImage,0x0,0x0,_0x3c836b,_0x45eca8),_0x4bb6c1[_0x2379c0(0x191)]=_0x389a4f['toDataURL']();}function applyImageDimensions(){const _0x127a73=_0x357eb9,_0x3697a5=parseInt(imageWidthInput[_0x127a73(0x1dd)]),_0x36c7a5=parseInt(imageHeightInput[_0x127a73(0x1dd)]);if(isNaN(_0x3697a5)||isNaN(_0x36c7a5)||_0x3697a5<0x32||_0x36c7a5<0x32){addLog(_0x127a73(0xd9));return;}if(originalImage){const _0x251826=new Image();_0x251826[_0x127a73(0x20b)]=function(){const _0x29762b=_0x127a73;sourceImage=_0x251826,fitImageToCanvas(),addLog(_0x29762b(0x131)+_0x3697a5+_0x29762b(0x1a6)+_0x36c7a5);};const _0xe51f2a=document[_0x127a73(0x1ee)]('canvas');_0xe51f2a[_0x127a73(0x20a)]=_0x3697a5,_0xe51f2a[_0x127a73(0x1e1)]=_0x36c7a5;const _0x591847=_0xe51f2a['getContext']('2d');_0x591847[_0x127a73(0x1d1)](originalImage,0x0,0x0,_0x3697a5,_0x36c7a5),_0x251826[_0x127a73(0x191)]=_0xe51f2a[_0x127a73(0x1fd)]();}else addLog(_0x127a73(0x131)+_0x3697a5+_0x127a73(0x1a6)+_0x36c7a5);}function handleImageUpload(_0x2f65ca){const _0x16b839=_0x357eb9,_0x2045be=_0x2f65ca['target'][_0x16b839(0x11d)][0x0];if(!_0x2045be)return;document[_0x16b839(0x1de)](_0x16b839(0x16b))[_0x16b839(0x1fb)]=_0x16b839(0x117)+_0x2045be[_0x16b839(0x203)]+'\x20('+formatFileSize(_0x2045be[_0x16b839(0x112)])+')',document[_0x16b839(0x1de)](_0x16b839(0x16b))[_0x16b839(0x140)]['remove'](_0x16b839(0x20e));const _0x41c96b=new FileReader();_0x41c96b['onload']=function(_0x2ea82c){const _0x325f10=_0x16b839,_0x1002dc=new Image();_0x1002dc['onload']=function(){const _0x45cd68=_0x3d65;originalImage=new Image(),originalImage['src']=_0x1002dc[_0x45cd68(0x191)],sourceImage=new Image(),sourceImage[_0x45cd68(0x191)]=_0x1002dc[_0x45cd68(0x191)],imageRotation=0x0,imageWidthInput[_0x45cd68(0x1dd)]=_0x1002dc[_0x45cd68(0x20a)],imageHeightInput[_0x45cd68(0x1dd)]=_0x1002dc[_0x45cd68(0x1e1)],fitImageToCanvas(),centerImageOnCanvas(),saveOriginalCanvasState(),addLog(_0x45cd68(0x1e9)+_0x2045be[_0x45cd68(0x203)]),addLog(_0x45cd68(0x104)+_0x1002dc[_0x45cd68(0x20a)]+_0x45cd68(0x1a6)+_0x1002dc[_0x45cd68(0x1e1)]),addLog('提示：按住Shift键拖动图片，或直接点击图片拖动'),updateCanvasVisibility();},_0x1002dc[_0x325f10(0x191)]=_0x2ea82c[_0x325f10(0x1cb)][_0x325f10(0x17f)];},_0x41c96b['readAsDataURL'](_0x2045be);}function saveOriginalCanvasState(){const _0x45269e=_0x357eb9,_0x290c67=getSelectedCanvasSize();originalCanvasData=ctx[_0x45269e(0x16d)](0x0,0x0,_0x290c67[_0x45269e(0x20a)],_0x290c67[_0x45269e(0x1e1)]);}function clearLog(){const _0x4db5cb=_0x357eb9;logContainer[_0x4db5cb(0x193)]=_0x4db5cb(0xd1),addLog('日志已清除');}function preConnect(){const _0x25f311=_0x357eb9;if(gattServer!=null&&gattServer[_0x25f311(0x1be)])bleDevice!=null&&bleDevice[_0x25f311(0x1d2)][_0x25f311(0x1be)]&&(addLog(_0x25f311(0x1a1)+(bleDevice[_0x25f311(0x203)]||_0x25f311(0xf0))+'\x20的连接...'),bleDevice['gatt'][_0x25f311(0xce)]());else{resetBluetoothVariables();try{navigator[_0x25f311(0x1ff)][_0x25f311(0x1b3)]({'filters':[{'namePrefix':_0x25f311(0x157)}],'optionalServices':['32120001-0bf6-448a-9608-1b01a1a8f75c']})[_0x25f311(0x1df)](_0x2aa33d=>{const _0x3ce650=_0x25f311;addLog(_0x3ce650(0xf7)+(_0x2aa33d[_0x3ce650(0x203)]||'NRF设备(未知名称)')),bleDevice=_0x2aa33d,bleDevice['addEventListener']('gattserverdisconnected',disconnect),setTimeout(()=>connect(),0x12c);})['catch'](_0x166a33=>{const _0x5effc3=_0x25f311;addLog(_0x5effc3(0x1c4)+_0x166a33[_0x5effc3(0x1ae)]),_0x166a33['name']==='NotFoundError'&&addLog('未找到NRF前缀的蓝牙设备，请确认设备已开启');});}catch(_0x2d2695){addLog('蓝牙操作异常:\x20'+_0x2d2695[_0x25f311(0x1ae)]),addLog(_0x25f311(0x14d));}}}async function connect(){const _0x7c0833=_0x357eb9;if(!bleDevice){addLog('连接失败:\x20未选择蓝牙设备');return;}if(epdCharacteristic){addLog(_0x7c0833(0x16f));return;}try{addLog(_0x7c0833(0x189)+(bleDevice[_0x7c0833(0x203)]||_0x7c0833(0x136))),gattServer=await bleDevice[_0x7c0833(0x1d2)]['connect'](),epdService=await gattServer[_0x7c0833(0x1ec)](_0x7c0833(0x164)),epdCharacteristic=await epdService[_0x7c0833(0x20d)](_0x7c0833(0x133)),addLog('已成功连接到设备！'),await epdCharacteristic[_0x7c0833(0x212)](),epdCharacteristic[_0x7c0833(0xef)](_0x7c0833(0x1ab),_0x2e87a8=>{const _0x4d7b02=_0x7c0833;handleNotify(_0x2e87a8[_0x4d7b02(0x1cb)][_0x4d7b02(0x1dd)]);}),await write(0xa9),document['getElementById'](_0x7c0833(0x1d9))['innerHTML']=_0x7c0833(0x1e4),updateButtonStatus();}catch(_0x2f3545){addLog(_0x7c0833(0x156)+_0x2f3545[_0x7c0833(0x1ae)]),disconnect();}}function disconnect(){const _0x40e758=_0x357eb9;bleDevice&&bleDevice[_0x40e758(0x1d2)][_0x40e758(0x1be)]&&bleDevice[_0x40e758(0x1d2)][_0x40e758(0xce)](),resetBluetoothVariables(),addLog('已断开连接'),document[_0x40e758(0x1de)](_0x40e758(0x1d9))[_0x40e758(0x193)]='<i\x20class=\x22fa\x20fa-plug\x20mr-1\x22></i>连接',updateButtonStatus();}function resetBluetoothVariables(){gattServer=null,epdService=null,epdCharacteristic=null,msgIndex=0x0;}async function write(_0xad8688,_0x5116e2,_0xd95d1d=!![]){const _0x37a4c1=_0x357eb9;if(!epdCharacteristic)return addLog(_0x37a4c1(0xfb)),![];let _0x321b31=[_0xad8688];if(_0x5116e2){if(typeof _0x5116e2==_0x37a4c1(0x13c))_0x5116e2=hex2bytes(_0x5116e2);if(_0x5116e2 instanceof Uint8Array)_0x5116e2=Array[_0x37a4c1(0x116)](_0x5116e2);_0x321b31[_0x37a4c1(0x1f4)](..._0x5116e2);}try{if(_0xd95d1d)await epdCharacteristic[_0x37a4c1(0x111)](Uint8Array['from'](_0x321b31));else await epdCharacteristic[_0x37a4c1(0x1d3)](Uint8Array[_0x37a4c1(0x116)](_0x321b31));}catch(_0xdea6cf){return addLog(_0x37a4c1(0x10c)+_0xdea6cf[_0x37a4c1(0x1ae)]),![];}return!![];}async function writeImage(_0x22a30a,_0x25b4af='bw'){const _0x3f5fbf=_0x357eb9,_0xeedfc2=document['getElementById'](_0x3f5fbf(0x1e7))[_0x3f5fbf(0x1dd)]-0x2,_0x4d950c=document[_0x3f5fbf(0x1de)](_0x3f5fbf(0x169))[_0x3f5fbf(0x1dd)],_0x53f895=Math[_0x3f5fbf(0x1a7)](_0x22a30a[_0x3f5fbf(0x18a)]/_0xeedfc2);let _0x5e66d6=0x0,_0x5a5220=_0x4d950c;const _0x5938cc=getSelectedCanvasSize();for(let _0x135648=0x0;_0x135648<_0x22a30a[_0x3f5fbf(0x18a)];_0x135648+=_0xeedfc2){let _0x20cd12=(new Date()[_0x3f5fbf(0x200)]()-startTime)/0x3e8;addLog((_0x25b4af=='bw'?'黑白':'红色')+_0x3f5fbf(0x1f5)+(_0x5e66d6+0x1)+'/'+_0x53f895+_0x3f5fbf(0x14c)+_0x20cd12[_0x3f5fbf(0x201)](0x1)+'s');const _0x3cc792=[(_0x25b4af=='bw'?0xf:0x0)|(_0x135648==0x0?0x0:0xf0),..._0x22a30a[_0x3f5fbf(0x1a0)](_0x135648,_0x135648+_0xeedfc2)];_0x5a5220>0x0?(await write(0xa1,_0x3cc792,![]),_0x5a5220--):(await write(0xa1,_0x3cc792,!![]),_0x5a5220=_0x4d950c),_0x5e66d6++;}}function downloadImageFile(){const _0x2c8a5e=_0x357eb9;if(!checkCanvasHasContent(canvas)){addLog(_0x2c8a5e(0x13d));return;}const _0x2c0435=getSelectedCanvasSize(),{width:_0x1f604f,height:_0x4d9965}=getEffectiveCanvasSize(_0x2c0435),_0x50886f=getRotatedImageData(canvas,_0x2c0435,imageRotation),_0x1c44a8=ditherMode['value'],_0x19926a=processImageData(_0x50886f,_0x1c44a8,_0x1f604f,_0x4d9965),_0x10f372=_0x19926a['length'],_0x4d9b27=(_0x10f372/0x400)[_0x2c8a5e(0x201)](0x2),_0xc6c541=_0x1f604f*_0x4d9965,_0x599513=_0x19926a['map'](_0x5233ed=>_0x5233ed[_0x2c8a5e(0xec)](0x10)[_0x2c8a5e(0x119)](0x2,'0'))[_0x2c8a5e(0x1a9)]('\x20'),_0x68f7b3=new Blob([_0x599513],{'type':_0x2c8a5e(0x16e)}),_0x402b30=URL['createObjectURL'](_0x68f7b3),_0x3e3be7=document['createElement']('a');_0x3e3be7['href']=_0x402b30,_0x3e3be7['download']=_0x2c8a5e(0x1bd)+new Date()[_0x2c8a5e(0x200)]()+_0x2c8a5e(0x159),document[_0x2c8a5e(0x1c1)][_0x2c8a5e(0x122)](_0x3e3be7),_0x3e3be7[_0x2c8a5e(0x18c)](),setTimeout(()=>{const _0x3996dc=_0x2c8a5e;document[_0x3996dc(0x1c1)][_0x3996dc(0xd8)](_0x3e3be7),URL['revokeObjectURL'](_0x402b30);},0x0),addLog('图像文本文件已下载\x20-\x20数据量:\x20'+_0x10f372+_0x2c8a5e(0x1b7)+_0x4d9b27+_0x2c8a5e(0x1d7)+_0xc6c541);}function showTimeDialog(){const _0x24c2f6=_0x357eb9;if(!epdCharacteristic){addLog(_0x24c2f6(0x19a));return;}const _0xba802d=new Date(),_0x2d49fe=new Date(_0xba802d['getTime']()-_0xba802d['getTimezoneOffset']()*0xea60)['toISOString']()[_0x24c2f6(0x1a0)](0x0,0x10);datetimeInput['value']=_0x2d49fe,timeDialog[_0x24c2f6(0x140)]['remove'](_0x24c2f6(0x20e));}function hideTimeDialog(){const _0x1cdeb3=_0x357eb9;timeDialog[_0x1cdeb3(0x140)][_0x1cdeb3(0x1e6)]('hidden');}async function setTime(){const _0x13fb28=_0x357eb9;if(!epdCharacteristic){addLog(_0x13fb28(0x19a)),hideTimeDialog();return;}const _0x59bd4c=datetimeInput[_0x13fb28(0x1dd)];if(!_0x59bd4c){addLog(_0x13fb28(0x195));return;}const _0x3cf47b=new Date(_0x59bd4c),_0x52fbad=Math[_0x13fb28(0x1b2)](_0x3cf47b[_0x13fb28(0x200)]()/0x3e8),_0x1cbabd=[_0x52fbad>>0x18&0xff,_0x52fbad>>0x10&0xff,_0x52fbad>>0x8&0xff,_0x52fbad&0xff];try{setStatus(_0x13fb28(0x198)),statusContainer[_0x13fb28(0xeb)][_0x13fb28(0x1fa)]='block',await write(0xa3,_0x1cbabd),addLog(_0x13fb28(0x126)+_0x3cf47b['toLocaleString']()),addLog(_0x13fb28(0x182)+_0x52fbad+_0x13fb28(0x101)+_0x52fbad[_0x13fb28(0xec)](0x10)[_0x13fb28(0x1aa)]()+')'),setTimeout(()=>{const _0x46c979=_0x13fb28;statusContainer['style']['display']=_0x46c979(0x146);},0x7d0);}catch(_0x97cd01){addLog(_0x13fb28(0xe3)+_0x97cd01['message']);}finally{hideTimeDialog();}}async function setClockMode(){const _0x3d076d=_0x357eb9;if(!epdCharacteristic){addLog(_0x3d076d(0x19a));return;}try{setStatus(_0x3d076d(0x178)),statusContainer[_0x3d076d(0xeb)][_0x3d076d(0x1fa)]=_0x3d076d(0x11c),await write(0xae,[0x1]),currentMode=_0x3d076d(0xe5),addLog(_0x3d076d(0xf8)),setTimeout(()=>{const _0x1daab9=_0x3d076d;statusContainer['style'][_0x1daab9(0x1fa)]=_0x1daab9(0x146);},0x7d0);}catch(_0x5c08a7){addLog('切换模式失败:\x20'+_0x5c08a7[_0x3d076d(0x1ae)]);}}function _0x147c(){const _0x36482a=['style','toString','btnDownload','toISOString','addEventListener','未知设备','已同步时间！','forEach','N_Z_min','statusContainer','left','imageHeight','已选择设备:\x20','已切换到时钟模式','1585504oBKVHk','createImageData','未连接蓝牙设备','J_S_min','toolClear','图片已铺满画布','active','ditherMode','\x20(0x','diffusionValue','N_Z_hour','图片原始尺寸:\x20','floatingCanvasContainer','url(\x22data:image/svg+xml,%3Csvg\x20xmlns=\x27http://www.w3.org/2000/svg\x27\x20width=\x2724\x27\x20height=\x2724\x27\x20viewBox=\x270\x200\x2024\x2024\x27\x20fill=\x27none\x27\x20stroke=\x27black\x27\x20stroke-width=\x272\x27\x20stroke-linecap=\x27round\x27\x20stroke-linejoin=\x27round\x27%3E%3Cpath\x20d=\x27M18\x2013L5\x205\x27/%3E%3C/svg%3E\x22)\x200\x2024,\x20auto','确定要清空墨水屏显示内容吗？','sqrt','eraser','confirmTimeBtn','Stucki','发送失败:\x20','min','64374ZRPUOi','mouseout','scrollTop','writeValueWithResponse','size','liang_add','Atkinson','threeColor','from','文件名:\x20','contrastValue','padStart','bg-primary','请先上传图片','block','files','mb-1\x20border-b\x20border-gray-100\x20pb-1\x20last:border-0\x20last:mb-0\x20last:pb-0','toolPen','logContainer','blackWhiteColor','appendChild',']</span>\x20<span\x20class=\x22text-gray-800\x22>','cursor','Jarvis-Judice-Ninke','已设置时间:\x20','N_Z_start','options','selectedIndex','.italic','黑白红','processedImageInfo','touchstart','scrollHeight','lineJoin','清空屏幕失败:\x20','图像尺寸已设置为:\x20','D_S_start','32120002-0bf6-448a-9608-1b01a1a8f75c','keyup','touchcancel','NRF设备(未知名称)','cursor-not-allowed','strokeStyle','move','imageFile','<i\x20class=\x22fa\x20fa-arrows-alt\x20mr-1\x22></i>浮动画布','string','请先上传或绘制图像并处理后再下载','textInput','stroke','classList','已显示浮动画布','7.5_800_480','clientY','data-color','touches','none','trim','pen','atkinson','font','clientX',',\x20用时:\x20','请检查蓝牙是否已开启并授予权限','413TcChpR','floatToggleDrawingMode','getBoundingClientRect','btnBlackWhiteRed','开始处理图片，使用','canvasSize','已清空墨水屏显示内容','已进入绘画模式，图片已锁定无法移动','连接过程出错:\x20','NRF_','D_S_hour','.txt','processImage1','floydSteinberg','bg-amber-500','发送完成！耗时:\x20','translate','crosshair','brightness','data-size','className','canvasResizeHandle','32120001-0bf6-448a-9608-1b01a1a8f75c','touchmove','remove','欢迎使用墨水屏蓝牙图片工具！','color_led','interleavedcount','save','fileInfo','restore','getImageData','text/plain','已经连接到设备，无需重复连接','\x20像素\x20(','currentSize','1395620RMJhrC','lineTo','249ZZuhuP','max','diffusion','saturation','正在切换到时钟模式...','parentElement','请输入文字','已切换到日历模式','图片已适应画布大小','30zVaucQ','epdpins','result','top','innerHeight','时间戳:\x20','抖动算法','drawingStatus','图片处理完成','jushua_time1','getTimezoneOffset','contains','正在连接:\x20','length','set','click','shichen_color','btnBlackWhite','imageWidth','18YjrHpW','src','disabled','innerHTML','canvas','请选择日期和时间','fillText','color_1','正在设置时间...','brightnessValue','请先连接蓝牙设备！','10886ENPQAG','some','<span\x20class=\x22text-gray-500\x22>[','fontFamily','getAttribute','slice','正在断开与\x20','xuanzhuan1','ditherAlg','已清除画布内容','input','\x20×\x20','ceil','floatPreviewCanvas','join','toUpperCase','characteristicvaluechanged','drawingModeIndicator','text','message','btnClearLog','liang_s','getContext','floor','requestDevice','substr','text-amber-300','imageScale','\x20字节\x20(','preventDefault','1133253znAmAY','#FFFFFF','moshi_id','toLocaleTimeString','e-paper-image-','connected','silian_ziti','status','body','offsetWidth','key','蓝牙设备选择失败:\x20','Bayer','brushSize','contrast','J_S_hour','beginPath','jieqi_color','target','已重置处理效果，保留原始图片和设置','pow','已隐藏浮动画布','Floyd-Steinberg','jushua_time','drawImage','gatt','writeValueWithoutResponse','btnReset','fourColor','150724gweTzH','\x20KB)，像素:\x20','red','connectbutton','收到通知:','opacity-50','innerWidth','value','getElementById','then','fillStyle','height','liangdu','putImageData','<i\x20class=\x22fa\x20fa-unplug\x20mr-1\x22></i>断开','fillRect','add','mtusize','touchend','已加载图片:\x20','mousedown','noImagePlaceholder','getPrimaryService','切换模式失败:\x20','createElement','已选择','wendu_color','已退出绘画模式，图片可以移动','offsetHeight','addTextBtn','push','包:\x20','图片已居中显示','4.2_400_300','确定要清除画布内容吗？','lineCap','display','textContent','clearRect','toDataURL','closeCanvas','bluetooth','getTime','toFixed','<i\x20class=\x22fa\x20fa-pencil\x20mr-1\x22></i>开始绘画','name','round','Shift','算法...','div:first-child','mousemove','<i\x20class=\x22fa\x20fa-stop\x20mr-1\x22></i>退出绘画','width','onload','581726NveQxH','getCharacteristic','hidden','\x20像素','dither-strength','图片已旋转至\x20','startNotifications','rotate','log','disconnect','querySelector','正在清空屏幕...','<div\x20class=\x22text-gray-500\x20italic\x22>操作日志将显示在这里...</div>','color_11','已添加文字:\x20\x22','主机已同步时间！','sixColor','#000000','qiangzhi_shuaxing','removeChild','请输入有效的尺寸（最小50x50像素）','toggleCanvasFloat','</span>','customColor','mouseup','fontSize','data','\x20KB','xuanzhuan','image','设置时间失败:\x20','liang_time','clock','toggleDrawingMode','<i\x20class=\x22fa\x20fa-compress\x20mr-1\x22></i>隐藏画布','fanxian','epddriver','已清空画布，保留设置和图片'];_0x147c=function(){return _0x36482a;};return _0x147c();}async function setCalendarMode(){const _0x2b8f36=_0x357eb9;if(!epdCharacteristic){addLog(_0x2b8f36(0x19a));return;}try{setStatus('正在切换到日历模式...'),statusContainer[_0x2b8f36(0xeb)][_0x2b8f36(0x1fa)]=_0x2b8f36(0x11c),await write(0xae,[0x2]),currentMode='calendar',addLog(_0x2b8f36(0x17b)),setTimeout(()=>{const _0x5227fb=_0x2b8f36;statusContainer[_0x5227fb(0xeb)]['display']=_0x5227fb(0x146);},0x7d0);}catch(_0x327981){addLog(_0x2b8f36(0x1ed)+_0x327981[_0x2b8f36(0x1ae)]);}}async function clear_screen(){const _0x2da498=_0x357eb9;if(!epdCharacteristic){addLog(_0x2da498(0x19a));return;}if(!confirm(_0x2da498(0x107)))return;try{setStatus(_0x2da498(0xd0)),statusContainer[_0x2da498(0xeb)][_0x2da498(0x1fa)]=_0x2da498(0x11c),await write(0xa8),await write(0xa5),addLog(_0x2da498(0x154)),setTimeout(()=>{const _0x32f4dc=_0x2da498;statusContainer[_0x32f4dc(0xeb)][_0x32f4dc(0x1fa)]=_0x32f4dc(0x146);},0x7d0);}catch(_0x4f8605){addLog(_0x2da498(0x130)+_0x4f8605[_0x2da498(0x1ae)]);}}function getEffectiveCanvasSize(_0x310fd3){const _0x2e081f=_0x357eb9;let _0x243731=_0x310fd3[_0x2e081f(0x20a)],_0x3f4636=_0x310fd3[_0x2e081f(0x1e1)];return imageRotation%0xb4!==0x0&&([_0x243731,_0x3f4636]=[_0x3f4636,_0x243731]),{'width':_0x243731,'height':_0x3f4636};}function getRotatedImageData(_0x2a5765,_0x3062cb,_0x141f03){const _0x1c086c=_0x357eb9,_0x4d5756=document[_0x1c086c(0x1ee)](_0x1c086c(0x194)),_0x4ed9a0=_0x4d5756[_0x1c086c(0x1b1)]('2d'),{width:_0x2b16de,height:_0x294b2e}=getEffectiveCanvasSize(_0x3062cb);_0x4d5756[_0x1c086c(0x20a)]=_0x2b16de,_0x4d5756[_0x1c086c(0x1e1)]=_0x294b2e,_0x4ed9a0['save']();if(_0x141f03===0x5a)_0x4ed9a0[_0x1c086c(0x15e)](_0x2b16de,0x0),_0x4ed9a0[_0x1c086c(0x213)](Math['PI']/0x2);else{if(_0x141f03===0xb4)_0x4ed9a0['translate'](_0x2b16de,_0x294b2e),_0x4ed9a0[_0x1c086c(0x213)](Math['PI']);else _0x141f03===0x10e&&(_0x4ed9a0[_0x1c086c(0x15e)](0x0,_0x294b2e),_0x4ed9a0[_0x1c086c(0x213)](0x3*Math['PI']/0x2));}return _0x4ed9a0[_0x1c086c(0x1d1)](_0x2a5765,0x0,0x0),_0x4ed9a0[_0x1c086c(0x16c)](),_0x4ed9a0[_0x1c086c(0x16d)](0x0,0x0,_0x2b16de,_0x294b2e);}function getDitherAlgorithmName(_0x183cf7){const _0x1bb111=_0x357eb9,_0x54bc9d={'floydSteinberg':_0x1bb111(0x1cf),'atkinson':_0x1bb111(0x114),'bayer':_0x1bb111(0x1c5),'stucki':_0x1bb111(0x10b),'jarvis':_0x1bb111(0x125)};return _0x54bc9d[_0x183cf7]||_0x183cf7;}function setDitherMode(_0x18b130){const _0x4d8c80=_0x357eb9;ditherMode[_0x4d8c80(0x1dd)]=_0x18b130,addLog('已选择'+(_0x18b130===_0x4d8c80(0x121)?'黑白':_0x4d8c80(0x12b))+'模式');}function onDitherAlgChange(_0x541d36){const _0xd1f688=_0x357eb9;currentParams[_0xd1f688(0x1a3)]=_0x541d36[_0xd1f688(0x1cb)][_0xd1f688(0x1dd)],addLog(_0xd1f688(0x1ef)+getDitherAlgorithmName(currentParams['ditherAlg'])+_0xd1f688(0x183));}function getSelectedCanvasSize(){const _0x94861b=_0x357eb9,_0x320771=document['getElementById'](_0x94861b(0x153))[_0x94861b(0x1dd)];return canvasSizes['find'](_0x250a97=>_0x250a97['name']===_0x320771)||canvasSizes[0x1];}let originalImageData=null;function updateCanvasSize(_0x179322=![]){const _0x167c22=_0x357eb9,_0x462599=getSelectedCanvasSize(),_0x3f5693=checkCanvasHasContent(canvas);imageWidthInput[_0x167c22(0x1dd)]=_0x462599[_0x167c22(0x20a)],imageHeightInput[_0x167c22(0x1dd)]=_0x462599['height'],canvas[_0x167c22(0x20a)]=_0x462599['width'],canvas[_0x167c22(0x1e1)]=_0x462599[_0x167c22(0x1e1)],floatCanvas['width']=_0x462599[_0x167c22(0x20a)],floatCanvas['height']=_0x462599['height'],_0x179322&&_0x3f5693?originalCanvasData&&ctx[_0x167c22(0x1e3)](originalCanvasData,0x0,0x0):(ctx['fillStyle']='#FFFFFF',ctx[_0x167c22(0x1e5)](0x0,0x0,_0x462599[_0x167c22(0x20a)],_0x462599['height'])),syncCanvases(),processedImageInfo[_0x167c22(0x1fb)]=_0x462599[_0x167c22(0x20a)]+_0x167c22(0x1a6)+_0x462599[_0x167c22(0x1e1)]+'\x20像素',updateCanvasVisibility();}function updateDitcherOptions(){const _0x8c6565=_0x357eb9,_0x339537=document['getElementById']('epddriver'),_0x5c5b45=_0x339537[_0x8c6565(0x128)][_0x339537[_0x8c6565(0x129)]],_0x3c8134=_0x5c5b45[_0x8c6565(0x19f)](_0x8c6565(0x144)),_0x4ae6a2=_0x5c5b45[_0x8c6565(0x19f)](_0x8c6565(0x161));if(_0x3c8134)ditherMode[_0x8c6565(0x1dd)]=_0x3c8134;if(_0x4ae6a2){const _0x4f7a36=canvasSizes[_0x8c6565(0x19c)](_0x3e8175=>_0x3e8175[_0x8c6565(0x203)]===_0x4ae6a2);_0x4f7a36&&(document[_0x8c6565(0x1de)](_0x8c6565(0x153))[_0x8c6565(0x1dd)]=_0x4ae6a2);}updateCanvasSize(!![]);}function processImage(){const _0x4b03f3=_0x357eb9;saveOriginalCanvasState(),addLog(_0x4b03f3(0x152)+getDitherAlgorithmName(currentParams[_0x4b03f3(0x1a3)])+_0x4b03f3(0x206));const _0x192cc2=getSelectedCanvasSize();let _0x116789=ctx[_0x4b03f3(0x16d)](0x0,0x0,_0x192cc2[_0x4b03f3(0x20a)],_0x192cc2['height']);_0x116789=adjustImageParameters(_0x116789,currentParams);const _0x13ad9c=ditherMode[_0x4b03f3(0x1dd)];let _0x1098af;const _0x4e82f1=window[_0x4b03f3(0x15a)](_0x116789,document[_0x4b03f3(0x1de)](_0x4b03f3(0x160))[_0x4b03f3(0x1dd)],document['getElementById'](_0x4b03f3(0x1c7))['value'],document['getElementById'](_0x4b03f3(0x177))[_0x4b03f3(0x1dd)],document[_0x4b03f3(0x1de)](_0x4b03f3(0x176))[_0x4b03f3(0x1dd)]/0xa,_0x13ad9c,document[_0x4b03f3(0x1de)](_0x4b03f3(0x1a3))[_0x4b03f3(0x1dd)]);ctx[_0x4b03f3(0x1e3)](_0x4e82f1,0x0,0x0),syncCanvases(),processedImageInfo[_0x4b03f3(0x1fb)]=_0x192cc2[_0x4b03f3(0x20a)]+_0x4b03f3(0x1a6)+_0x192cc2[_0x4b03f3(0x1e1)]+_0x4b03f3(0x170)+(_0x13ad9c===_0x4b03f3(0x121)?'黑白':_0x4b03f3(0x12b))+')',addLog(_0x4b03f3(0x185)),updateCanvasVisibility();}async function sendimg(){const _0x4b34af=_0x357eb9,_0x4cc62c=document['getElementById'](_0x4b34af(0x153))[_0x4b34af(0x1dd)],_0x8b3583=document[_0x4b34af(0x1de)](_0x4b34af(0x100))['value'],_0x4b097a=document[_0x4b34af(0x1de)](_0x4b34af(0xe9)),_0x371261=_0x4b097a[_0x4b34af(0x128)][_0x4b097a[_0x4b34af(0x129)]];startTime=new Date()['getTime']();const _0x5b9747=document[_0x4b34af(0x1de)](_0x4b34af(0x1c0));_0x5b9747[_0x4b34af(0x179)]['style'][_0x4b34af(0x1fa)]='block';const _0x1c5c4d=ctx['getImageData'](0x0,0x0,canvas[_0x4b34af(0x20a)],canvas['height']),_0x1732df=processImageData(_0x1c5c4d,_0x8b3583);updateButtonStatus(!![]);if(_0x8b3583===_0x4b34af(0x1d5))await writeImage(_0x1732df,'color');else{if(_0x8b3583===_0x4b34af(0x115)){const _0x21b76f=Math[_0x4b34af(0x1b2)](_0x1732df[_0x4b34af(0x18a)]/0x2);await writeImage(_0x1732df['slice'](0x0,_0x21b76f),'bw'),await writeImage(_0x1732df[_0x4b34af(0x1a0)](_0x21b76f),_0x4b34af(0x1d8));}else{if(_0x8b3583===_0x4b34af(0x121))await writeImage(_0x1732df,'bw');else{updateButtonStatus();return;}}}await write(0xa5),updateButtonStatus();const _0x518b5f=(new Date()[_0x4b34af(0x200)]()-startTime)/0x3e8;addLog(_0x4b34af(0x15d)+_0x518b5f+'s'),setTimeout(()=>{const _0x25f9e2=_0x4b34af;_0x5b9747[_0x25f9e2(0x179)][_0x25f9e2(0xeb)]['display']=_0x25f9e2(0x146);},0x1388);}function adjustImageParameters(_0x341601,_0x73db7c){const _0x2ebef7=_0x357eb9,_0x366408=_0x341601['data'],_0x51f1ef=_0x73db7c['saturation']/0x64,_0x6446c7=_0x73db7c[_0x2ebef7(0x160)]/0x64,_0x29b410=_0x73db7c[_0x2ebef7(0x1c7)]/0x64,_0x17d8b0=_0x73db7c['diffusion']/0x64,_0x43212d=_0x29b410!==0x0?0x103*(_0x29b410+0xff)/(0xff*(0x103-_0x29b410)):0x1,_0x468687=new Uint8ClampedArray(_0x366408);for(let _0x5b0f14=0x0;_0x5b0f14<_0x366408[_0x2ebef7(0x18a)];_0x5b0f14+=0x4){let _0x28b42e=Math['min'](0xff,Math['max'](0x0,_0x468687[_0x5b0f14]*_0x6446c7)),_0x2339a7=Math[_0x2ebef7(0x10d)](0xff,Math[_0x2ebef7(0x175)](0x0,_0x468687[_0x5b0f14+0x1]*_0x6446c7)),_0x39b0c1=Math[_0x2ebef7(0x10d)](0xff,Math[_0x2ebef7(0x175)](0x0,_0x468687[_0x5b0f14+0x2]*_0x6446c7));_0x28b42e=Math[_0x2ebef7(0x10d)](0xff,Math[_0x2ebef7(0x175)](0x0,_0x43212d*(_0x28b42e-0x80)+0x80)),_0x2339a7=Math['min'](0xff,Math[_0x2ebef7(0x175)](0x0,_0x43212d*(_0x2339a7-0x80)+0x80)),_0x39b0c1=Math[_0x2ebef7(0x10d)](0xff,Math[_0x2ebef7(0x175)](0x0,_0x43212d*(_0x39b0c1-0x80)+0x80));const _0xc4045f=0.299*_0x28b42e+0.587*_0x2339a7+0.114*_0x39b0c1;_0x28b42e=Math[_0x2ebef7(0x10d)](0xff,Math[_0x2ebef7(0x175)](0x0,_0xc4045f+_0x51f1ef*(_0x28b42e-_0xc4045f))),_0x2339a7=Math['min'](0xff,Math[_0x2ebef7(0x175)](0x0,_0xc4045f+_0x51f1ef*(_0x2339a7-_0xc4045f))),_0x39b0c1=Math[_0x2ebef7(0x10d)](0xff,Math[_0x2ebef7(0x175)](0x0,_0xc4045f+_0x51f1ef*(_0x39b0c1-_0xc4045f)));if(_0x17d8b0>0x0){const _0x378ca1=_0x341601[_0x2ebef7(0x20a)],_0x5e7b68=_0x5b0f14/0x4%_0x378ca1,_0x47d344=Math[_0x2ebef7(0x1b2)](_0x5b0f14/0x4/_0x378ca1);if(_0x5e7b68>0x0&&_0x47d344>0x0){const _0x5eff7f=_0x5b0f14-0x4*(_0x378ca1+0x1);_0x28b42e=Math[_0x2ebef7(0x1b2)](_0x28b42e*(0x1-_0x17d8b0)+_0x468687[_0x5eff7f]*_0x17d8b0),_0x2339a7=Math[_0x2ebef7(0x1b2)](_0x2339a7*(0x1-_0x17d8b0)+_0x468687[_0x5eff7f+0x1]*_0x17d8b0),_0x39b0c1=Math[_0x2ebef7(0x1b2)](_0x39b0c1*(0x1-_0x17d8b0)+_0x468687[_0x5eff7f+0x2]*_0x17d8b0);}}_0x366408[_0x5b0f14]=_0x28b42e,_0x366408[_0x5b0f14+0x1]=_0x2339a7,_0x366408[_0x5b0f14+0x2]=_0x39b0c1;}return _0x341601;}function convertToBlackWhite(_0x59eb6a,_0x1e2be2){const _0x48c400=_0x357eb9,_0x5c09c1=_0x59eb6a['width'],_0x1196f4=_0x59eb6a[_0x48c400(0x1e1)],_0x432295=ctx[_0x48c400(0xfa)](_0x5c09c1,_0x1196f4);return _0x432295[_0x48c400(0xdf)]['set'](_0x59eb6a['data']),applyDitheringAlgorithm(_0x432295,0x80,_0x1e2be2),{'imageData':_0x432295};}function convertToBlackWhiteRed(_0xc508db,_0x534faf){const _0x4b1f04=_0x357eb9,_0x5df7ec=_0xc508db[_0x4b1f04(0x20a)],_0x1d795d=_0xc508db[_0x4b1f04(0x1e1)],_0xa99717=ctx[_0x4b1f04(0xfa)](_0x5df7ec,_0x1d795d);_0xa99717['data']['set'](_0xc508db[_0x4b1f04(0xdf)]);const _0x4e0113=_0xa99717[_0x4b1f04(0xdf)];for(let _0x125bf5=0x0;_0x125bf5<_0x4e0113['length'];_0x125bf5+=0x4){const _0x7d9bb9=_0x4e0113[_0x125bf5],_0x154d99=_0x4e0113[_0x125bf5+0x1],_0x1b9d94=_0x4e0113[_0x125bf5+0x2];if(_0x7d9bb9>0xb4&&_0x154d99<_0x7d9bb9*0.6&&_0x1b9d94<_0x7d9bb9*0.6)_0x4e0113[_0x125bf5+0x3]=0x1;else{const _0x4ca295=0.299*_0x7d9bb9+0.587*_0x154d99+0.114*_0x1b9d94;_0x4e0113[_0x125bf5]=_0x4ca295,_0x4e0113[_0x125bf5+0x1]=_0x4ca295,_0x4e0113[_0x125bf5+0x2]=_0x4ca295,_0x4e0113[_0x125bf5+0x3]=0x0;}}applyDitheringAlgorithm(_0xa99717,0x64,_0x534faf,!![]);for(let _0x59434d=0x0;_0x59434d<_0x4e0113[_0x4b1f04(0x18a)];_0x59434d+=0x4){if(_0x4e0113[_0x59434d+0x3]===0x1)_0x4e0113[_0x59434d]=0xff,_0x4e0113[_0x59434d+0x1]=0x0,_0x4e0113[_0x59434d+0x2]=0x0;else{const _0x2992b5=_0x4e0113[_0x59434d]>0x64?0xff:0x0;_0x4e0113[_0x59434d]=_0x4e0113[_0x59434d+0x1]=_0x4e0113[_0x59434d+0x2]=_0x2992b5;}_0x4e0113[_0x59434d+0x3]=0xff;}return{'imageData':_0xa99717};}function applyDitheringAlgorithm(_0x3d132e,_0x52d828,_0x1146d2,_0x5d4add=![]){const _0x1d253f=_0x357eb9,_0x3ca5ca=_0x3d132e[_0x1d253f(0xdf)],_0x3a50e6=_0x3d132e['width'],_0x2ca001=_0x3d132e['height'],_0x123bb5=_0x1146d2[_0x1d253f(0x1a3)],_0x11bcc8=_0x1146d2[_0x1d253f(0x176)]/0x64,_0x5bd3af=new Uint8ClampedArray(_0x3ca5ca);for(let _0x2ac96f=0x0;_0x2ac96f<_0x2ca001;_0x2ac96f++){for(let _0x28f0b6=0x0;_0x28f0b6<_0x3a50e6;_0x28f0b6++){const _0x1b3b89=(_0x2ac96f*_0x3a50e6+_0x28f0b6)*0x4;if(_0x5d4add&&_0x5bd3af[_0x1b3b89+0x3]===0x1)continue;const _0xd76615=_0x5bd3af[_0x1b3b89],_0xa30f57=_0xd76615<_0x52d828?0x0:0xff,_0x4d3557=_0xd76615-_0xa30f57,_0x524479=0x1+_0x11bcc8;switch(_0x123bb5){case _0x1d253f(0x15b):propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x7/0x10,0x1,0x0),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x3/0x10,-0x1,0x1),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x5/0x10,0x0,0x1),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x10,0x1,0x1);break;case _0x1d253f(0x149):propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x8,0x1,0x0),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x8,0x2,0x0),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x8,-0x1,0x1),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x8,0x0,0x1),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x8,0x1,0x1),propagateError(_0x5bd3af,_0x28f0b6,_0x2ac96f,_0x3a50e6,_0x2ca001,_0x4d3557*_0x524479,0x1/0x8,0x0,0x2);break;default:break;}_0x3ca5ca[_0x1b3b89]=_0xa30f57,_0x3ca5ca[_0x1b3b89+0x1]=_0xa30f57,_0x3ca5ca[_0x1b3b89+0x2]=_0xa30f57;}}}function propagateError(_0x1effee,_0x55e90c,_0x14b6e9,_0x57736e,_0x1e8c8f,_0x454e89,_0x400e62,_0xf4eb8a,_0x5dde54){const _0x3620a6=_0x357eb9,_0x499aae=_0x55e90c+_0xf4eb8a,_0x2a1974=_0x14b6e9+_0x5dde54;if(_0x499aae>=0x0&&_0x499aae<_0x57736e&&_0x2a1974>=0x0&&_0x2a1974<_0x1e8c8f){const _0xbf2844=(_0x2a1974*_0x57736e+_0x499aae)*0x4;_0x1effee[_0xbf2844]=Math[_0x3620a6(0x175)](0x0,Math[_0x3620a6(0x10d)](0xff,_0x1effee[_0xbf2844]+_0x454e89*_0x400e62));}}function processImageData(_0x7b4f6f,_0x498308){const _0x5db468=_0x357eb9,_0x115821=_0x7b4f6f[_0x5db468(0x20a)],_0xf0b8d6=_0x7b4f6f['height'],_0x211d5a=_0x7b4f6f['data'];let _0x36de8d;if(_0x498308===_0x5db468(0xd5)){_0x36de8d=new Uint8Array(_0x115821*_0xf0b8d6);for(let _0x129b21=0x0;_0x129b21<_0xf0b8d6;_0x129b21++){for(let _0x5d7d01=0x0;_0x5d7d01<_0x115821;_0x5d7d01++){const _0x33d07e=(_0x129b21*_0x115821+_0x5d7d01)*0x4,_0x110b4b=_0x211d5a[_0x33d07e],_0x58d470=_0x211d5a[_0x33d07e+0x1],_0x425395=_0x211d5a[_0x33d07e+0x2],_0x9234e3=findClosestColor(_0x110b4b,_0x58d470,_0x425395,_0x498308),_0x380a08=_0x5d7d01*_0xf0b8d6+(_0xf0b8d6-0x1-_0x129b21);_0x36de8d[_0x380a08]=_0x9234e3[_0x5db468(0x1dd)];}}}else{if(_0x498308==='fourColor'){_0x36de8d=new Uint8Array(Math[_0x5db468(0x1a7)](_0x115821*_0xf0b8d6/0x4));for(let _0x2df7d1=0x0;_0x2df7d1<_0xf0b8d6;_0x2df7d1++){for(let _0x34fd71=0x0;_0x34fd71<_0x115821;_0x34fd71++){const _0x3c3f37=(_0x2df7d1*_0x115821+_0x34fd71)*0x4,_0x1d9c41=_0x211d5a[_0x3c3f37],_0x4cb139=_0x211d5a[_0x3c3f37+0x1],_0xb327ea=_0x211d5a[_0x3c3f37+0x2],_0x48eb78=findClosestColor(_0x1d9c41,_0x4cb139,_0xb327ea,_0x498308),_0x480019=_0x48eb78[_0x5db468(0x1dd)],_0x25eefa=(_0x2df7d1*_0x115821+_0x34fd71)/0x4|0x0,_0xb396a9=0x6-_0x34fd71%0x4*0x2;_0x36de8d[_0x25eefa]|=_0x480019<<_0xb396a9;}}}else{if(_0x498308==='blackWhiteColor'){const _0x112f4d=Math[_0x5db468(0x1a7)](_0x115821/0x8);_0x36de8d=new Uint8Array(_0x112f4d*_0xf0b8d6);const _0x176856=0x8c;for(let _0x15435a=0x0;_0x15435a<_0xf0b8d6;_0x15435a++){for(let _0x4f0024=0x0;_0x4f0024<_0x115821;_0x4f0024++){const _0xe82899=(_0x15435a*_0x115821+_0x4f0024)*0x4,_0x58a70d=_0x211d5a[_0xe82899],_0x5efc5a=_0x211d5a[_0xe82899+0x1],_0x1cf74f=_0x211d5a[_0xe82899+0x2],_0x37c756=Math['round'](0.299*_0x58a70d+0.587*_0x5efc5a+0.114*_0x1cf74f),_0x1207c1=_0x37c756>=_0x176856?0x1:0x0,_0x544fcb=_0x15435a*_0x112f4d+Math[_0x5db468(0x1b2)](_0x4f0024/0x8),_0x275749=0x7-_0x4f0024%0x8;_0x36de8d[_0x544fcb]|=_0x1207c1<<_0x275749;}}}else{if(_0x498308===_0x5db468(0x115)){const _0x4ae194=Math[_0x5db468(0x1a7)](_0x115821/0x8),_0x23ac23=0x8c,_0x39b0bd=0xa0,_0x45560d=new Uint8Array(_0xf0b8d6*_0x4ae194),_0x28da9a=new Uint8Array(_0xf0b8d6*_0x4ae194);for(let _0x2deec1=0x0;_0x2deec1<_0xf0b8d6;_0x2deec1++){for(let _0x334bff=0x0;_0x334bff<_0x115821;_0x334bff++){const _0x1f2857=(_0x2deec1*_0x115821+_0x334bff)*0x4,_0x167f64=_0x211d5a[_0x1f2857],_0x2a75be=_0x211d5a[_0x1f2857+0x1],_0x22d66f=_0x211d5a[_0x1f2857+0x2],_0x360b44=Math[_0x5db468(0x204)](0.299*_0x167f64+0.587*_0x2a75be+0.114*_0x22d66f),_0x56160b=_0x360b44>=_0x23ac23?0x1:0x0,_0x26f156=_0x2deec1*_0x4ae194+Math[_0x5db468(0x1b2)](_0x334bff/0x8),_0x381469=0x7-_0x334bff%0x8;_0x56160b?_0x45560d[_0x26f156]|=0x1<<_0x381469:_0x45560d[_0x26f156]&=~(0x1<<_0x381469);const _0x8bc646=_0x167f64>_0x39b0bd&&_0x167f64>_0x2a75be&&_0x167f64>_0x22d66f?0x0:0x1,_0x3dd49a=_0x2deec1*_0x4ae194+Math['floor'](_0x334bff/0x8),_0x3debfd=0x7-_0x334bff%0x8;_0x8bc646?_0x28da9a[_0x3dd49a]|=0x1<<_0x3debfd:_0x28da9a[_0x3dd49a]&=~(0x1<<_0x3debfd);}}_0x36de8d=new Uint8Array(_0x45560d[_0x5db468(0x18a)]+_0x28da9a[_0x5db468(0x18a)]),_0x36de8d[_0x5db468(0x18b)](_0x45560d,0x0),_0x36de8d['set'](_0x28da9a,_0x45560d[_0x5db468(0x18a)]);}}}}return _0x36de8d;}function toggleCanvas(){const _0x1f935b=_0x357eb9;floatingCanvasContainer[_0x1f935b(0x140)][_0x1f935b(0x188)](_0x1f935b(0x20e))?(floatingCanvasContainer[_0x1f935b(0x140)][_0x1f935b(0x166)](_0x1f935b(0x20e)),toggleCanvasFloat[_0x1f935b(0x193)]=_0x1f935b(0xe7),addLog(_0x1f935b(0x141))):hideCanvas();}function hideCanvas(){const _0x1cd00a=_0x357eb9;floatingCanvasContainer[_0x1cd00a(0x140)]['add'](_0x1cd00a(0x20e)),toggleCanvasFloat[_0x1cd00a(0x193)]=_0x1cd00a(0x13b),addLog(_0x1cd00a(0x1ce));}function updateCanvasVisibility(){const _0x34646f=_0x357eb9,_0x1c563c=checkCanvasHasContent(canvas);_0x1c563c?(noImagePlaceholder[_0x34646f(0x140)]['add'](_0x34646f(0x20e)),canvas[_0x34646f(0x140)][_0x34646f(0x166)]('hidden'),floatPreviewCanvas[_0x34646f(0x140)][_0x34646f(0x166)]('hidden')):(noImagePlaceholder[_0x34646f(0x140)][_0x34646f(0x166)](_0x34646f(0x20e)),canvas[_0x34646f(0x140)][_0x34646f(0x1e6)](_0x34646f(0x20e)),floatPreviewCanvas['classList'][_0x34646f(0x1e6)](_0x34646f(0x20e)));}function checkCanvasHasContent(_0x4e31c4){const _0x37fa6b=_0x357eb9,_0x43c671=_0x4e31c4['getContext']('2d'),_0xc40047=_0x43c671[_0x37fa6b(0x16d)](0x0,0x0,_0x4e31c4['width'],_0x4e31c4[_0x37fa6b(0x1e1)]),_0x30ed31=_0xc40047[_0x37fa6b(0xdf)];for(let _0x5bc18c=0x0;_0x5bc18c<_0x30ed31[_0x37fa6b(0x18a)];_0x5bc18c+=0x4){if(_0x30ed31[_0x5bc18c]!==0xff||_0x30ed31[_0x5bc18c+0x1]!==0xff||_0x30ed31[_0x5bc18c+0x2]!==0xff)return!![];}return![];}function startDrag(_0x4e6deb){const _0x51e7fc=_0x357eb9;isDragging=!![];const _0x975cdd=floatingCanvasContainer[_0x51e7fc(0x150)]();dragOffset['x']=_0x4e6deb[_0x51e7fc(0x14b)]-_0x975cdd['left'],dragOffset['y']=_0x4e6deb[_0x51e7fc(0x143)]-_0x975cdd[_0x51e7fc(0x180)];}function drag(_0x25b264){const _0x4ee728=_0x357eb9;if(!isDragging)return;_0x25b264[_0x4ee728(0x1b8)]();const _0x399c0a=_0x25b264[_0x4ee728(0x14b)]-dragOffset['x'],_0x2b5b69=_0x25b264[_0x4ee728(0x143)]-dragOffset['y'],_0x54aa12=window[_0x4ee728(0x1dc)],_0x30f479=window[_0x4ee728(0x181)],_0x1f4462=floatingCanvasContainer[_0x4ee728(0x1c2)],_0x58dd18=floatingCanvasContainer[_0x4ee728(0x1f2)],_0x2fceaf=Math['max'](0x0,Math[_0x4ee728(0x10d)](_0x399c0a,_0x54aa12-_0x1f4462)),_0x1aafbb=Math[_0x4ee728(0x175)](0x0,Math['min'](_0x2b5b69,_0x30f479-_0x58dd18));floatingCanvasContainer[_0x4ee728(0xeb)]['left']=_0x2fceaf+'px',floatingCanvasContainer[_0x4ee728(0xeb)][_0x4ee728(0x180)]=_0x1aafbb+'px';}function stopDrag(){isDragging=![];}function startResize(_0x28bbb0){const _0x12b4af=_0x357eb9;isResizing=!![],_0x28bbb0[_0x12b4af(0x1b8)]();}function resize(_0x43f228){const _0x2d3b70=_0x357eb9;if(!isResizing)return;_0x43f228[_0x2d3b70(0x1b8)]();const _0x24060b=floatingCanvasContainer['getBoundingClientRect'](),_0x31e7ae=_0x43f228[_0x2d3b70(0x14b)]-_0x24060b[_0x2d3b70(0xf5)],_0x4102af=_0x43f228[_0x2d3b70(0x143)]-_0x24060b['top'];_0x31e7ae>0xc8&&_0x4102af>0x96&&(floatingCanvasContainer['style'][_0x2d3b70(0x20a)]=_0x31e7ae+'px',floatingCanvasContainer[_0x2d3b70(0xeb)][_0x2d3b70(0x1e1)]=_0x4102af+'px');}function stopResize(){isResizing=![];}function resetProcessing(){const _0x1b2c85=_0x357eb9;if(0x1){ctx[_0x1b2c85(0x1e3)](originalCanvasData,0x0,0x0),syncCanvases();const _0x51d458=getSelectedCanvasSize();processedImageInfo[_0x1b2c85(0x1fb)]=_0x51d458['width']+_0x1b2c85(0x1a6)+_0x51d458['height']+_0x1b2c85(0x20f),addLog(_0x1b2c85(0x1cc));}else ctx[_0x1b2c85(0x1e0)]=_0x1b2c85(0x1ba),ctx[_0x1b2c85(0x1e5)](0x0,0x0,canvas[_0x1b2c85(0x20a)],canvas[_0x1b2c85(0x1e1)]),syncCanvases(),addLog(_0x1b2c85(0xea));}function addLog(_0x52f308){const _0x2cd8c8=_0x357eb9,_0x3e0034=new Date()[_0x2cd8c8(0x1bc)](),_0x88afd5=document[_0x2cd8c8(0x1ee)]('div');_0x88afd5[_0x2cd8c8(0x162)]=_0x2cd8c8(0x11e),_0x88afd5[_0x2cd8c8(0x193)]=_0x2cd8c8(0x19d)+_0x3e0034+_0x2cd8c8(0x123)+_0x52f308+_0x2cd8c8(0xdb);logContainer[_0x2cd8c8(0xcf)](_0x2cd8c8(0x12a))&&(logContainer['innerHTML']='');logContainer['appendChild'](_0x88afd5),logContainer[_0x2cd8c8(0x110)]=logContainer[_0x2cd8c8(0x12e)];while(logContainer['childNodes'][_0x2cd8c8(0x18a)]>0x1e){logContainer[_0x2cd8c8(0xd8)](logContainer['firstChild']);}}function setStatus(_0x9388d9){const _0x215e1e=_0x357eb9;document[_0x215e1e(0x1de)]('status')[_0x215e1e(0x1fb)]=_0x9388d9;}function updateButtonStatus(_0x420ac2=![]){const _0x412fea=_0x357eb9,_0x956694=gattServer!=null&&gattServer[_0x412fea(0x1be)],_0x37bca5=_0x420ac2||!_0x956694;btnSend[_0x412fea(0x192)]=_0x37bca5,btnSetTime[_0x412fea(0x192)]=_0x37bca5,_0x37bca5?(btnSend[_0x412fea(0x140)][_0x412fea(0x1e6)](_0x412fea(0x1db),_0x412fea(0x137)),btnSetTime['classList']['add']('opacity-50',_0x412fea(0x137))):(btnSend[_0x412fea(0x140)][_0x412fea(0x166)](_0x412fea(0x1db),'cursor-not-allowed'),btnSetTime[_0x412fea(0x140)]['remove'](_0x412fea(0x1db),_0x412fea(0x137)));}function reConnect(){addLog('尝试重新连接设备...'),preConnect();}function handleNotify(_0x461bb5){const _0x2d8da9=_0x357eb9;console[_0x2d8da9(0x214)](_0x2d8da9(0x1da),_0x461bb5);}function hex2bytes(_0x2b5a66){const _0x49b83f=_0x357eb9,_0x43bcdc=[];for(let _0x36895e=0x0;_0x36895e<_0x2b5a66[_0x49b83f(0x18a)];_0x36895e+=0x2){_0x43bcdc['push'](parseInt(_0x2b5a66[_0x49b83f(0x1b4)](_0x36895e,0x2),0x10));}return _0x43bcdc;}function formatFileSize(_0x428f2a){const _0x5265df=_0x357eb9;if(_0x428f2a<0x400)return _0x428f2a+'\x20B';else{if(_0x428f2a<0x100000)return(_0x428f2a/0x400)[_0x5265df(0x201)](0x2)+_0x5265df(0xe0);else return(_0x428f2a/0x100000)[_0x5265df(0x201)](0x2)+'\x20MB';}}async function set_EPD_CMD_J_H(){const _0x41771d=_0x357eb9;await write(0xff,document[_0x41771d(0x1de)](_0x41771d(0x17e))[_0x41771d(0x1dd)]);}async function set_EPD_CMD_N_Z(){const _0x375327=_0x357eb9,_0x3883ca=document['getElementById'](_0x375327(0x103))[_0x375327(0x1dd)],_0x5d964e=document[_0x375327(0x1de)](_0x375327(0xf3))[_0x375327(0x1dd)],_0x56cac9=document[_0x375327(0x1de)](_0x375327(0x127))[_0x375327(0x1dd)],_0x56adcd=[0x4];_0x56adcd[0x0]=0x0,_0x56adcd[0x1]=0x0,_0x56adcd[0x2]=_0x3883ca,_0x56adcd[0x3]=_0x5d964e,_0x56adcd[0x4]=_0x56cac9,await write(0xef,_0x56adcd);}async function set_EPD_CMD_D_S(){const _0x1d6709=_0x357eb9,_0x2466c8=document[_0x1d6709(0x1de)](_0x1d6709(0x158))['value'],_0x4f6bae=document[_0x1d6709(0x1de)]('D_S_min')[_0x1d6709(0x1dd)],_0x337253=document[_0x1d6709(0x1de)](_0x1d6709(0x132))[_0x1d6709(0x1dd)],_0x5e82a0=[0x4];_0x5e82a0[0x0]=0x0,_0x5e82a0[0x1]=0x0,_0x5e82a0[0x2]=_0x2466c8,_0x5e82a0[0x3]=_0x4f6bae,_0x5e82a0[0x4]=_0x337253,await write(0xed,_0x5e82a0);}async function set_EPD_CMD_J_S(){const _0x59c403=_0x357eb9,_0x214e67=document[_0x59c403(0x1de)](_0x59c403(0x1c8))['value'],_0x53bd24=document[_0x59c403(0x1de)](_0x59c403(0xfc))['value'],_0x5b199e=document[_0x59c403(0x1de)]('J_S_start')[_0x59c403(0x1dd)],_0x4b577b=[0x4];_0x4b577b[0x0]=0x0,_0x4b577b[0x1]=0x0,_0x4b577b[0x2]=_0x214e67,_0x4b577b[0x3]=_0x53bd24,_0x4b577b[0x4]=_0x5b199e,await write(0xee,_0x4b577b);}async function set_EPD_CMD_LED(){const _0x351953=_0x357eb9,_0x48cd5f=document[_0x351953(0x1de)]('color_led')[_0x351953(0x1dd)],_0x22b353=document[_0x351953(0x1de)](_0x351953(0xe4))[_0x351953(0x1dd)],_0x2d0b36=document[_0x351953(0x1de)]('liang_add')[_0x351953(0x1dd)],_0xd3eaba=document[_0x351953(0x1de)](_0x351953(0x1e2))['value'],_0x3fa649=document[_0x351953(0x1de)](_0x351953(0x1b0))[_0x351953(0x1dd)],_0x304fec=[0x5];_0x304fec[0x0]=_0x48cd5f,_0x304fec[0x1]=_0x22b353,_0x304fec[0x2]=_0x2d0b36,_0x304fec[0x3]=_0xd3eaba,_0x304fec[0x4]=_0x3fa649,await write(0xec,_0x304fec);}async function set_EPD_CMD_LED1(){const _0xbe31dc=_0x357eb9,_0x5eae8b=document[_0xbe31dc(0x1de)](_0xbe31dc(0x168))[_0xbe31dc(0x1dd)],_0xab0d89=document[_0xbe31dc(0x1de)](_0xbe31dc(0xe4))[_0xbe31dc(0x1dd)],_0x8ad853=document['getElementById'](_0xbe31dc(0x113))[_0xbe31dc(0x1dd)],_0x3bdc72=document[_0xbe31dc(0x1de)](_0xbe31dc(0x1e2))['value'],_0x4cbf13=document[_0xbe31dc(0x1de)](_0xbe31dc(0x1b0))[_0xbe31dc(0x1dd)],_0x5e70b2=[0x5];_0x5e70b2[0x0]=_0x5eae8b,_0x5e70b2[0x1]=_0xab0d89,_0x5e70b2[0x2]=_0x8ad853,_0x5e70b2[0x3]=_0x3bdc72,_0x5e70b2[0x4]=_0x4cbf13,await write(0xfd,_0x5e70b2);}async function set_EPD_CMD_MY(){const _0x55b6ac=_0x357eb9,_0x515ea0=document[_0x55b6ac(0x1de)](_0x55b6ac(0xe8))[_0x55b6ac(0x1dd)],_0x1b9bdb=document[_0x55b6ac(0x1de)](_0x55b6ac(0xe1))[_0x55b6ac(0x1dd)],_0x33aaf7=document[_0x55b6ac(0x1de)](_0x55b6ac(0xd7))['value'],_0x4de854=document[_0x55b6ac(0x1de)](_0x55b6ac(0x1d0))['value'],_0x5c74f8=[0x4];_0x5c74f8[0x0]=_0x515ea0,_0x5c74f8[0x1]=_0x1b9bdb,_0x5c74f8[0x2]=_0x33aaf7,_0x5c74f8[0x3]=_0x4de854,await write(0xeb,_0x5c74f8);}async function set_EPD_CMD_COLOR(){const _0x202742=_0x357eb9,_0x22de9b=document[_0x202742(0x1de)](_0x202742(0x197))[_0x202742(0x1dd)],_0xe8d390=document[_0x202742(0x1de)]('time_color')[_0x202742(0x1dd)],_0x4c4bb4=document[_0x202742(0x1de)](_0x202742(0x1f0))[_0x202742(0x1dd)],_0x42de84=document[_0x202742(0x1de)]('gongli_color')[_0x202742(0x1dd)],_0x36238c=document[_0x202742(0x1de)](_0x202742(0x18d))[_0x202742(0x1dd)],_0x27beaa=document['getElementById'](_0x202742(0x1ca))[_0x202742(0x1dd)],_0x1880ed=document[_0x202742(0x1de)]('r_jushua_time')[_0x202742(0x1dd)],_0x3a26ec=[0x7];_0x3a26ec[0x0]=_0x22de9b,_0x3a26ec[0x1]=_0xe8d390,_0x3a26ec[0x2]=_0x4c4bb4,_0x3a26ec[0x3]=_0x42de84,_0x3a26ec[0x4]=_0x36238c,_0x3a26ec[0x5]=_0x27beaa,_0x3a26ec[0x6]=_0x1880ed,await write(0xea,_0x3a26ec);}async function set_EPD_CMD_4_MS(){const _0x2bab41=_0x357eb9,_0x2635f1=document[_0x2bab41(0x1de)]('fanxian1')[_0x2bab41(0x1dd)],_0x4b8423=document[_0x2bab41(0x1de)](_0x2bab41(0x1a2))[_0x2bab41(0x1dd)],_0xc9997d=document[_0x2bab41(0x1de)](_0x2bab41(0x186))[_0x2bab41(0x1dd)],_0x145593=document[_0x2bab41(0x1de)]('xianshi_peizhi')[_0x2bab41(0x1dd)],_0x9a8ac9=document[_0x2bab41(0x1de)](_0x2bab41(0x1bb))[_0x2bab41(0x1dd)],_0x27acc5=document[_0x2bab41(0x1de)](_0x2bab41(0xd2))[_0x2bab41(0x1dd)],_0x1d89b6=document[_0x2bab41(0x1de)](_0x2bab41(0x1bf))['value'],_0x451e1c=[0x7];_0x451e1c[0x0]=_0x2635f1,_0x451e1c[0x1]=_0x4b8423,_0x451e1c[0x2]=_0xc9997d,_0x451e1c[0x3]=_0x145593,_0x451e1c[0x4]=_0x9a8ac9,_0x451e1c[0x5]=_0x27acc5,_0x451e1c[0x6]=_0x1d89b6,await write(0xfe,_0x451e1c);}async function send_time(_0x308761){const _0x277342=_0x357eb9,_0x15b32d=new Date()[_0x277342(0x200)]()/0x3e8,_0x18444a=new Uint8Array([_0x15b32d>>0x18&0xff,_0x15b32d>>0x10&0xff,_0x15b32d>>0x8&0xff,_0x15b32d&0xff,-(new Date()[_0x277342(0x187)]()/0x3c),_0x308761]);await write(0xa3,_0x18444a)&&addLog(_0x277342(0xf1));}async function set_EPD_CMD_4_ZF(_0x29250a){const _0xfc1d59=_0x357eb9,_0x55c4f0=[0x1];_0x55c4f0[0x0]=_0x29250a,await write(0xfb,_0x55c4f0),_0x29250a==0x0&&(syncTime(0x2),addLog(_0xfc1d59(0xd4)));}window[_0x357eb9(0x20b)]=init;
